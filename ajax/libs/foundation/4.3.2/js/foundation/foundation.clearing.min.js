(function(c,b,a,d){Foundation.libs.clearing={name:"clearing",version:"4.3.2",settings:{templates:{viewing:'<a href="#" class="clearing-close">&times;</a><div class="visible-img" style="display: none"><img src="//:0"><p class="clearing-caption"></p><a href="#" class="clearing-main-prev"><span></span></a><a href="#" class="clearing-main-next"><span></span></a></div>'},close_selectors:".clearing-close",init:false,locked:false},init:function(g,h,f){var e=this;Foundation.inherit(this,"set_data get_data remove_data throttle data_options");if(typeof h==="object"){f=c.extend(true,this.settings,h)}if(typeof h!=="string"){c(this.scope).find("ul[data-clearing]").each(function(){var k=c(this),j=j||{},i=k.find("li"),l=e.get_data(k);if(!l&&i.length>0){j.$parent=k.parent();e.set_data(k,c.extend({},e.settings,j,e.data_options(k)));e.assemble(k.find("li"));if(!e.settings.init){e.events().swipe_events()}}});return this.settings.init}else{return this[h].call(this,f)}},events:function(){var e=this;c(this.scope).on("click.fndtn.clearing","ul[data-clearing] li",function(k,j,i){var j=j||c(this),i=i||j,g=j.next("li"),f=e.get_data(j.parent()),h=c(k.target);k.preventDefault();if(!f){e.init()}if(i.hasClass("visible")&&j[0]===i[0]&&g.length>0&&e.is_open(j)){i=g;h=i.find("img")}e.open(h,j,i);e.update_paddles(i)}).on("click.fndtn.clearing",".clearing-main-next",function(f){this.nav(f,"next")}.bind(this)).on("click.fndtn.clearing",".clearing-main-prev",function(f){this.nav(f,"prev")}.bind(this)).on("click.fndtn.clearing",this.settings.close_selectors,function(f){Foundation.libs.clearing.close(f,this)}).on("keydown.fndtn.clearing",function(f){this.keydown(f)}.bind(this));c(b).on("resize.fndtn.clearing",function(){this.resize()}.bind(this));this.settings.init=true;return this},swipe_events:function(){var e=this;c(this.scope).on("touchstart.fndtn.clearing",".visible-img",function(g){if(!g.touches){g=g.originalEvent}var f={start_page_x:g.touches[0].pageX,start_page_y:g.touches[0].pageY,start_time:(new Date()).getTime(),delta_x:0,is_scrolling:d};c(this).data("swipe-transition",f);g.stopPropagation()}).on("touchmove.fndtn.clearing",".visible-img",function(h){if(!h.touches){h=h.originalEvent}if(h.touches.length>1||h.scale&&h.scale!==1){return}var f=c(this).data("swipe-transition");if(typeof f==="undefined"){f={}}f.delta_x=h.touches[0].pageX-f.start_page_x;if(typeof f.is_scrolling==="undefined"){f.is_scrolling=!!(f.is_scrolling||Math.abs(f.delta_x)<Math.abs(h.touches[0].pageY-f.start_page_y))}if(!f.is_scrolling&&!f.active){h.preventDefault();var g=(f.delta_x<0)?"next":"prev";f.active=true;e.nav(h,g)}}).on("touchend.fndtn.clearing",".visible-img",function(f){c(this).data("swipe-transition",{});f.stopPropagation()})},assemble:function(k){var g=k.parent();g.after('<div id="foundationClearingHolder"></div>');var f=c("#foundationClearingHolder"),h=this.get_data(g),e=g.detach(),i={grid:'<div class="carousel">'+this.outerHTML(e[0])+"</div>",viewing:h.templates.viewing},j='<div class="clearing-assembled"><div>'+i.viewing+i.grid+"</div></div>";return f.after(j).remove()},open:function(h,k,j){var f=j.closest(".clearing-assembled"),e=f.find("div").first(),g=e.find(".visible-img"),i=g.find("img").not(h);if(!this.locked()){i.attr("src",this.load(h)).css("visibility","hidden");this.loaded(i,function(){i.css("visibility","visible");f.addClass("clearing-blackout");e.addClass("clearing-container");g.show();this.fix_height(j).caption(g.find(".clearing-caption"),h).center(i).shift(k,j,function(){j.siblings().removeClass("visible");j.addClass("visible")})}.bind(this))}},close:function(j,i){j.preventDefault();var g=(function(e){if(/blackout/.test(e.selector)){return e}else{return e.closest(".clearing-blackout")}}(c(i))),f,h;if(i===j.target&&g){f=g.find("div").first();h=f.find(".visible-img");this.settings.prev_index=0;g.find("ul[data-clearing]").attr("style","").closest(".clearing-blackout").removeClass("clearing-blackout");f.removeClass("clearing-container");h.hide()}return false},is_open:function(e){return e.parent().prop("style").length>0},keydown:function(g){var f=c(".clearing-blackout").find("ul[data-clearing]");if(g.which===39){this.go(f,"next")}if(g.which===37){this.go(f,"prev")}if(g.which===27){c("a.clearing-close").trigger("click")}},nav:function(h,g){var f=c(".clearing-blackout").find("ul[data-clearing]");h.preventDefault();this.go(f,g)},resize:function(){var e=c(".clearing-blackout .visible-img").find("img");if(e.length){this.center(e)}},fix_height:function(g){var f=g.parent().children(),e=this;f.each(function(){var h=c(this),i=h.find("img");if(h.height()>e.outerHeight(i)){h.addClass("fix-height")}}).closest("ul").width(f.length*100+"%");return this},update_paddles:function(f){var e=f.closest(".carousel").siblings(".visible-img");if(f.next().length>0){e.find(".clearing-main-next").removeClass("disabled")}else{e.find(".clearing-main-next").addClass("disabled")}if(f.prev().length>0){e.find(".clearing-main-prev").removeClass("disabled")}else{e.find(".clearing-main-prev").addClass("disabled")}},center:function(e){if(!this.rtl){e.css({marginLeft:-(this.outerWidth(e)/2),marginTop:-(this.outerHeight(e)/2)})}else{e.css({marginRight:-(this.outerWidth(e)/2),marginTop:-(this.outerHeight(e)/2)})}return this},load:function(f){if(f[0].nodeName==="A"){var e=f.attr("href")}else{var e=f.parent().attr("href")}this.preload(f);if(e){return e}return f.attr("src")},preload:function(e){this.img(e.closest("li").next()).img(e.closest("li").prev())},loaded:function(g,h){function e(){h()}function f(){this.one("load",e);if(/MSIE (\d+\.\d+);/.test(navigator.userAgent)){var j=this.attr("src"),i=j.match(/\?/)?"&":"?";i+="random="+(new Date()).getTime();this.attr("src",j+i)}}if(!g.attr("src")){e();return}if(g[0].complete||g[0].readyState===4){e()}else{f.call(g)}},img:function(e){if(e.length){var f=new Image(),g=e.find("a");if(g.length){f.src=g.attr("href")}else{f.src=e.find("img").attr("src")}}return this},caption:function(e,g){var f=g.data("caption");if(f){e.html(f).show()}else{e.text("").hide()}return this},go:function(e,h){var g=e.find(".visible"),f=g[h]();if(f.length){f.find("img").trigger("click",[g,f])}},shift:function(h,i,m){var j=i.parent(),g=this.settings.prev_index||i.index(),k=this.direction(j,h,i),f=parseInt(j.css("left"),10),e=this.outerWidth(i),l;if(i.index()!==g&&!/skip/.test(k)){if(/left/.test(k)){this.lock();j.animate({left:f+e},300,this.unlock())}else{if(/right/.test(k)){this.lock();j.animate({left:f-e},300,this.unlock())}}}else{if(/skip/.test(k)){l=i.index()-this.settings.up_count;this.lock();if(l>0){j.animate({left:-(l*e)},300,this.unlock())}else{j.animate({left:0},300,this.unlock())}}}m()},direction:function(h,j,i){var g=h.find("li"),f=this.outerWidth(g)+(this.outerWidth(g)/4),k=Math.floor(this.outerWidth(c(".clearing-container"))/f)-1,l=g.index(i),e;this.settings.up_count=k;if(this.adjacent(this.settings.prev_index,l)){if((l>k)&&l>this.settings.prev_index){e="right"}else{if((l>k-1)&&l<=this.settings.prev_index){e="left"}else{e=false}}}else{e="skip"}this.settings.prev_index=l;return e},adjacent:function(g,f){for(var e=f+1;e>=f-1;e--){if(e===g){return true}}return false},lock:function(){this.settings.locked=true},unlock:function(){this.settings.locked=false},locked:function(){return this.settings.locked},outerHTML:function(e){return e.outerHTML||new XMLSerializer().serializeToString(e)},off:function(){c(this.scope).off(".fndtn.clearing");c(b).off(".fndtn.clearing");this.remove_data();this.settings.init=false},reflow:function(){this.init()}}}(Foundation.zj,this,this.document));