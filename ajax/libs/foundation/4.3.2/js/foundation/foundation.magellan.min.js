(function(c,b,a,d){Foundation.libs.magellan={name:"magellan",version:"4.3.2",settings:{activeClass:"active",threshold:0},init:function(f,g,e){this.scope=f||this.scope;Foundation.inherit(this,"data_options");if(typeof g==="object"){c.extend(true,this.settings,g)}if(typeof g!=="string"){if(!this.settings.init){this.fixed_magellan=c("[data-magellan-expedition]");this.set_threshold();this.last_destination=c("[data-magellan-destination]").last();this.events()}return this.settings.init}else{return this[g].call(this,e)}},events:function(){var e=this;c(this.scope).on("arrival.fndtn.magellan","[data-magellan-arrival]",function(i){var g=c(this),h=g.closest("[data-magellan-expedition]"),f=h.attr("data-magellan-active-class")||e.settings.activeClass;g.closest("[data-magellan-expedition]").find("[data-magellan-arrival]").not(g).removeClass(f);g.addClass(f)});this.fixed_magellan.on("update-position.fndtn.magellan",function(){var f=c(this)}).trigger("update-position");c(b).on("resize.fndtn.magellan",function(){this.fixed_magellan.trigger("update-position")}.bind(this)).on("scroll.fndtn.magellan",function(){var f=c(b).scrollTop();e.fixed_magellan.each(function(){var h=c(this);if(typeof h.data("magellan-top-offset")==="undefined"){h.data("magellan-top-offset",h.offset().top)}if(typeof h.data("magellan-fixed-position")==="undefined"){h.data("magellan-fixed-position",false)}var i=(f+e.settings.threshold)>h.data("magellan-top-offset");var g=h.attr("data-magellan-top-offset");if(h.data("magellan-fixed-position")!=i){h.data("magellan-fixed-position",i);if(i){h.addClass("fixed");h.css({position:"fixed",top:0})}else{h.removeClass("fixed");h.css({position:"",top:""})}if(i&&typeof g!="undefined"&&g!=false){h.css({position:"fixed",top:g+"px"})}}})});if(this.last_destination.length>0){c(b).on("scroll.fndtn.magellan",function(h){var g=c(b).scrollTop(),f=g+c(b).height(),i=Math.ceil(e.last_destination.offset().top);c("[data-magellan-destination]").each(function(){var l=c(this),k=l.attr("data-magellan-destination"),j=l.offset().top-g;if(j<=e.settings.threshold){c("[data-magellan-arrival='"+k+"']").trigger("arrival")}if(f>=c(e.scope).height()&&i>g&&i<f){c("[data-magellan-arrival]").last().trigger("arrival")}})})}this.settings.init=true},set_threshold:function(){if(typeof this.settings.threshold!=="number"){this.settings.threshold=(this.fixed_magellan.length>0)?this.outerHeight(this.fixed_magellan,true):0}},off:function(){c(this.scope).off(".fndtn.magellan");c(b).off(".fndtn.magellan")},reflow:function(){}}}(Foundation.zj,this,this.document));