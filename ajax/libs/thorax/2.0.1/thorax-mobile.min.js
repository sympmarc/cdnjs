!function(){function e(){this.helpers&&_.each(this.helpers,function(e,t){var i=this;this.helpers[t]=function(){var t=_.toArray(arguments),n=_.last(t);return n.context=this,e.apply(i,t)}},this)}function t(e){return'Error "'+e+'". For more information visit http://thoraxjs.org/error-codes.html'+"#"+e}function i(e,t){var i=e.extend;e.extend=function(){var e=i.apply(this,arguments);return e.prototype.name&&(t[e.prototype.name]=e),e}}function n(e,t,i,n){var r,o=e[t];if(_.indexOf(i,".")>=0){var s=i.split(/\./);i=s.pop(),_.each(s,function(e){o=o[e]})}if(o&&(r=o[i]),r||n)return r;throw new Error(t+": "+i+" does not exist.")}function r(e,t){var i;if(_.isString(this[e])?i=lt.Util.getViewClass(this[e],!0):this.name&&!_.isFunction(this[e])&&(i=lt.Util.getViewClass(this.name+(t.extension||""),!0)),i&&!_.isFunction(this[e])&&(this[e]=i),t.required&&!_.isFunction(this[e]))throw new Error("View "+(this.name||this.cid)+" requires: "+e)}function o(e,t){var i;if(_.isString(this[e])?i=lt.Util.getTemplate(this[e],!0):this.name&&!_.isFunction(this[e])&&(i=lt.Util.getTemplate(this.name+(t.extension||""),!0)),!i&&"template"===e&&this._defaultTemplate&&(i=this._defaultTemplate),i&&!_.isFunction(this[e])&&(this[e]=i),t.required&&!_.isFunction(this[e]))throw new Error("View "+(this.name||this.cid)+" requires: "+e)}function s(e,t,i){return e&&e[t]?_.isFunction(e[t])?e[t].call(i||e):e[t]:null}function a(e){_.each(ct,function(t){e[t.name]||(e[t.name]=[])})}function l(e){_.each(ct,function(t){e[t.name]=[]})}function c(e,t,i,n){var r=[];_.has(e,t)&&r.push(e);var o=e;if(i)for(;o=o.__parent__;)_.has(o,t)&&r.push(o);else for(o=o.constructor;o;)o.prototype&&_.has(o.prototype,t)&&r.push(o.prototype),o=o.__super__&&o.__super__.constructor;for(var a=r.length;a--;)_.each(s(r[a],t,e),n)}function h(e,t,i,n){if(_.isObject(i)){var r=ct[t];if(r&&r.event)return e&&e.listenTo&&e[t]&&e[t].cid?d(e,i,n,t):d(e["_"+t+"Events"],i,n),!0}}function u(e,t,i,n,r){function o(){if(e.el)s.apply(r,arguments);else{if(a)throw new Error("destroyed-event:"+e.name+":"+i);a++}}var s=E(n,e),a=0;o._callback=s._callback||s,o._thoraxBind=!0,e.listenTo(t,i,o)}function d(e,t,i,n){function r(t,r){n?u(e,e[n],r,t,i||e):e.push([r,t,i])}_.each(t,function(e,t){_.isArray(e)?_.each(e,function(e){r(e,t)}):r(e,t)})}function p(e){if(!e||!e.data)throw new Error(t("handlebars-no-data"));return e.data}function f(e){e.tag&&(e.tagName=e.tag,delete e.tag),e["class"]&&(e.className=e["class"],delete e["class"])}function m(e){pt.push.apply(pt,e),ut=new RegExp("^(nested\\s+)?("+pt.join("|")+")(?:\\s|$)")}function g(e,t){return function(i){var n=$(i.target).view({helper:!1});n&&n.cid===t&&(i.originalContext=this,e(i))}}function v(e,t){function i(){try{r.apply(o,arguments)}catch(t){lt.onException("thorax-exception: "+(o.name||o.cid)+":"+e,t)}}e+=t.originalName;var n=t.handler,r=_.isFunction(n)?n:this[n];if(!r)throw new Error('Event "'+n+'" does not exist '+(this.name||this.cid)+":"+e);var o=t.context||this;return i._callback=r,i._thoraxBind=!0,i}function y(e,t,i){var n={originalName:e,handler:_.isString(t)?this[t]:t};if(e.match(ut)){var r=dt.exec(e);n.nested=!!r[1],n.name=r[2],n.type="DOM",n.selector=r[3]}else n.name=e,n.type="view";return n.context=i,n}function w(e){for(;e._helperName&&"view"!==e._helperName;)e=e.parent;return e}function b(e){var t=_.pick(e,"fn","inverse","hash","data");return t.data=_.omit(e.data,"cid","view","yield"),t}function C(e,t){function i(e,t){return _.every(e,function(e,i){return t[i]===e})}return e._helperName!==t._helperName?!1:(e=e._helperOptions,t=t._helperOptions,e.args.length===t.args.length&&i(e.args,t.args)&&_.isEqual(_.keys(e.options),_.keys(t.options))&&_.every(e.options,function(n,r){if("data"===r||"hash"===r)return i(e.options[r],t.options[r]);if("fn"===r||"inverse"===r){if(t.options[r]===n)return!0;var o=t.options[r]||{};return n&&_.has(n,"program")&&!n.depth&&o.program===n.program}return t.options[r]===n}))}function x(e,t){function i(i,n){var r=this[e],o=s(this,t.$el);return i===r?this:(r&&this.unbindDataObject(r),i?(this[e]=i,t.loading&&t.loading.call(this),this.bindDataObject(e,i,_.extend({},this.options,n)),o&&o.attr(t.cidAttrName,i.cid),i.trigger("set",i,r)):(this[e]=!1,t.change&&t.change.call(this,!1),o&&o.removeAttr(t.cidAttrName)),this.trigger("change:data-object",e,i,r),this)}t=ct[e]=_.defaults({name:"_"+e+"Events",event:!0},t),t.ctor=function(){if(this[e]){var i=this[e];this[e]=null,this[t.set](i)}},lt.View.prototype[t.set]=i}function V(e,t,i){var n=this;c(i,"_"+e+"Events",!0,function(e){u(n,t,e[0],e[1],e[2]||n)})}function T(e,t){e.load?e.load(function(){t&&t.success&&t.success(e)},t):e.fetch(t)}function E(e,t){return _.isFunction(e)?e:t[e]}function H(e,t){if(!t||!t.serializing){var i=this.getObjectOptions(e)||{};this.conditionalRender(i.render)}}function O(e){var t=this.getObjectOptions(e)||void 0;this.shouldRender(t&&t.render)&&this.renderCollection&&this.renderCollection()}function k(e){var t=this.getObjectOptions(e)||void 0;this.shouldRender(t&&t.render)&&this.ensureRendered()}function L(){this.itemFilter&&this.collection.forEach(F,this)}function F(e){var t=this.getCollectionElement();this.itemFilter&&t.find("["+vt+'="'+e.cid+'"]')[N.call(this,e)?"show":"hide"]()}function N(e){return this.itemFilter(e,this.collection.indexOf(e))}function j(){var e=this.getCollectionElement();this.emptyClass&&e.removeClass(this.emptyClass),e.removeAttr(Ct),e.empty()}function D(){var e=this.getCollectionElement();this.emptyClass&&e.addClass(this.emptyClass),e.attr(Ct,!0),this.appendEmpty()}function U(e,t){return _.each(e,function(i,n){return _.isObject(i)?U(i,t):(t(i,n,e)===!1&&delete e[n],void 0)}),e}function B(){I.call(this),this.model&&this.model.previousAttributes&&this.model.set(this.model.previousAttributes(),{silent:!0})}function S(e,t,i){var n=0;$("select,input,textarea",t.root||e.el).each(function(){(t.children||e===$(this).view({helper:!1}))&&"button"!==this.type&&"cancel"!==this.type&&"submit"!==this.type&&this.name&&(i(this,n),++n)})}function A(e,t,i,n){for(var r,o=e,s=t.split("["),a=i.mode,l=0;l<s.length-1;++l){if(r=s[l].replace("]",""),!o[r]){if("serialize"!==a)return n(void 0,r);o[r]={}}o=o[r]}r=s[s.length-1].replace("]",""),n(o,r)}function I(){this.$("form").removeAttr("data-submit-wait")}function M(e){var t=e.getObjectOptions(e.model)||{};return t.populate===!0?{}:t.populate}function R(e,t){t=t||{},t.target=this,this.trigger(e,t),_.each(this.children,function(i){i.trigger(e,t)})}function P(){++this._renderCount,this.$el.attr(Et,this.cid)}function q(){if(!this.$("["+Et+'="'+this.cid+'"]')[0])throw new Error("No layout element found in "+(this.name||this.cid))}function Q(){return this.$("["+Et+'="'+this.cid+'"]')[0]||this.el[0]||this.el}function z(e){return function(){var t=_.toArray(arguments);t.unshift(e),this.parent.trigger.apply(this.parent,t)}}function W(e){var t=w(this);if(!this[e]){var i=t[e];i&&(this[e]=i)}}function G(e){var t=$(this),i=t.view({helper:!1}),n=t.attr(Ot),r=t.attr(kt),o=!1;n&&(o=i[n].call(i,e)),r&&i.trigger(r,e),"A"===this.tagName&&o===!1&&e.preventDefault()}function X(){J(),$t=lt._fastClickEventName||"click",$(document).on($t,Lt,G)}function J(){$t&&$(document).off($t,Lt,G)}function K(e,t){function i(){r!==Backbone.history.getFragment()&&(o=!0,s.cancel(),t&&t())}function n(){Backbone.history.off("route",i),o||e.apply(this,arguments)}var r=Backbone.history.getFragment(),o=!1;Backbone.history.on("route",i);var s=_.bind(n,this);return s.cancel=function(){Backbone.history.off("route",i)},s}function Y(e,t,i){if(this.isPopulated())return _.defer(e,this);2===arguments.length&&!_.isFunction(t)&&_.isObject(t)&&(i=t,t=!1);var n=this,r=!1,o=K(_.bind(e,n),function(){r=!0,n._request&&(n._aborted=!0,n._request.abort()),t&&t.call(n,!1)});this.fetch(_.defaults({success:o,error:function(){o.cancel(),!r&&t&&t.apply(n,[!0].concat(_.toArray(arguments)))}},i))}function Z(e,i){if(e.resetQueue)this.fetchQueue=void 0;else if(this.fetchQueue){var n=(this.fetchQueue[0]||{}).reset;if(n!==e.reset)throw new Error(t("mixed-fetch"))}return this.fetchQueue?(this.fetchQueue.push(e),void 0):(this.fetchQueue=[e],e=_.defaults({success:et(this,this.fetchQueue,"success"),error:et(this,this.fetchQueue,"error"),complete:et(this,this.fetchQueue,"complete")},e),i&&i.call(this,e),e)}function et(e,t,i){return function(){var n=arguments;_.each(t,function(e){e[i]&&e[i].apply(this,n)},this),e.fetchQueue===t&&(e.fetchQueue=void 0)}}function tt(){this.render()}function it(){}function nt(){_.each(this._domEvents||[],function(e){var t=e.split(" "),i=t.slice(1).join(" ")||void 0;"click"===t[0]&&$(i||this.el,i&&this.el).forEach(function(e){var t=$(e).attr("data-tappable",!0);It&&!Mt[e.tagName]&&t.on("click",it)})},this)}$.fn.forEach||($.fn.forEach=function(e,t){$.fn.each.call(this,function(i){e.call(t||this,this,i)})});var rt="data-view-name",ot="data-view-cid",st="data-view-helper",at={};Handlebars.templates||(Handlebars.templates={});var lt=this.Thorax={templatePathPrefix:"",Views:{},onException:function(e,t){throw t},templates:Handlebars.templates};lt.View=Backbone.View.extend({constructor:function(){var e=Backbone.View.apply(this,arguments);return _.each(ct,function(t){t.ctor&&t.ctor.call(this,e)},this),e},_configure:function(t){var i=this;this._referenceCount=0,this._objectOptionsByCid={},this._boundDataObjectsByCid={},_.each(ct,function(e){i[e.name]=[]}),at[this.cid]=this,this.children={},this._renderCount=0,_.extend(this,t||{}),e.call(this),_.each(ct,function(e){e.configure&&e.configure.call(this)},this),this.trigger("configure")},setElement:function(){var e=Backbone.View.prototype.setElement.apply(this,arguments);return this.name&&this.$el.attr(rt,this.name),this.$el.attr(ot,this.cid),e},_addChild:function(e){return this.children[e.cid]?void 0:(e.retain(),this.children[e.cid]=e,e.parent&&e.parent!==this&&!e._helperOptions&&e.parent._removeChild(e),e.parent=this,this.trigger("child",e),e)},_removeChild:function(e){return delete this.children[e.cid],e.parent=null,e.release(),e},_destroy:function(){_.each(this._boundDataObjectsByCid,this.unbindDataObject,this),this.trigger("destroyed"),delete at[this.cid],_.each(this.children,function(e){this._removeChild(e)},this),this.el&&(this.undelegateEvents(),this.remove(),this.off()),this.el=this.$el=void 0,this.parent=void 0,this.model=this.collection=this._collection=void 0,this._helperOptions=void 0},render:function(e){if(this._rendering)throw new Error(t("nested-render"));this._previousHelpers=_.filter(this.children,function(e){return e._helperOptions});var i={};_.each(this.children,function(e,t){e._helperOptions||(i[t]=e)}),this.children=i,this.trigger("before:rendered"),this._rendering=!0;try{!_.isUndefined(e)&&(_.isElement(e)||lt.Util.is$(e)||e&&e.el||_.isString(e)||_.isFunction(e))?_.isFunction(e)&&(e=this.renderTemplate(e)):(o.call(this,"template",{required:!0}),e=this.renderTemplate(this.template)),_.each(this._previousHelpers,function(e){this._removeChild(e)},this),this._previousHelpers=void 0,this.html(e&&e.el||e&&e.string||e),++this._renderCount,this.trigger("rendered")}finally{this._rendering=!1}return e},context:function(){return _.extend({},this.model&&this.model.attributes||{})},_getContext:function(){return _.extend({},this,s(this,"context")||{})},_getData:function(e){return{view:this,cid:_.uniqueId("t"),yield:function(){return e.fn&&e.fn(e)}}},renderTemplate:function(e,t,i){var n;return t=t||this._getContext(),n=_.isFunction(e)?e:lt.Util.getTemplate(e,i),n?n(t,{helpers:this.helpers,data:this._getData(t)}):""},ensureRendered:function(){!this._renderCount&&this.render()},shouldRender:function(e){return e||null==e&&this._renderCount},conditionalRender:function(e){this.shouldRender(e)&&this.render()},appendTo:function(e){this.ensureRendered(),$(e).append(this.el),this.trigger("ready",{target:this})},html:function(e){if(_.isUndefined(e))return this.el.innerHTML;this.trigger("before:append");var t=this._replaceHTML(e);return this.trigger("append"),t},release:function(){--this._referenceCount,this._referenceCount<=0&&this._destroy()},retain:function(e){++this._referenceCount,e&&this.listenTo(e,"destroyed",e.release)},_replaceHTML:function(e){return this.el.innerHTML="",this.$el.append(e)},_anchorClick:function(e){var t=$(e.currentTarget),i=t.attr("href");return i&&("#"===i[0]||"/"===i[0]&&"/"!==i[1])?(Backbone.history.navigate(i,{trigger:!0}),!1):!0}}),lt.View.extend=function(){a(this);var e=Backbone.View.extend.apply(this,arguments);return e.__parent__=this,l(e),e},i(lt.View,lt.Views),$.fn.view=function(e){e=_.defaults(e||{},{helper:!0});var t="["+ot+"]";e.helper||(t+=":not(["+st+"])");var i=$(this).closest(t);return i&&at[i.attr(ot)]||!1};var ct={};lt.Util={getViewInstance:function(e,t){var i=lt.Util.getViewClass(e,!0);return i?new i(t||{}):e},getViewClass:function(e,t){return _.isString(e)?n(lt,"Views",e,t):_.isFunction(e)?e:!1},getTemplate:function(e,t){var i,n=lt.templatePathPrefix;if(n&&e.substr(0,n.length)!==n&&(e=n+e),e=e.replace(/\.handlebars$/,""),i=Handlebars.templates[e],i||(e+=".handlebars",i=Handlebars.templates[e]),!i&&!t)throw new Error("templates: "+e+" does not exist.");return i},is$:function(e){return _.isObject(e)&&"length"in e},expandToken:function(e,t){function i(e,t){if(e.match(/^("|')/)&&e.match(/("|')$/))return e.replace(/(^("|')|('|")$)/g,"");for(var i=e.split("."),n=i.length,r=0;t&&n>r;r++)"this"!==i[r]&&(t=t[i[r]]);return t}if(e&&e.indexOf&&e.indexOf("{{")>=0){for(var n,r=/(?:\{?[^{]+)|(?:\{\{([^}]+)\}\})/g,o=[];n=r.exec(e);)if(n[1]){var s=n[1].split(/\s+/);if(s.length>1){var a=s.shift();s=_.map(s,function(e){return i(e,t)}),Handlebars.helpers[a]?o.push(Handlebars.helpers[a].apply(t,s)):o.push(n[0])}else o.push(i(s[0],t))}else o.push(n[0]);e=o.join("")}return e},tag:function(e,t,i){var n=_.omit(e,"tagName"),r=e.tagName||"div";return"<"+r+" "+_.map(n,function(e,t){if(_.isUndefined(e)||"expand-tokens"===t)return"";var n=e;return i&&(n=lt.Util.expandToken(e,i)),("className"===t?"class":t)+'="'+Handlebars.Utils.escapeExpression(n)+'"'}).join(" ")+">"+(_.isUndefined(t)?"":t)+"</"+r+">"}},lt.Mixins={},_.extend(lt.View,{mixin:function(e){lt.Mixins[e](this)},registerMixin:function(e,t,i){lt.Mixins[e]=function(e){var n=!!e.cid;i&&_.extend(n?e:e.prototype,i),n?t.call(e):e.on("configure",t)}}}),lt.View.prototype.mixin=function(e){lt.Mixins[e](this)};var ht=lt.View.prototype.on;ct.event={name:"_events",configure:function(){var e=this;c(this.constructor,"_events",!0,function(t){e.on.apply(e,t)}),c(this,"events",!1,function(t,i){e.on(i,t,e)})}},_.extend(lt.View,{on:function(e,t){return a(this),h(this,e,t)?this:(_.isObject(e)?_.each(e,function(e,t){this.on(t,e)},this):_.isArray(t)?_.each(t,function(t){this._events.push([e,t])},this):this._events.push([e,t]),this)}}),_.extend(lt.View.prototype,{on:function(e,t,i){return h(this,e,t,i)?this:(_.isObject(e)&&arguments.length<3?_.each(e,function(e,i){this.on(i,e,t||this)},this):_.each(_.isArray(t)?t:[t],function(t){var n=y.call(this,e,t,i||this);"DOM"!==n.type||this._eventsDelegated?this._addEvent(n):(this._eventsToDelegate||(this._eventsToDelegate=[]),this._eventsToDelegate.push(n))},this),this)},delegateEvents:function(e){this.undelegateEvents(),e&&(_.isFunction(e)&&(e=e.call(this)),this._eventsToDelegate=[],this.on(e)),this._eventsToDelegate&&_.each(this._eventsToDelegate,this._addEvent,this),this._eventsDelegated=!0},_addEvent:function(e){if(e.handler._thoraxBind)return ht.call(this,e.name,e.handler,e.context||this);var t=v.call(this,e.type+"-event:",e);if("view"===e.type)e.context&&e.context!==this&&e.context instanceof lt.View?u(e.context,this,e.name,t,e.context):ht.call(this,e.name,t,e.context||this);else{e.nested||(t=g(t,this.cid));var i=e.name+".delegateEvents"+this.cid;e.selector?this.$el.on(i,e.selector,t):this.$el.on(i,t)}}}),lt.View.prototype.bind=lt.View.prototype.on,lt.View.on("ready",function(e){function t(t){t._isReady||t.trigger("ready",e)}this._isReady||(this._isReady=!0,_.each(this.children,t),this.on("child",t))});var ut,dt=/^(nested\s+)?(\S+)(?:\s+(.+))?/,pt=[];m(["mousedown","mouseup","mousemove","mouseover","mouseout","touchstart","touchend","touchmove","click","dblclick","keyup","keydown","keypress","submit","change","focus","blur"]);var ft="data-view-tmp",mt={},gt={_ensureElement:function(){lt.View.prototype._ensureElement.apply(this,arguments),this.$el.attr(st,this._helperName)},_getContext:function(){return this.parent._getContext.apply(this.parent,arguments)}};lt.HelperView=lt.View.extend(gt),Handlebars.registerViewHelper=function(e,t,i){2===arguments.length&&(t.factory?i=t.callback:(i=t,t=lt.HelperView));var n=t.attributeWhiteList;Handlebars.registerHelper(e,function(){var r=_.toArray(arguments),o=r.pop(),s=p(o).view,a=o.hash["expand-tokens"];a&&(delete o.hash["expand-tokens"],_.each(o.hash,function(e,t){o.hash[t]=lt.Util.expandToken(e,this)},this));var l={inverse:o.inverse,options:o.hash,declaringView:s,parent:w(s),_helperName:e,_helperOptions:{options:b(o),args:_.clone(r)}};f(o.hash);var c=_.clone(o.hash);n&&_.each(n,function(e,t){delete c[t],_.isUndefined(o.hash[t])||(l[e]=o.hash[t])}),c.tagName&&(l.tagName=c.tagName),l.attributes=function(){var e=t.prototype&&t.prototype.attributes||{};return _.isFunction(e)&&(e=e.apply(this,arguments)),_.extend(e,_.omit(c,["tagName"])),e.className&&(e["class"]=e.className,delete e.className),e},o.fn?l.template=o.fn:t&&t.prototype&&!t.prototype.template&&(l.template=Handlebars.VM.noop);var h=_.find(s._previousHelpers,function(e){return C(l,e)});if(h)s._previousHelpers=_.without(s._previousHelpers,h),s.children[h.cid]=h;else{if(t.factory){if(h=t.factory(r,l),!h)return"";h._helperName=l._helperName,h._helperOptions=l._helperOptions}else h=new t(l);r.push(h),s._addChild(h),s.trigger.apply(s,["helper",e].concat(r)),s.trigger.apply(s,["helper:"+e].concat(r)),i&&i.apply(this,r)}return c[ft]=h.cid,t.modifyHTMLAttributes&&t.modifyHTMLAttributes(c,h),new Handlebars.SafeString(lt.Util.tag(c,"",a?this:null))});var r=Handlebars.helpers[e];return r},lt.View.on("append",function(e,t){(e||this.$el).find("["+ft+"]").forEach(function(e){var i=e.getAttribute(ft),n=this.children[i];n&&(mt[i]?(n.render(mt[i]),delete mt[i]):n.ensureRendered(),$(e).replaceWith(n.el),t&&t(n.el))},this)}),_.extend(lt.View.prototype,{getObjectOptions:function(e){return e&&this._objectOptionsByCid[e.cid]},bindDataObject:function(e,t,i){if(this._boundDataObjectsByCid[t.cid])return!1;this._boundDataObjectsByCid[t.cid]=t;var i=this._modifyDataObjectOptions(t,_.extend({},ct[e].defaultOptions,i));this._objectOptionsByCid[t.cid]=i,V.call(this,e,t,this.constructor),V.call(this,e,t,this);var n=ct[e];return n.bindCallback&&n.bindCallback.call(this,t,i),t.shouldFetch&&t.shouldFetch(i)?T(t,i):ct[e].change&&ct[e].change.call(this,t,i),!0},unbindDataObject:function(e){return this._boundDataObjectsByCid[e.cid]?(delete this._boundDataObjectsByCid[e.cid],this.stopListening(e),delete this._objectOptionsByCid[e.cid],!0):!1},_modifyDataObjectOptions:function(e,t){return t}});var vt="data-model-cid";lt.Model=Backbone.Model.extend({isEmpty:function(){return!this.isPopulated()},isPopulated:function(){var e=_.clone(this.attributes),t=s(this,"defaults")||{};for(var i in t){if(e[i]!=t[i])return!0;delete e[i]}var n=_.keys(e);return n.length>1||1===n.length&&n[0]!==this.idAttribute},shouldFetch:function(e){var t;try{t=s(this,"url")}catch(i){t=!1}return e.fetch&&!!t&&!this.isPopulated()}}),lt.Models={},i(lt.Model,lt.Models),x("model",{set:"setModel",defaultOptions:{render:void 0,fetch:!0,success:!1,invalid:!0},change:H,$el:"$el",cidAttrName:vt}),lt.View.on({model:{invalid:function(e,t){this.getObjectOptions(e).invalid&&this.trigger("invalid",t,e)},error:function(e,t){this.trigger("error",t,e)},change:function(e,t){ct.model.change.call(this,e,t)}}}),$.fn.model=function(e){var t=$(this),i=t.closest("["+vt+"]"),n=i&&i.attr(vt);if(n){var e=e||t.view();if(e&&e.model&&e.model.cid===n)return e.model||!1;var r=t.collection(e);if(r)return r.get(n)}return!1};var _t=Backbone.Collection.prototype.fetch,yt=Backbone.Collection.prototype.set,wt=lt.View.prototype._replaceHTML,bt="data-collection-cid",Ct="data-collection-empty",xt="data-collection-element",Vt=1;lt.Collection=Backbone.Collection.extend({model:lt.Model||Backbone.Model,initialize:function(){return this.cid=_.uniqueId("collection"),Backbone.Collection.prototype.initialize.apply(this,arguments)},isEmpty:function(){return this.length>0?!1:0===this.length&&this.isPopulated()},isPopulated:function(){return this._fetched||this.length>0||!this.length&&!s(this,"url")},shouldFetch:function(e){return e.fetch&&!!s(this,"url")&&!this.isPopulated()},fetch:function(e){e=e||{};var t=e.success;return e.success=function(e,i){e._fetched=!0,t&&t(e,i)},_t.apply(this,arguments)},set:function(e,t){return this._fetched=!!e,yt.call(this,e,t)}}),_.extend(lt.View.prototype,{getCollectionViews:function(e){return _.filter(this.children,function(t){return t instanceof lt.CollectionView?!e||t.collection===e:!1})},updateFilter:function(e){_.invoke(this.getCollectionViews(e),"updateFilter")}}),lt.Collections={},i(lt.Collection,lt.Collections),x("collection",{set:"setCollection",bindCallback:k,defaultOptions:{render:void 0,fetch:!0,success:!1,invalid:!0,change:!0},change:O,$el:"getCollectionElement",cidAttrName:bt}),lt.CollectionView=lt.View.extend({_defaultTemplate:Handlebars.VM.noop,_collectionSelector:"["+xt+"]",_replaceHTML:function(e){if(!(this.collection&&this.getObjectOptions(this.collection)&&this._renderCount))return wt.call(this,e);var t,i=this.getCollectionElement();t=wt.call(this,e),i.attr("data-view-cid")||this.getCollectionElement().replaceWith(i)},render:function(){var e=this.shouldRender();lt.View.prototype.render.apply(this,arguments),e||this.renderCollection()},appendItem:function(e,t,i){if(e){var n,r=this.getCollectionElement();if(i=_.defaults(i||{},{filter:!0}),t&&t.el&&(t=r.children().indexOf(t.el)+1),e.el||_.isString(e)?(n=e,e=!1):(t=t||this.collection.indexOf(e)||0,n=this.renderItem(e,t)),n){n.cid&&(n.ensureRendered(),this._addChild(n)),_.isString(n)&&!n.match(/^\s*</m)&&(n="<div>"+n+"</div>");var o=n.$el||$($.trim(n)).filter(function(){return this.nodeType===Vt});e&&o.attr(vt,e.cid);var s=t>0?this.collection.at(t-1):!1;if(s){var a=r.children("["+vt+'="'+s.cid+'"]').last();a.after(o)}else r.prepend(o);this.trigger("append",null,function(t){t.setAttribute(vt,e.cid)}),i.silent||this.trigger("rendered:item",this,this.collection,e,o,t),i.filter&&F.call(this,e)}return n}},updateItem:function(e){var t=this.getCollectionElement(),i=t.find("["+vt+'="'+e.cid+'"]');i.attr(ot)||(this.removeItem(i),this.appendItem(e))},removeItem:function(e){var t=e;if(e.cid){var i=this.getCollectionElement();t=i.find("["+vt+'="'+e.cid+'"]')}if(!t.length)return!1;t.remove();var n=t.attr(ot),r=this.children[n];return r&&this._removeChild(r),!0},renderCollection:function(){this.collection?(this.collection.isEmpty()?D.call(this):(j.call(this),this.collection.forEach(function(e,t){this.appendItem(e,t)},this)),this.trigger("rendered:collection",this,this.collection)):D.call(this)},emptyClass:"empty",renderEmpty:function(){if(this.emptyView||r.call(this,"emptyView",{extension:"-empty"}),this.emptyTemplate||this.emptyView||o.call(this,"emptyTemplate",{extension:"-empty",required:!1}),this.emptyView){var e={};this.emptyTemplate&&(e.template=this.emptyTemplate);var t=lt.Util.getViewInstance(this.emptyView,e);return t.ensureRendered(),t}return this.emptyTemplate&&this.renderTemplate(this.emptyTemplate)},renderItem:function(e,t){if(this.itemView||r.call(this,"itemView",{extension:"-item",required:!1}),this.itemTemplate||this.itemView||o.call(this,"itemTemplate",{extension:"-item",required:!this.itemView}),this.itemView){var i={model:e};return this.itemTemplate&&(i.template=this.itemTemplate),lt.Util.getViewInstance(this.itemView,i)}return this.renderTemplate(this.itemTemplate,this.itemContext(e,t))},itemContext:function(e){return e.attributes},appendEmpty:function(){var e=this.getCollectionElement();e.empty();var t=this.renderEmpty();t&&this.appendItem(t,0,{silent:!0,filter:!1}),this.trigger("rendered:empty",this,this.collection)},getCollectionElement:function(){var e=this.$(this._collectionSelector);return 0===e.length?this.$el:e},updateFilter:function(){L.call(this)}}),lt.CollectionView.on({collection:{reset:O,sort:O,change:function(e){var t=this.getObjectOptions(this.collection);t&&t.change&&this.updateItem(e),F.call(this,e)},add:function(e){var t=this.getCollectionElement();if(1===this.collection.length&&t.length&&j.call(this),t.length){var i=this.collection.indexOf(e);this.appendItem(e,i)}},remove:function(e){var t=this.getCollectionElement();this.removeItem(e),0===this.collection.length&&t.length&&D.call(this)}}}),lt.View.on({collection:{invalid:function(e,t){this.getObjectOptions(e).invalid&&this.trigger("invalid",t,e)},error:function(e,t){this.trigger("error",t,e)}}}),$.fn.collection=function(e){if(e&&e.collection)return e.collection;var t=$(this),i=t.closest("["+bt+"]"),n=i&&i.attr(bt);return n&&(e=t.view())?e.collection:!1},ct.model.defaultOptions.populate=!0;var Tt=ct.model.change;ct.model.change=function(e,t){if(this._isChanging=!0,Tt.apply(this,arguments),this._isChanging=!1,!t||!t.serializing){var i=M(this);this._renderCount&&i&&this.populate(!i.context&&this.model.attributes,i)}},_.extend(lt.View.prototype,{serialize:function(){for(var e,t,i,n=0;n<arguments.length;++n)_.isFunction(arguments[n])?e=arguments[n]:_.isObject(arguments[n])&&("stopPropagation"in arguments[n]&&"preventDefault"in arguments[n]?i=arguments[n]:t=arguments[n]);if(!i||this._preventDuplicateSubmission(i)){t=_.extend({set:!0,validate:!0,children:!0},t||{});var r=t.attributes||{},o=this,s=[];if(S(this,t,function(e){var i=o._getInputValue(e,t,s);_.isUndefined(i)||A(r,e.name,{mode:"serialize"},function(e,t){e[t]?_.isArray(e[t])?e[t].push(i):e[t]=[e[t],i]:e[t]=i})}),t._silent||this.trigger("serialize",r,t),t.validate){var a=this.validateInput(r);if(a&&a.length&&(s=s.concat(a)),this.trigger("validate",r,s,t),s.length)return this.trigger("invalid",s),void 0}return t.set&&this.model&&!this.model.set(r,{silent:t.silent,serializing:!0})?!1:(e&&e.call(this,r,_.bind(I,this)),r)}},_preventDuplicateSubmission:function(e,t){e.preventDefault();var i=$(e.target);return"form"!==(e.target.tagName||"").toLowerCase()&&(i=$(e.target).closest("form")),i.attr("data-submit-wait")?!1:(i.attr("data-submit-wait","true"),t&&t.call(this,e),!0)},populate:function(e,t){t=_.extend({children:!0},t||{});var i,e=e||this._getContext();S(this,t,function(t){A(e,t.name,{mode:"populate"},function(e,n){if(i=e&&e[n],!_.isUndefined(i)){var r="checkbox"===t.type||"radio"===t.type;r&&_.isBoolean(i)?t.checked=i:r?t.checked=i==t.value:t.value=i}})}),++this._populateCount,t._silent||this.trigger("populate",e)},validateInput:function(){},_getInputValue:function(e){if("checkbox"!==e.type&&"radio"!==e.type){if(e.multiple===!0){var t=[];return $("option",e).each(function(){this.selected&&t.push(this.value)}),t}return e.value}return e.checked?e.getAttribute("value")||!0:void 0},_populateCount:0}),lt.View.on({"before:rendered":function(){if(this._renderCount){var e=this.getObjectOptions(this.model);this.previousFormData=U(this.serialize(_.extend({set:!1,validate:!1,_silent:!0},e)),function(e){return""!==e&&null!=e})}},rendered:function(){var e=M(this);!e||this._isChanging||this._populateCount||this.populate(!e.context&&this.model.attributes,e),this.previousFormData&&this.populate(this.previousFormData,_.extend({_silent:!0},e)),this.previousFormData=null}}),lt.View.on({invalid:B,error:B,deactivated:function(){this.$el&&I.call(this)}});var Et="data-layout-cid";lt.LayoutView=lt.View.extend({_defaultTemplate:Handlebars.VM.noop,render:function(){var e=lt.View.prototype.render.apply(this,arguments);return this.template===Handlebars.VM.noop?P.call(this):q.call(this),e},setView:function(e,t){t=_.extend({scroll:!0},t||{}),_.isString(e)&&(e=new(lt.Util.registryGet(lt,"Views",e,!1))),this.ensureRendered();var i,n,r,o=this._view;return e===o?!1:(this.trigger("change:view:start",e,o,t),n=_.bind(function(){o&&(o.$el.remove(),R.call(o,"deactivated",t),this._removeChild(o))},this),i=_.bind(function(){if(e){e.ensureRendered(),R.call(this,"activated",t),e.trigger("activated",t),this._view=e;var i=Q.call(this);this._view.appendTo(i),this._addChild(e)}else this._view=void 0},this),r=_.bind(function(){this.trigger("change:view:end",e,o,t)},this),t.transition?t.transition(e,o,i,n,r):(n(),i(),r()),e)},getView:function(){return this._view}}),Handlebars.registerHelper("layout-element",function(e){var i=p(e).view;if(!i.getView)throw new Error(t("layout-element-helper"));return e.hash[Et]=i.cid,f(e.hash),new Handlebars.SafeString(lt.Util.tag.call(this,e.hash,"",this))}),lt.CollectionHelperView=lt.CollectionView.extend({events:{"rendered:item":z("rendered:item"),"rendered:collection":z("rendered:collection"),"rendered:empty":z("rendered:empty")},getCollectionElement:function(){return this.$el},constructor:function(e){e.options["item-template"]&&(e.itemTemplate=lt.Util.getTemplate(e.options["item-template"])),e.options["empty-template"]&&(e.emptyTemplate=lt.Util.getTemplate(e.options["empty-template"])),!e.itemTemplate&&e.template&&e.template!==Handlebars.VM.noop&&(e.itemTemplate=e.template,e.template=Handlebars.VM.noop),!e.emptyTemplate&&e.inverse&&e.inverse!==Handlebars.VM.noop&&(e.emptyTemplate=e.inverse,e.inverse=Handlebars.VM.noop);var t=_.isFunction(e.itemContext),i=_.isFunction(e.itemFilter),n=lt.HelperView.call(this,e);return t?this.itemContext=_.bind(this.itemContext,this.parent):_.isString(this.itemContext)&&(this.itemContext=_.bind(this.parent[this.itemContext],this.parent)),i?this.itemFilter=_.bind(this.itemFilter,this.parent):_.isString(this.itemFilter)&&(this.itemFilter=_.bind(this.parent[this.itemFilter],this.parent)),this.parent.name&&(this.emptyView||this.parent.renderEmpty||(this.emptyView=lt.Util.getViewClass(this.parent.name+"-empty",!0)),this.emptyTemplate||this.parent.renderEmpty||(this.emptyTemplate=lt.Util.getTemplate(this.parent.name+"-empty",!0)),this.itemView||this.parent.renderItem||(this.itemView=lt.Util.getViewClass(this.parent.name+"-item",!0)),this.itemTemplate||this.parent.renderItem||(this.itemTemplate=lt.Util.getTemplate(this.parent.name+"-item",!!this.itemView))),n},setAsPrimaryCollectionHelper:function(){_.each(Ht,function(e){W.call(this,e)},this);var e=this;_.each(["itemFilter","itemContext","renderItem","renderEmpty"],function(t){e.parent[t]&&(e[t]=function(){return e.parent[t].apply(e.parent,arguments)})})}}),_.extend(lt.CollectionHelperView.prototype,gt),lt.CollectionHelperView.attributeWhiteList={"item-context":"itemContext","item-filter":"itemFilter","item-template":"itemTemplate","empty-template":"emptyTemplate","item-view":"itemView","empty-view":"emptyView","empty-class":"emptyClass"};var Ht=["itemTemplate","itemView","emptyTemplate","emptyView"];Handlebars.registerViewHelper("collection",lt.CollectionHelperView,function(e,t){1===arguments.length&&(t=e,e=t.parent.collection,e&&t.setAsPrimaryCollectionHelper(),t.$el.attr(xt,"true"),t.listenTo(t.parent,"change:data-object",function(e,i){"collection"===e&&(t.setAsPrimaryCollectionHelper(),t.setCollection(i))})),e&&t.setCollection(e)}),Handlebars.registerHelper("collection-element",function(e){if(!p(e).view.renderCollection)throw new Error(t("collection-element-helper"));var i=e.hash;return f(i),i.tagName=i.tagName||"div",i[xt]=!0,new Handlebars.SafeString(lt.Util.tag.call(this,i,"",this))}),Handlebars.registerHelper("empty",function(e,t){1===arguments.length&&(t=e);var i=p(t).view;return 1===arguments.length&&(e=i.model),i._emptyListeners||(i._emptyListeners={}),e&&!i._emptyListeners[e.cid]&&e.models&&"length"in e&&(i._emptyListeners[e.cid]=!0,i.listenTo(e,"remove",function(){0===e.length&&i.render()}),i.listenTo(e,"add",function(){1===e.length&&i.render()}),i.listenTo(e,"reset",function(){i.render()})),!e||e.isEmpty()?t.fn(this):t.inverse(this)}),Handlebars.registerHelper("template",function(e,t){var i=_.extend({fn:t&&t.fn},this,t?t.hash:{}),n=p(t).view.renderTemplate(e,i);
return new Handlebars.SafeString(n)}),Handlebars.registerHelper("yield",function(e){return p(e).yield&&e.data.yield()}),Handlebars.registerHelper("url",function(e){var t;if(arguments.length>2)t=_.map(_.head(arguments,arguments.length-1),encodeURIComponent).join("/");else{var i=arguments[1],n=i&&i.hash||i;t=n&&n["expand-tokens"]?lt.Util.expandToken(e,this):e}if(Backbone.history._hasPushState){var r=Backbone.history.options.root;return"/"===r&&"/"===t.substr(0,1)?t:r+t}return"#"+t}),Handlebars.registerViewHelper("view",{factory:function(e,t){var i=e.length>=1?e[0]:lt.View;return lt.Util.getViewInstance(i,t.options)},modifyHTMLAttributes:function(e,t){e.tagName=t.el.tagName.toLowerCase()},callback:function(e){var i=arguments[arguments.length-1],n=i._helperOptions.options,r=i.cid;if(!_.isString(e)&&n.hash&&_.keys(n.hash).length>0)throw new Error(t("view-helper-hash-args"));n.fn&&(mt[r]=n.fn)}});var Ot="data-call-method",kt="data-trigger-event";Handlebars.registerHelper("button",function(e,i){1===arguments.length&&(i=e,e=i.hash.method);var n=i.hash,r=n["expand-tokens"];if(delete n["expand-tokens"],!e&&!i.hash.trigger)throw new Error(t("button-trigger"));return f(n),n.tagName=n.tagName||"button",n.trigger&&(n[kt]=n.trigger),delete n.trigger,e&&(n[Ot]=e),new Handlebars.SafeString(lt.Util.tag(n,i.fn?i.fn(this):"",r?this:null))}),Handlebars.registerHelper("link",function(){var e=_.toArray(arguments),i=e.pop(),n=i.hash,r=0===e.length?[n.href]:e,o=n["expand-tokens"];if(delete n["expand-tokens"],!r[0]&&""!==r[0])throw new Error(t("link-href"));return f(n),r.push(i),n.href=Handlebars.helpers.url.apply(this,r),n.tagName=n.tagName||"a",n.trigger&&(n[kt]=i.hash.trigger),delete n.trigger,n[Ot]="_anchorClick",new Handlebars.SafeString(lt.Util.tag(n,i.fn?i.fn(this):"",o?this:null))});var $t,Lt="["+Ot+"], ["+kt+"]";$(document).ready(function(){lt._fastClickEventName||X()});var Ft="data-element-tmp";Handlebars.registerHelper("element",function(e,t){f(t.hash);var i=_.uniqueId("element"),n=p(t).view;return t.hash[Ft]=i,n._elementsByCid||(n._elementsByCid={}),n._elementsByCid[i]=e,new Handlebars.SafeString(lt.Util.tag(t.hash))}),lt.View.on("append",function(e,t){(e||this.$el).find("["+Ft+"]").forEach(function(e){var i=$(e),n=i.attr(Ft),r=this._elementsByCid[n];_.isFunction(r)&&(r=r.call(this)),i.replaceWith(r),t&&t(r)},this)}),Handlebars.registerHelper("super",function(e){var i=p(e).view,n=i.constructor&&i.constructor.__super__;if(n){var r=n.template;if(!r){if(!n.name)throw new Error(t("super-parent"));r=n.name}return _.isString(r)&&(r=lt.Util.getTemplate(r,!1)),new Handlebars.SafeString(r(this,e))}return""});var Nt,jt="load:start",Dt="load:end";lt.setRootObject=function(e){Nt=e},lt.loadHandler=function(e,t,i){var n=_.uniqueId("load");return function(r,o,s){function a(){if(!c.timeout||c.run){var t=void 0!==l._loadingTimeoutDuration?l._loadingTimeoutDuration:lt.View.prototype._loadingTimeoutDuration;c.timeout=setTimeout(function(){try{c.events.length&&(c.run=!0,e.call(l,c.message,c.background,c))}catch(t){lt.onException("loadStart",t)}},1e3*t)}}var l=i||this;l._loadInfo=l._loadInfo||{};var c=l._loadInfo[n];c?(clearTimeout(c.endTimeout),c.message=r,!o&&c.background&&(c.background=!1,a())):(c=l._loadInfo[n]=_.extend({isLoading:function(){return c.events.length},cid:n,events:[],timeout:0,message:r,background:!!o},Backbone.Events),a()),_.indexOf(c.events,s)>=0||(c.events.push(s),s.on(Dt,function h(){var e=l._loadingTimeoutEndDuration;void 0===e&&(e=lt.View.prototype._loadingTimeoutEndDuration);var i=c.events,r=_.indexOf(i,s);r>=0&&!s.isLoading()&&(i.splice(r,1),_.indexOf(i,s)<0&&s.off(Dt,h)),i.length||(clearTimeout(c.endTimeout),c.endTimeout=setTimeout(function(){try{i.length||(c.run&&(t&&t.call(l,c.background,c),c.trigger(Dt,c)),clearTimeout(c.timeout),c=l._loadInfo[n]=void 0)}catch(e){lt.onException("loadEnd",e)}},1e3*e))}))}},lt.forwardLoadEvents=function(e,t,i){function n(r,o,s){i&&e.off(jt,n),t.trigger(jt,r,o,s)}return e.on(jt,n),{off:function(){e.off(jt,n)}}},lt.mixinLoadable=function(e,t){_.extend(e,{_loadingClassName:"loading",_loadingTimeoutDuration:.33,_loadingTimeoutEndDuration:.1,onLoadStart:function(e,i,n){var r=t?this.parent:this;r&&r.el&&(r.nonBlockingLoad||i||!Nt||Nt===this||Nt.trigger(jt,e,i,n),r._isLoading=!0,$(r.el).addClass(r._loadingClassName),r.trigger("change:load-state","start",i))},onLoadEnd:function(){var e=t?this.parent:this;e&&e.el&&(e._isLoading=!1,$(e.el).removeClass(e._loadingClassName),e.trigger("change:load-state","end"))}})},lt.mixinLoadableEvents=function(e,t){_.extend(e,{_loadCount:0,isLoading:function(){return this._loadCount>0},loadStart:function(e,i){this._loadCount++;var n=t?this.parent:this;n.trigger(jt,e,i,n)},loadEnd:function(){this._loadCount--;var e=t?this.parent:this;e.trigger(Dt,e)}})},lt.mixinLoadable(lt.View.prototype),lt.mixinLoadableEvents(lt.View.prototype),lt.HelperView&&(lt.mixinLoadable(lt.HelperView.prototype,!0),lt.mixinLoadableEvents(lt.HelperView.prototype,!0)),lt.CollectionHelperView&&(lt.mixinLoadable(lt.CollectionHelperView.prototype,!0),lt.mixinLoadableEvents(lt.CollectionHelperView.prototype,!0)),lt.sync=function(e,t,i){var n=this,r=i.complete;return i.complete=function(){n._request=void 0,n._aborted=!1,r&&r.apply(this,arguments)},this._request=Backbone.sync.apply(this,arguments),this._request};var Ut=[];lt.Model&&Ut.push(lt.Model),lt.Collection&&Ut.push(lt.Collection),_.each(Ut,function(e){var t=e.prototype.fetch;lt.mixinLoadableEvents(e.prototype,!1),_.extend(e.prototype,{sync:lt.sync,fetch:function(i){function n(e){var t=i[e];i[e]=function(){r.loadEnd(),t&&t.apply(this,arguments)}}if(i=i||{},e===lt.Collection&&(_.find(["reset","remove","add","update"],function(e){return!_.isUndefined(i[e])})||(i.reset=!0)),!i.loadTriggered){var r=this;n("success"),n("error"),r.loadStart(void 0,i.background)}return Z.call(this,i||{},t)},load:function(e,t,i){2!==arguments.length||_.isFunction(t)||(i=t,t=!1),i=i||{},i.background||this.isPopulated()||!Nt||(this.isLoading()?Nt.trigger(jt,i.message,i.background,this):lt.forwardLoadEvents(this,Nt,!0)),Y.call(this,e,t,i)}})}),lt.Util.bindToRoute=K,lt.View.prototype._modifyDataObjectOptions=function(e,t){return t.ignoreErrors=this.ignoreFetchError,t.background=this.nonBlockingLoad,t},lt.HelperView.prototype._modifyDataObjectOptions=lt.CollectionHelperView.prototype._modifyDataObjectOptions=function(e,t){return t.ignoreErrors=this.parent.ignoreFetchError,t.background=this.parent.nonBlockingLoad,t},ct.collection.loading=function(){var e=this.loadingView,t=this.loadingTemplate,i=this.loadingPlacement;if(e||t){var n=lt.loadHandler(_.bind(function(){var n;if(0===this.collection.length&&this.$el.empty(),e){var r=lt.Util.getViewInstance(e);this._addChild(r),t?r.render(t):r.render(),n=r}else n=this.renderTemplate(t);var o=i?i.call(this):this.collection.length;this.appendItem(n,o),this.$el.children().eq(o).attr("data-loading-element",this.collection.cid)},this),_.bind(function(){this.$el.find('[data-loading-element="'+this.collection.cid+'"]').remove()},this),this.collection);this.listenTo(this.collection,"load:start",n)}},lt.CollectionHelperView&&_.extend(lt.CollectionHelperView.attributeWhiteList,{"loading-template":"loadingTemplate","loading-view":"loadingView","loading-placement":"loadingPlacement"}),lt.View.on({"load:start":lt.loadHandler(function(e,t,i){this.onLoadStart(e,t,i)},function(e,t){this.onLoadEnd(t)}),collection:{"load:start":function(e,t,i){this.trigger(jt,e,t,i)}},model:{"load:start":function(e,t,i){this.trigger(jt,e,t,i)}}}),Handlebars.registerHelper("loading",function(e){var t=p(e).view;return t.off("change:load-state",tt,t),t.on("change:load-state",tt,t),t._isLoading?e.fn(this):e.inverse(this)});var Bt=navigator.userAgent.match(/(iPhone|iPod|iPad)/i),St=navigator.userAgent.toLowerCase().indexOf("android")>-1?1:0,At=St?1:0;lt.Util.scrollTo=function(e,t){function i(){window.scrollTo(e,t)}return t=t||At,Bt?_.defer(i):i(),[e,t]},lt.LayoutView.on("change:view:end",function(e,t,i){i&&i.scroll&&lt.Util.scrollTo(0,0)}),lt.Util.scrollToTop=function(){return this.scrollTo(0,0)},m(["singleTap","doubleTap","longTap","swipe","swipeUp","swipeDown","swipeLeft","swipeRight"]),lt.View.on({"submit form":function(){var e=$(":focus")[0];e&&e.blur()}}),$.fn.tapHoldAndEnd=function(e,t,i){return this.each(function(){function n(){clearTimeout(o),r&&s&&i(s),s=void 0,r=!1}var r,o,s;$(this).on("touchstart",e,function(e){n(),s=e.currentTarget,o=setTimeout(function(){r=!0,t(s)},50)}).on("touchmove touchend",n),$(document).on("touchcancel",n)})};var It=!St;lt.configureTapHighlight=function(e,t){function i(e){var i=e&&e.tagName.toLowerCase();return("input"===i||"select"===i||"textarea"===i)&&(e=$(e).closest("[data-tappable=true]")[0]||e),e?($(e).addClass(t),!1):void 0}function n(){$("."+t).removeClass(t)}It=e,t=t||"tap-highlight",e||$(document.body).tapHoldAndEnd("[data-tappable=true], a, input, button, select, textarea",i,n)};var Mt={A:!0,INPUT:!0,BUTTON:!0,SELECT:!0,TEXTAREA:!0};lt.View.on({rendered:nt,"rendered:collection":nt,"rendered:item":nt,"rendered:empty":nt});var Rt=lt.View.prototype._addEvent;lt.View.prototype._addEvent=function(e){return this._domEvents=this._domEvents||[],"DOM"===e.type&&this._domEvents.push(e.originalName),Rt.call(this,e)}}();