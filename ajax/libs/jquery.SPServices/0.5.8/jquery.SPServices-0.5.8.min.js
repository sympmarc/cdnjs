/*
 * SPServices - Work with SharePoint's Web Services using jQuery
 * Version 0.5.8
 * @requires jQuery v1.4.2 or greater
 *
 * Copyright (c) 2009-2010 Sympraxis Consulting LLC
 * Examples and docs at:
 * http://spservices.codeplex.com
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 */
/**
 * @description Work with SharePoint's Web Services using jQuery
 * @type jQuery
 * @name SPServices
 * @category Plugins/SPServices
 * @author Sympraxis Consulting LLC/marc.anderson@sympraxisconsulting.com
 */
(function(D){var g="/";var m="Alerts";var l="Authentication";var p="Copy";var J="Forms";var n="Lists";var H="Meetings";var d="People";var b="Permissions";var q="PublishedLinksService";var x="Search";var t="SiteData";var K="SocialDataService";var I="usergroup";var F="UserProfileService";var R="Versions";var j="Views";var C="WebPartPages";var o="Webs";var c="Workflow";var e="";var G=new Array();G.GetAlerts=[m,false];G.DeleteAlerts=[m,true];G.Mode=[l,false];G.Login=[l,false];G.CopyIntoItems=[p,true];G.CopyIntoItemsLocal=[p,true];G.GetItem=[p,false];G.GetForm=[J,false];G.GetFormCollection=[J,false];G.AddAttachment=[n,true];G.AddList=[n,true];G.CheckInFile=[n,true];G.CheckOutFile=[n,true];G.DeleteList=[n,true];G.GetAttachmentCollection=[n,false];G.GetList=[n,false];G.GetListAndView=[n,false];G.GetListCollection=[n,false];G.GetListContentType=[n,false];G.GetListContentTypes=[n,false];G.GetListItems=[n,false];G.UpdateList=[n,true];G.UpdateListItems=[n,true];G.AddMeeting=[H,true];G.CreateWorkspace=[H,true];G.RemoveMeeting=[H,true];G.SetWorkSpaceTitle=[H,true];G.SearchPrincipals=[d,false];G.AddPermission=[b,true];G.AddPermissionCollection=[b,true];G.GetPermissionCollection=[b,true];G.RemovePermission=[b,true];G.RemovePermissionCollection=[b,true];G.UpdatePermission=[b,true];G.GetLinks=[q,true];G.GetPortalSearchInfo=[x,false];G.GetSearchMetadata=[x,false];G.Query=[x,false];G.QueryEx=[x,false];G.Status=[x,false];G.EnumerateFolder=[t,false];G.AddComment=[K,true];G.AddTag=[K,true];G.AddTagByKeyword=[K,true];G.CountCommentsOfUser=[K,false];G.CountCommentsOfUserOnUrl=[K,false];G.CountCommentsOnUrl=[K,false];G.CountRatingsOnUrl=[K,false];G.CountTagsOfUser=[K,false];G.DeleteComment=[K,true];G.DeleteRating=[K,true];G.DeleteTag=[K,true];G.DeleteTagByKeyword=[K,true];G.DeleteTags=[K,true];G.GetAllTagTerms=[K,false];G.GetAllTagTermsForUrlFolder=[K,false];G.GetAllTagUrls=[K,false];G.GetAllTagUrlsByKeyword=[K,false];G.GetCommentsOfUser=[K,false];G.GetCommentsOfUserOnUrl=[K,false];G.GetCommentsOnUrl=[K,false];G.GetRatingAverageOnUrl=[K,false];G.GetRatingOfUserOnUrl=[K,false];G.GetRatingOnUrl=[K,false];G.GetRatingsOfUser=[K,false];G.GetRatingsOnUrl=[K,false];G.GetSocialDataForFullReplication=[K,false];G.GetTags=[K,true];G.GetTagsOfUser=[K,true];G.GetTagTerms=[K,true];G.GetTagTermsOfUser=[K,true];G.GetTagTermsOnUrl=[K,true];G.GetTagUrlsOfUser=[K,true];G.GetTagUrlsOfUserByKeyword=[K,true];G.GetTagUrls=[K,true];G.GetTagUrlsByKeyword=[K,true];G.SetRating=[K,true];G.UpdateComment=[K,true];G.AddGroup=[I,true];G.AddGroupToRole=[I,true];G.AddRole=[I,true];G.AddUserToGroup=[I,true];G.AddUserToRole=[I,true];G.GetAllUserCollectionFromWeb=[I,false];G.GetGroupCollection=[I,false];G.GetGroupCollectionFromRole=[I,false];G.GetGroupCollectionFromSite=[I,false];G.GetGroupCollectionFromUser=[I,false];G.GetGroupCollectionFromWeb=[I,false];G.GetGroupInfo=[I,false];G.GetRoleCollection=[I,false];G.GetRoleCollectionFromGroup=[I,false];G.GetRoleCollectionFromUser=[I,false];G.GetRoleCollectionFromWeb=[I,false];G.GetRoleInfo=[I,false];G.GetRolesAndPermissionsForCurrentUser=[I,false];G.GetRolesAndPermissionsForSite=[I,false];G.GetUserCollection=[I,false];G.GetUserCollectionFromGroup=[I,false];G.GetUserCollectionFromRole=[I,false];G.GetUserCollectionFromSite=[I,false];G.GetUserCollectionFromWeb=[I,false];G.GetUserInfo=[I,false];G.GetUserLoginFromEmail=[I,false];G.RemoveGroup=[I,true];G.RemoveRole=[I,true];G.RemoveUserFromGroup=[I,true];G.GetCommonMemberships=[F,false];G.GetUserColleagues=[F,false];G.GetUserLinks=[F,false];G.GetUserMemberships=[F,false];G.GetUserPinnedLinks=[F,false];G.GetUserProfileByName=[F,false];G.GetUserProfileCount=[F,false];G.GetUserProfileSchema=[F,false];G.ModifyUserPropertyByAccountName=[F,true];G.DeleteAllVersions=[R,true];G.DeleteVersion=[R,true];G.GetVersions=[R,false];G.RestoreVersion=[R,true];G.GetViewCollection=[j,false];G.AddWebPart=[C,true];G.GetWebPart2=[C,false];G.GetWebPartPage=[C,false];G.GetWebPartProperties=[C,false];G.GetWebPartProperties2=[C,false];G.CreateContentType=[o,true];G.GetColumns=[o,false];G.GetContentType=[o,false];G.GetContentTypes=[o,false];G.GetCustomizedPageStatus=[o,false];G.GetListTemplates=[o,false];G.GetWeb=[o,false];G.GetWebCollection=[o,false];G.GetAllSubWebCollection=[o,false];G.UpdateColumns=[o,true];G.UpdateContentType=[o,true];G.WebUrlFromPageUrl=[o,false];G.GetTemplatesForItem=[c,false];G.GetToDosForItem=[c,false];G.GetWorkflowDataForItem=[c,false];G.GetWorkflowTaskData=[c,false];G.StartWorkflow=[c,true];var A=new Object();A.header="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>";A.footer="</soap:Body></soap:Envelope>";A.payload="";D.fn.SPServices=function(S){var T=D.extend({},D.fn.SPServices.defaults,S);A.opheader="<"+T.operation+" ";switch(G[T.operation][0]){case m:A.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/";break;case H:A.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/meetings/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/meetings/";break;case b:A.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/directory/";break;case q:A.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >";SOAPAction="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case x:A.opheader+="xmlns='urn:Microsoft.Search' >";SOAPAction="urn:Microsoft.Search/";break;case K:A.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >";SOAPAction="http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/";break;case I:A.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/directory/";break;case F:A.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >";SOAPAction="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case C:A.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >";SOAPAction="http://microsoft.com/sharepoint/webpartpages/";break;case c:A.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/workflow/' >";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/workflow/";break;default:A.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/'>";SOAPAction="http://schemas.microsoft.com/sharepoint/soap/";break}SOAPAction+=T.operation;A.opfooter="</"+T.operation+">";var U="_vti_bin/"+G[T.operation][0]+".asmx";if(T.webURL.charAt(T.webURL.length-1)==g){U=T.webURL+U}else{if(T.webURL.length>0){U=T.webURL+g+U}else{U=D().SPServices.SPGetCurrentSite()+g+U}}A.payload="";switch(T.operation){case"GetAlerts":break;case"DeleteAlerts":A.payload+="<IDs>";for(i=0;i<T.IDs.length;i++){A.payload+=v("string",T.IDs[i])}A.payload+="</IDs>";break;case"Mode":break;case"Login":A.payload+=v("username",T.username);A.payload+=v("password",T.password);break;case"CopyIntoItems":A.payload+=v("SourceUrl",T.SourceUrl);A.payload+="<DestinationUrls>";for(i=0;i<T.DestinationUrls.length;i++){A.payload+=v("string",T.DestinationUrls[i])}A.payload+="</DestinationUrls>";A.payload+=v("Fields",T.Fields);A.payload+=v("Stream",T.Stream);A.payload+=v("Results",T.Results);break;case"CopyIntoItemsLocal":A.payload+=v("SourceUrl",T.SourceUrl);A.payload+="<DestinationUrls>";for(i=0;i<T.DestinationUrls.length;i++){A.payload+=v("string",T.DestinationUrls[i])}A.payload+="</DestinationUrls>";break;case"GetItem":A.payload+=v("Url",T.Url);A.payload+=v("Fields",T.Fields);A.payload+=v("Stream",T.Stream);break;case"GetForm":A.payload+=v("listName",T.listName);A.payload+=v("formUrl",T.formUrl);break;case"GetFormCollection":A.payload+=v("listName",T.listName);break;case"AddAttachment":A.payload+=v("listName",T.listName);A.payload+=v("listItemID",T.listItemID);A.payload+=v("fileName",T.fileName);A.payload+=v("attachment",T.attachment);break;case"AddList":A.payload+=v("listName",T.listName);A.payload+=v("description",T.description);A.payload+=v("templateID",T.templateID);break;case"CheckInFile":A.payload+=v("pageUrl",T.pageUrl);A.payload+=v("comment",T.comment);A.payload+=v("CheckinType",T.CheckinType);break;case"CheckOutFile":A.payload+=v("pageUrl",T.pageUrl);A.payload+=v("checkoutToLocal",T.checkoutToLocal);A.payload+=v("lastmodified",T.lastmodified);break;case"DeleteList":A.payload+=v("listName",T.listName);break;case"GetAttachmentCollection":A.payload+=v("listName",T.listName);A.payload+=v("listItemID",T.ID);break;case"GetList":A.payload+=v("listName",T.listName);break;case"GetListAndView":A.payload+=v("listName",T.listName);A.payload+=v("viewName",T.viewName);break;case"GetListCollection":break;case"GetListContentType":A.payload+=v("listName",T.listName);A.payload+=v("contentTypeId",T.contentTypeId);break;case"GetListContentTypes":A.payload+=v("listName",T.listName);break;case"GetListItems":A.payload+=v("listName",T.listName);A.payload+=v("viewName",T.viewName);A.payload+=v("query",T.CAMLQuery);A.payload+=v("viewFields",T.CAMLViewFields);A.payload+=v("rowLimit",T.CAMLRowLimit);A.payload+=v("queryOptions",T.CAMLQueryOptions);break;case"UpdateList":A.payload+=v("listName",T.listName);A.payload+=v("listProperties",T.listProperties);A.payload+=v("newFields",T.newFields);A.payload+=v("updateFields",T.updateFields);A.payload+=v("deleteFields",T.deleteFields);A.payload+=v("listVersion",T.listVersion);break;case"UpdateListItems":A.payload+=v("listName",T.listName);if(T.updates.length>0){A.payload+=v("updates",T.updates)}else{A.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+T.batchCmd+"'>";for(i=0;i<T.valuepairs.length;i++){A.payload+="<Field Name='"+T.valuepairs[i][0]+"'>"+T.valuepairs[i][1]+"</Field>"}if(T.batchCmd!="New"){A.payload+="<Field Name='ID'>"+T.ID+"</Field>"}A.payload+="</Method></Batch></updates>"}break;case"AddMeeting":A.payload+=v("organizerEmail",T.organizerEmail);A.payload+=v("uid",T.uid);A.payload+=v("sequence",T.sequence);A.payload+=v("utcDateStamp",T.utcDateStamp);A.payload+=v("title",T.title);A.payload+=v("location",T.location);A.payload+=v("utcDateStart",T.utcDateStart);A.payload+=v("utcDateEnd",T.utcDateEnd);A.payload+=v("nonGregorian",T.nonGregorian);break;case"CreateWorkspace":A.payload+=v("title",T.title);A.payload+=v("templateName",T.templateName);A.payload+=v("lcid",T.lcid);A.payload+=v("timeZoneInformation",T.timeZoneInformation);case"RemoveMeeting":A.payload+=v("recurrenceId",T.recurrenceId);A.payload+=v("uid",T.uid);A.payload+=v("sequence",T.sequence);A.payload+=v("utcDateStamp",T.utcDateStamp);A.payload+=v("cancelMeeting",T.cancelMeeting);case"SetWorkspaceTitle":A.payload+=v("title",T.title);case"SearchPrincipals":A.payload+=v("searchText",T.searchText);A.payload+=v("maxResults",T.maxResults);A.payload+=v("principalType",T.principalType);break;case"AddPermission":A.payload+=v("objectName",T.objectName);A.payload+=v("objectType",T.objectType);A.payload+=v("permissionIdentifier",T.permissionIdentifier);A.payload+=v("permissionType",T.permissionType);A.payload+=v("permissionMask",T.permissionMask);break;case"AddPermissionCollection":A.payload+=v("objectName",T.objectName);A.payload+=v("objectType",T.objectType);A.payload+=v("permissionsInfoXml",T.permissionsInfoXml);break;case"GetPermissionCollection":A.payload+=v("objectName",T.objectName);A.payload+=v("objectType",T.objectType);break;case"RemovePermission":A.payload+=v("objectName",T.objectName);A.payload+=v("objectType",T.objectType);A.payload+=v("permissionIdentifier",T.permissionIdentifier);A.payload+=v("permissionType",T.permissionType);break;case"RemovePermissionCollection":A.payload+=v("objectName",T.objectName);A.payload+=v("objectType",T.objectType);A.payload+=v("memberIdsXml",T.memberIdsXml);break;case"UpdatePermission":A.payload+=v("objectName",T.objectName);A.payload+=v("objectType",T.objectType);A.payload+=v("permissionIdentifier",T.permissionIdentifier);A.payload+=v("permissionType",T.permissionType);A.payload+=v("permissionMask",T.permissionMask);break;case"GetLinks":break;case"GetPortalSearchInfo":A.opheader="<"+T.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'/>";SOAPAction="http://microsoft.com/webservices/OfficeServer/QueryService/"+T.operation;break;case"GetSearchMetadata":A.opheader="<"+T.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'/>";SOAPAction="http://microsoft.com/webservices/OfficeServer/QueryService/"+T.operation;break;case"Query":A.payload+=v("queryXml",a(T.queryXml));break;case"QueryEx":A.opheader="<"+T.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";SOAPAction="http://microsoft.com/webservices/OfficeServer/QueryService/"+T.operation;A.payload+=v("queryXml",a(T.queryXml));break;case"Status":break;case"EnumerateFolder":A.payload+=v("strFolderUrl",T.strFolderUrl);break;case"AddComment":A.payload+=v("url",T.url);A.payload+=v("comment",T.comment);A.payload+=v("isHighPriority",T.isHighPriority);A.payload+=v("title",T.title);break;case"AddTag":A.payload+=v("url",T.url);A.payload+=v("termID",T.termID);A.payload+=v("title",T.title);A.payload+=v("isPrivate",T.isPrivate);break;case"AddTagByKeyword":A.payload+=v("url",T.url);A.payload+=v("keyword",T.keyword);A.payload+=v("title",T.title);A.payload+=v("isPrivate",T.isPrivate);break;case"CountCommentsOfUser":A.payload+=v("userAccountName",T.userAccountName);break;case"CountCommentsOfUserOnUrl":A.payload+=v("userAccountName",T.userAccountName);A.payload+=v("url",T.url);break;case"CountCommentsOnUrl":A.payload+=v("url",T.url);break;case"CountRatingsOnUrl":A.payload+=v("url",T.url);break;case"CountTagsOfUser":A.payload+=v("userAccountName",T.userAccountName);break;case"DeleteComment":A.payload+=v("url",T.url);A.payload+=v("lastModifiedTime",T.lastModifiedTime);break;case"DeleteRating":A.payload+=v("url",T.url);break;case"DeleteTag":A.payload+=v("url",T.url);A.payload+=v("termID",T.termID);break;case"DeleteTagByKeyword":A.payload+=v("url",T.url);A.payload+=v("keyword",T.keyword);break;case"DeleteTags":A.payload+=v("url",T.url);break;case"GetAllTagTerms":A.payload+=v("maximumItemsToReturn",T.maximumItemsToReturn);break;case"GetAllTagTermsForUrlFolder":A.payload+=v("urlFolder",T.urlFolder);A.payload+=v("maximumItemsToReturn",T.maximumItemsToReturn);break;case"GetAllTagUrls":A.payload+=v("termID",T.termID);break;case"GetAllTagUrlsByKeyword":A.payload+=v("keyword",T.keyword);break;case"GetCommentsOfUser":A.payload+=v("userAccountName",T.userAccountName);A.payload+=v("maximumItemsToReturn",T.maximumItemsToReturn);A.payload+=v("startIndex",T.startIndex);break;case"GetCommentsOfUserOnUrl":A.payload+=v("userAccountName",T.userAccountName);A.payload+=v("url",T.url);break;case"GetCommentsOnUrl":A.payload+=v("url",T.url);A.payload+=v("maximumItemsToReturn",T.maximumItemsToReturn);A.payload+=v("startIndex",T.startIndex);if(T.excludeItemsTime.length>0){A.payload+=v("excludeItemsTime",T.excludeItemsTime)}break;case"GetRatingAverageOnUrl":A.payload+=v("url",T.url);break;case"GetRatingOfUserOnUrl":A.payload+=v("userAccountName",T.userAccountName);A.payload+=v("url",T.url);break;case"GetRatingOnUrl":A.payload+=v("url",T.url);break;case"GetRatingsOfUser":A.payload+=v("userAccountName",T.userAccountName);break;case"GetRatingsOnUrl":A.payload+=v("url",T.url);break;case"GetSocialDataForFullReplication":A.payload+=v("userAccountName",T.userAccountName);break;case"GetTags":A.payload+=v("url",T.url);break;case"GetTagsOfUser":A.payload+=v("userAccountName",T.userAccountName);A.payload+=v("maximumItemsToReturn",T.maximumItemsToReturn);A.payload+=v("startIndex",T.startIndex);break;case"GetTagTerms":A.payload+=v("maximumItemsToReturn",T.maximumItemsToReturn);break;case"GetTagTermsOfUser":A.payload+=v("userAccountName",T.userAccountName);A.payload+=v("maximumItemsToReturn",T.maximumItemsToReturn);break;case"GetTagTermsOnUrl":A.payload+=v("url",T.url);A.payload+=v("maximumItemsToReturn",T.maximumItemsToReturn);break;case"GetTagUrls":A.payload+=v("termID",T.termID);break;case"GetTagUrlsByKeyword":A.payload+=v("keyword",T.keyword);break;case"GetTagUrlsOfUser":A.payload+=v("termID",T.termID);A.payload+=v("userAccountName",T.userAccountName);break;case"GetTagUrlsOfUserByKeyword":A.payload+=v("keyword",T.keyword);A.payload+=v("userAccountName",T.userAccountName);break;case"SetRating":A.payload+=v("url",T.url);A.payload+=v("rating",T.rating);A.payload+=v("title",T.title);A.payload+=v("analysisDataEntry",T.analysisDataEntry);break;case"UpdateComment":A.payload+=v("url",T.url);A.payload+=v("lastModifiedTime",T.lastModifiedTime);A.payload+=v("comment",T.comment);A.payload+=v("isHighPriority",T.isHighPriority);break;case"AddGroup":A.payload+=v("groupName",T.groupName);A.payload+=v("ownerIdentifier",T.ownerIdentifier);A.payload+=v("ownerType",T.ownerType);A.payload+=v("defaultUserLoginName",T.defaultUserLoginName);A.payload+=v("groupName",T.groupName);A.payload+=v("description",T.description);break;case"AddGroupToRole":A.payload+=v("groupName",T.groupName);A.payload+=v("roleName",T.roleName);break;case"AddRole":A.payload+=v("roleName",T.roleName);A.payload+=v("description",T.description);A.payload+=v("permissionMask",T.permissionMask);break;case"AddUserToGroup":A.payload+=v("groupName",T.groupName);A.payload+=v("userName",T.userName);A.payload+=v("userLoginName",T.userLoginName);A.payload+=v("userEmail",T.userEmail);A.payload+=v("userNotes",T.userNotes);break;case"AddUserToRole":A.payload+=v("roleName",T.roleName);A.payload+=v("userName",T.userName);A.payload+=v("userLoginName",T.userLoginName);A.payload+=v("userEmail",T.userEmail);A.payload+=v("userNotes",T.userNotes);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollectionFromRole":A.payload+=v("roleName",T.roleName);break;case"GetGroupCollection":A.payload+=v("groupNamesXml",T.groupNamesXml);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":A.payload+=v("userLoginName",T.userLoginName);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":A.payload+=v("groupName",T.groupName);break;case"GetRoleCollection":A.payload+=v("roleNamesXml",T.roleNamesXml);break;case"GetRoleCollectionFromGroup":A.payload+=v("groupName",T.groupName);break;case"GetRoleCollectionFromUser":A.payload+=v("userLoginName",T.userLoginName);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":A.payload+=v("roleName",T.roleName);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":A.payload+=v("userLoginNamesXml",T.userLoginNamesXml);break;case"GetUserCollectionFromGroup":A.payload+=v("groupName",T.groupName);break;case"GetUserCollectionFromRole":A.payload+=v("roleName",T.roleName);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":A.payload+=v("userLoginName",T.userLoginName);break;case"GetUserLoginFromEmail":A.payload+=v("emailXml",T.emailXml);break;case"RemoveGroup":A.payload+=v("groupName",T.groupName);break;case"RemoveRole":A.payload+=v("roleName",T.roleName);break;case"RemoveUserFromGroup":A.payload+=v("groupName",T.groupName);A.payload+=v("userLoginName",T.userLoginName);break;case"GetCommonMemberships":A.payload+=v("accountName",T.accountName);break;case"GetUserColleagues":A.payload+=v("accountName",T.accountName);break;case"GetUserLinks":A.payload+=v("accountName",T.accountName);break;case"GetUserMemberships":A.payload+=v("accountName",T.accountName);break;case"GetUserPinnedLinks":A.payload+=v("accountName",T.accountName);break;case"GetUserProfileByName":if(T.accountName.length>0){A.payload+=v("AccountName",T.accountName)}else{A.payload+=v("AccountName",T.AccountName)}break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"ModifyUserPropertyByAccountName":A.payload+=v("accountName",T.accountName);A.payload+=v("newData",T.newData);break;case"GetViewCollection":A.payload+=v("listName",T.listName);break;case"DeleteAllVersions":A.payload+=v("fileName",T.fileName);break;case"DeleteVersion":A.payload+=v("fileName",T.fileName);A.payload+=v("fileVersion",T.fileVersion);break;case"GetVersions":A.payload+=v("fileName",T.fileName);break;case"RestoreVersion":A.payload+=v("fileName",T.fileName);A.payload+=v("fileVersion",T.fileVersion);break;case"AddWebPart":A.payload+=v("pageUrl",T.pageUrl);A.payload+=v("webPartXml",T.webPartXml);A.payload+=v("storage",T.storage);break;case"GetWebPart2":A.payload+=v("pageUrl",T.pageUrl);A.payload+=v("storageKey",T.storageKey);A.payload+=v("storage",T.storage);A.payload+=v("behavior",T.behavior);break;case"GetWebPartPage":A.payload+=v("documentName",T.documentName);A.payload+=v("behavior",T.behavior);break;case"GetWebPartProperties":A.payload+=v("pageUrl",T.pageUrl);A.payload+=v("storage",T.storage);break;case"GetWebPartProperties2":A.payload+=v("pageUrl",T.pageUrl);A.payload+=v("storage",T.storage);A.payload+=v("behavior",T.behavior);break;case"CreateContentType":A.payload+=v("displayName",T.displayName);A.payload+=v("parentType",T.parentType);A.payload+=v("newFields",T.newFields);A.payload+=v("contentTypeProperties",T.contentTypeProperties);break;case"GetColumns":A.payload+=v("webUrl",T.webURL);break;case"GetContentType":A.payload+=v("contentTypeId",T.contentTypeId);break;case"GetContentTypes":break;case"GetCustomizedPageStatus":A.payload+=v("fileUrl",T.fileUrl);break;case"GetListTemplates":break;case"GetWeb":A.payload+=v("webUrl",T.webURL);break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"UpdateColumns":A.payload+=v("newFields",T.newFields);A.payload+=v("updateFields",T.updateFields);A.payload+=v("deleteFields",T.deleteFields);break;case"UpdateContentType":A.payload+=v("contentTypeId",T.contentTypeId);A.payload+=v("contentTypeProperties",T.contentTypeProperties);A.payload+=v("newFields",T.newFields);A.payload+=v("updateFields",T.updateFields);A.payload+=v("deleteFields",T.deleteFields);break;case"WebUrlFromPageUrl":A.payload+=v("pageUrl",T.pageURL);break;case"GetTemplatesForItem":A.payload+=v("item",T.item);break;case"GetToDosForItem":A.payload+=v("item",T.item);break;case"GetWorkflowDataForItem":A.payload+=v("item",T.item);break;case"GetWorkflowTaskData":A.payload+=v("item",T.item);A.payload+=v("listId",T.listId);A.payload+=v("taskId",T.taskId);break;case"StartWorkflow":A.payload+=v("item",T.item);A.payload+=v("templateId",T.templateId);A.payload+=v("workflowParameters",T.workflowParameters);break;default:break}var V=A.header+A.opheader+A.payload+A.opfooter+A.footer;D.ajax({url:U,async:T.async,beforeSend:function(W){if(G[T.operation][1]){W.setRequestHeader("SOAPAction",SOAPAction)}},type:"POST",data:V,dataType:"xml",contentType:"text/xml;charset='utf-8'",complete:T.completefunc})};D.fn.SPServices.defaults={operation:"",webURL:"",pageURL:"",listName:"",description:"",templateID:"",viewName:"",formUrl:"",fileName:"",fileVersion:"",ID:1,updates:"",comment:"",CheckinType:"",checkoutToLocal:"",lastmodified:"",CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuepairs:[],listProperties:"",newFields:"",updateFields:"",deleteFields:"",contentTypeId:"",contentTypeProperties:"",listVersion:"",contentTypeId:"",username:"",password:"",accountName:"",newData:"",AccountName:"",userName:"",userLoginName:"",userEmail:"",userNotes:"",groupNamesXml:"",groupName:"",ownerIdentifier:"",ownerType:"",defaultUserLoginName:"",roleNamesXml:"",roleName:"",permissionIdentifier:"",permissionType:"",permissionMask:"",permissionsInfoXml:"",memberIdsXml:"",userLoginNamesXml:"",emailXml:"",objectName:"",objectType:"List",IDs:null,listItemID:"",attachment:"",SourceUrl:"",Url:"",DestinationUrls:[],Fields:"",Stream:"",Results:"",documentName:"",behavior:"Version3",storageKey:"",storage:"Shared",webPartXml:"",item:"",listId:"",taskId:"",templateId:"",workflowParameters:"",fClaim:false,queryXml:"",cancelMeeting:true,lcid:"",location:"",nonGregorian:false,organizerEmail:"",recurrenceId:0,sequence:0,templateName:"",timeZoneInformation:"",title:"",uid:"",utcDateStamp:"",utcDateStart:"",utcDateEnd:"",searchText:"",maxResults:10,principalType:"User",strFolderUrl:"",fileUrl:"",displayName:"",parentType:"",contentTypeProperties:"",url:"",termID:"",userAccountName:"",maximumItemsToReturn:0,urlFolder:"",keyword:"",startIndex:0,excludeItemsTime:"",isHighPriority:false,isPrivate:false,lastModifiedTime:"",rating:1,analysisDataEntry:"",async:true,completefunc:null};D.fn.SPServices.SPGetCurrentSite=function(){if(e.length>0){return e}var S=A.header+"<WebUrlFromPageUrl xmlns='http://schemas.microsoft.com/sharepoint/soap/' ><pageUrl>"+((location.href.indexOf("?")>0)?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+A.footer;D.ajax({async:false,url:"/_vti_bin/Webs.asmx",type:"POST",data:S,dataType:"xml",contentType:'text/xml;charset="utf-8"',complete:function(U,T){e=D(U.responseXML).find("WebUrlFromPageUrlResult").text()}});return e};D.fn.SPServices.SPCascadeDropdowns=function(S){var U=D.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListParentColumn:"",relationshipListChildColumn:"",relationshipListSortColumn:"",parentColumn:"",childColumn:"",listName:D().SPServices.SPListNameFromUrl(),CAMLQuery:"",promptText:"Choose {0}...",completefunc:null,debug:false},S);var T=new L(U.parentColumn);if(T.Obj.html()==null&&U.debug){B("SPServices.SPCascadeDropdowns","parentColumn: "+U.parentColumn,"Column not found on page");return}switch(T.Type){case"S":T.Obj.bind("change",function(){N(U)});T.Obj.change();break;case"C":T.Obj.bind("propertychange",function(){N(U)});T.Obj.trigger("propertychange");break;case"M":T.Obj.bind("dblclick",function(){N(U)});parentSelections=T.Obj.closest("span").find("select[ID$='SelectResult'][Title^='"+U.parentColumn+" ']");parentSelections.bind("dblclick",function(){N(U)});T.Obj.closest("span").find("button").each(function(){D(this).bind("click",function(){N(U)})});N(U);break;default:break}};function N(V){var af="";var Z=null;var Y=[];var U;var aa;var ac;var ad;var X=new L(V.parentColumn);switch(X.Type){case"S":Y.push(X.Obj.find("option:selected").text());break;case"C":Y.push(X.Obj.attr("value"));break;case"M":parentSelections=X.Obj.closest("span").find("select[ID$='SelectResult'][Title^='"+V.parentColumn+" ']");D(parentSelections).find("option").each(function(){Y.push(D(this).html())});break;default:break}var ab=D().SPServices.SPGetStaticFromDisplay({listName:V.listName,columnDisplayName:V.childColumn});if(X.Obj.attr("SPCascadeDropdown_Selected_"+ab)==Y.join(";#")){return}X.Obj.attr("SPCascadeDropdown_Selected_"+ab,Y.join(";#"));var T=new L(V.childColumn);if(T.Obj.html()==null&&V.debug){B("SPServices.SPCascadeDropdowns","childColumn: "+V.childColumn,"Column not found on page");return}switch(T.Type){case"S":Z=T.Obj.find("option:selected").val();break;case"C":Z=T.Obj.attr("value");break;case"M":aa=T.Obj.closest("span").find("input[name$='MultiLookupPicker$data']");U=window[T.Obj.closest("tr").find("button[id$='AddButton']").attr("id").replace(/AddButton/,"MultiLookupPicker_m")];currentSelection=T.Obj.closest("span").find("select[ID$='SelectResult'][Title^='"+V.childColumn+" ']");U.data="";break;default:break}var W=(V.relationshipListSortColumn.length>0)?V.relationshipListSortColumn:V.relationshipListChildColumn;var S="<Query><OrderBy><FieldRef Name='"+W+"'/></OrderBy><Where>";if(V.CAMLQuery.length>0){S+="<And>"}if(Y.length==0){S+="<Eq><FieldRef Name='"+V.relationshipListParentColumn+"'/><Value Type='Text'></Value></Eq>"}else{if(Y.length==1){S+="<Eq><FieldRef Name='"+V.relationshipListParentColumn+"'/><Value Type='Text'>"+s(Y[0])+"</Value></Eq>"}else{var ae=(Y.length>2)?true:false;for(i=0;i<(Y.length-1);i++){S+="<Or>"}for(i=0;i<Y.length;i++){S+="<Eq><FieldRef Name='"+V.relationshipListParentColumn+"'/><Value Type='Text'>"+s(Y[i])+"</Value></Eq>";if(i>0&&(i<(Y.length-1))&&ae){S+="</Or>"}}S+="</Or>"}}if(V.CAMLQuery.length>0){S+=V.CAMLQuery+"</And>"}S+="</Where></Query>";D().SPServices({operation:"GetList",async:false,listName:V.listName,completefunc:function(ah,ag){D(ah.responseXML).find("Fields").each(function(){D(this).find("Field").each(function(){if(D(this).attr("DisplayName")==V.childColumn){ad=(D(this).attr("Required")=="TRUE")?true:false;return false}})})}});D().SPServices({operation:"GetListItems",async:false,webURL:V.relationshipWebURL,listName:V.relationshipList,CAMLQuery:S,CAMLViewFields:"<ViewFields><FieldRef Name='"+V.relationshipListParentColumn+"' /><FieldRef Name='"+V.relationshipListChildColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns></QueryOptions>",completefunc:function(ah,ag){D(ah.responseXML).find("faultcode").each(function(){if(V.debug){B("SPServices.SPCascadeDropdowns","relationshipListParentColumn: "+V.relationshipListParentColumn+" or relationshipListChildColumn: "+V.relationshipListChildColumn,"Not found in relationshipList "+V.relationshipList)}return});switch(T.Type){case"S":T.Obj.attr({length:0});if(!ad&&(V.promptText.length>0)){T.Obj.append("<option value='0'>"+V.promptText.replace(/\{0\}/g,V.childColumn)+"</option>")}break;case"C":af=ad?"":"(None)|0";T.Obj.attr("value","");break;case"M":T.Obj.attr({length:0});ac="";break;default:break}D(ah.responseXML).find("[nodeName=z:row]").each(function(){var aj=(D(this).attr("ows_"+V.relationshipListChildColumn).indexOf(";#")>0)?D(this).attr("ows_"+V.relationshipListChildColumn).split(";#")[0]:D(this).attr("ows_ID");if(isNaN(aj)){aj=D(this).attr("ows_ID")}var ai=(D(this).attr("ows_"+V.relationshipListChildColumn).indexOf(";#")>0)?D(this).attr("ows_"+V.relationshipListChildColumn).split(";#")[1]:D(this).attr("ows_"+V.relationshipListChildColumn);switch(T.Type){case"S":var ak=(D(this).attr("ows_ID")==Z)?" selected='selected'":"";T.Obj.append("<option"+ak+" value='"+aj+"'>"+ai+"</option>");break;case"C":if(ai==Z){T.Obj.attr("value",Z)}af=af+((af.length>0)?"|":"")+ai+"|"+aj;break;case"M":T.Obj.append("<option value='"+aj+"'>"+ai+"</option>");ac+=aj+"|t"+ai+"|t |t |t";break;default:break}});switch(T.Type){case"S":T.Obj.trigger("change");break;case"C":T.Obj.attr("choices",af);T.Obj.trigger("propertychange");break;case"M":aa.attr("value",ac);D(currentSelection).find("option").each(function(){var ai=D(this);D(this).attr("selected","selected");D(T.Obj).find("option").each(function(){if(D(this).html()==ai.html()){ai.attr("selected","")}})});GipRemoveSelectedItems(U);D(T.Obj).find("option").each(function(){var ai=D(this);D(currentSelection).find("option").each(function(){if(D(this).html()==ai.html()){ai.remove()}})});GipAddSelectedItems(U);U.data=GipGetGroupData(ac);break;default:break}}});if(V.completefunc!=null){V.completefunc()}}D.fn.SPServices.SPDisplayRelatedInfo=function(S){var T=D.extend({},{columnName:"",relatedWebURL:"",relatedList:"",relatedListColumn:"",relatedColumns:[],displayFormat:"table",headerCSSClass:"ms-vh2",rowCSSClass:"ms-vb",CAMLQuery:"",numChars:0,matchType:"Eq",completefunc:null,debug:false},S);var U=new L(T.columnName);if(U.Obj.html()==null&&T.debug){B("SPServices.SPDisplayRelatedInfo","columnName: "+T.columnName,"Column not found on page");return}switch(U.Type){case"S":U.Obj.bind("change",function(){y(T)});U.Obj.change();break;case"C":U.Obj.bind("propertychange",function(){y(T)});U.Obj.trigger("propertychange");break;case"M":if(T.debug){B("SPServices.SPDisplayRelatedInfo","columnName: "+T.columnName,"Multi-select columns not supported by this function")}break;default:break}};function y(X){var T=null;var Y=new L(X.columnName);switch(Y.Type){case"S":T=Y.Obj.find("option:selected").text();break;case"C":T=Y.Obj.attr("value");if(X.numChars>0&&T.length<X.numChars){return}break;case"M":break;default:break}if(Y.Obj.attr("showRelatedSelected")==T){return}Y.Obj.attr("showRelatedSelected",T);var V=h("SPDisplayRelatedInfo",X.columnName);D("#"+V).remove();Y.Obj.parent().append("<div id="+V+"></div>");var W=[];D().SPServices({operation:"GetList",async:false,webURL:X.relatedWebURL,listName:X.relatedList,completefunc:function(aa,Z){D(aa.responseXML).find("faultcode").each(function(){if(X.debug){B("SPServices.SPDisplayRelatedInfo","relatedList: "+X.relatedList,"List not found")}return});D(aa.responseXML).find("Fields").each(function(){D(aa.responseXML).find("Field").each(function(){for(i=0;i<X.relatedColumns.length;i++){if(D(this).attr("Name")==X.relatedColumns[i]){W[i]=D(this)}}})})}});var S="<Query><Where>";if(X.CAMLQuery.length>0){S+="<And>"}S+="<"+X.matchType+"><FieldRef Name='"+X.relatedListColumn+"'/><Value Type='Text'>"+s(T)+"</Value></"+X.matchType+">";if(X.CAMLQuery.length>0){S+=X.CAMLQuery+"</And>"}S+="</Where></Query>";var U=" ";for(i=0;i<X.relatedColumns.length;i++){U+="<FieldRef Name='"+X.relatedColumns[i]+"' />"}D().SPServices({operation:"GetListItems",async:false,webURL:X.relatedWebURL,listName:X.relatedList,CAMLQuery:S,CAMLViewFields:"<ViewFields>"+U+"</ViewFields>",CAMLRowLimit:0,completefunc:function(ab,aa){D(ab.responseXML).find("faultcode").each(function(){if(X.debug){B("SPServices.SPDisplayRelatedInfo","relatedListColumn: "+X.relatedListColumn,"Column not found in relatedList "+X.relatedList)}return});var Z;switch(X.displayFormat){case"table":Z="<table>";Z+="<tr>";for(i=0;i<X.relatedColumns.length;i++){if(W[i]==undefined&&X.debug){B("SPServices.SPDisplayRelatedInfo","columnName: "+X.relatedColumns[i],"Column not found in relatedList");return}Z+="<th class='"+X.headerCSSClass+"'>"+W[i].attr("DisplayName")+"</th>"}Z+="</tr>";D(ab.responseXML).find("[nodeName=z:row]").each(function(){Z+="<tr>";for(i=0;i<X.relatedColumns.length;i++){Z+="<td class='"+X.rowCSSClass+"'>"+u(W[i],D(this).attr("ows_"+X.relatedColumns[i]),X)+"</td>"}Z+="</tr>"});Z+="</table>";break;case"list":Z="<table>";for(i=0;i<X.relatedColumns.length;i++){D(ab.responseXML).find("[nodeName=z:row]").each(function(){Z+="<tr>";Z+="<th class='"+X.headerCSSClass+"'>"+W[i].attr("DisplayName")+"</th>";Z+="<td class='"+X.rowCSSClass+"'>"+u(W[i],D(this).attr("ows_"+X.relatedColumns[i]),X)+"</td>";Z+="</tr>"})}Z+="</table>";break;default:break}D("#"+V).html("").append(Z)}});if(X.completefunc!=null){X.completefunc()}}D.fn.SPServices.SPDebugXMLHttpResult=function(T){var V=D.extend({},{node:null,indent:0},T);var X=3;var W=4;var S="";S+="<table class='ms-vb' style='margin-left:"+V.indent*3+"px;' width='100%'>";if(V.node.nodeName=="DisplayPattern"){S+="<tr><td width='100px' style='font-weight:bold;'>"+V.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+V.node.xml+"</textarea></td></tr>"}else{if(!V.node.hasChildNodes()){S+="<tr><td width='100px' style='font-weight:bold;'>"+V.node.nodeName+"</td><td>"+((V.node.nodeValue!=null)?r(V.node.nodeValue):"&nbsp;")+"</td></tr>";if(V.node.attributes){S+="<tr><td colspan='99'>";S+=M(V.node,V);S+="</td></tr>"}}else{if(V.node.hasChildNodes()&&V.node.firstChild.nodeType==W){S+="<tr><td width='100px' style='font-weight:bold;'>"+V.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+V.node.parentNode.text+"</textarea></td></tr>"}else{if(V.node.hasChildNodes()&&V.node.firstChild.nodeType==X){S+="<tr><td width='100px' style='font-weight:bold;'>"+V.node.nodeName+"</td><td>"+r(V.node.firstChild.nodeValue)+"</td></tr>"}else{S+="<tr><td width='100px' style='font-weight:bold;' colspan='99'>"+V.node.nodeName+"</td></tr>";if(V.node.attributes){S+="<tr><td colspan='99'>";S+=M(V.node,V);S+="</td></tr>"}S+="<tr><td>";for(var U=0;U<V.node.childNodes.length;U++){S+=D().SPServices.SPDebugXMLHttpResult({node:V.node.childNodes.item(U),indent:V.indent++})}S+="</td></tr>"}}}}S+="</table>";return S};D.fn.SPServices.SPGetCurrentUser=function(U){var V=D.extend({},{fieldName:"Name",debug:false},U);var T="";var S=RegExp('FieldInternalName="'+V.fieldName+'"',"gi");D.ajax({async:false,url:D().SPServices.SPGetCurrentSite()+"/_layouts/userdisp.aspx?Force=True&"+new Date().getTime(),complete:function(X,W){D(X.responseText).find("table.ms-formtable td[id^='SPField']").each(function(){if(S.test(D(this).html())){switch(D(this).attr("id")){case"SPFieldText":T=D(this).text();break;case"SPFieldNote":T=D(this).find("div").html();break;case"SPFieldURL":T=D(this).find("img").attr("src");break;default:T=D(this).text();break}return false}})}});return T.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,"")};D.fn.SPServices.SPLookupAddNew=function(U){var V=D.extend({},{lookupColumn:"",promptText:"Add new {0}",completefunc:null,debug:false},U);var T=new L(V.lookupColumn);if(T.Obj.html()==null&&V.debug){B("SPServices.SPLookupAddNew","lookupColumn: "+V.lookupColumn,"Column not found on page");return}var X="";var S="";var W="";D().SPServices({operation:"GetList",async:false,listName:D().SPServices.SPListNameFromUrl(),completefunc:function(Z,Y){D(Z.responseXML).find("Field").each(function(){if(D(this).attr("DisplayName")==V.lookupColumn){W=D(this).attr("StaticName");D().SPServices({operation:"GetList",async:false,listName:D(this).attr("List"),completefunc:function(ab,aa){D(ab.responseXML).find("List").each(function(){S=D(this).attr("WebFullUrl");S=S!=g?S+g:S})}});D().SPServices({operation:"GetFormCollection",async:false,listName:D(this).attr("List"),completefunc:function(ab,aa){D(ab.responseXML).find("Form").each(function(){if(D(this).attr("Type")=="NewForm"){X=D(this).attr("Url")}})}});return false}})}});if(S.length==0&&V.debug){B("SPServices.SPLookupAddNew","lookupColumn: "+V.lookupColumn,"This column does not appear to be a lookup column");return}if(X.length>0){newLink="<div id='SPLookupAddNew_"+W+"'><a href='"+S+X+"?Source="+Q(location.href)+"'>"+V.promptText.replace(/\{0\}/g,V.lookupColumn)+"</a></div>";D(T.Obj).parents("td.ms-formbody").append(newLink)}else{if(V.debug){B("SPServices.SPLookupAddNew","lookupColumn: "+V.lookupColumn,"NewForm cannot be found");return}}if(V.completefunc!=null){V.completefunc()}};D.fn.SPServices.SPGetLastItemId=function(T){var V=D.extend({},{webURL:"",listName:"",userAccount:"",CAMLQuery:""},T);var U;var W=0;D().SPServices({operation:"GetUserInfo",async:false,userLoginName:(V.userAccount!="")?V.userAccount:D().SPServices.SPGetCurrentUser(),completefunc:function(Y,X){D(Y.responseXML).find("User").each(function(){U=D(this).attr("ID")})}});var S="<Query><Where>";if(V.CAMLQuery.length>0){S+="<And>"}S+="<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>"+U+"</Value></Eq>";if(V.CAMLQuery.length>0){S+=V.CAMLQuery+"</And>"}S+="</Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>";D().SPServices({operation:"GetListItems",async:false,webURL:V.webURL,listName:V.listName,CAMLQuery:S,CAMLViewFields:"<ViewFields><FieldRef Name='ID'/></ViewFields>",CAMLRowLimit:1,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(Y,X){D(Y.responseXML).find("[nodeName=z:row]").each(function(){W=D(this).attr("ows_ID")})}});return W};D.fn.SPServices.SPRequireUnique=function(ab){var S=D.extend({},{columnStaticName:"Title",duplicateAction:0,ignoreCase:false,initMsg:"This value must be unique.",initMsgCSSClass:"ms-vb",errMsg:"This value is not unique.",errMsgCSSClass:"ms-formvalidation",completefunc:null},ab);var U=D().SPServices.SPGetQueryString();var Z=U.ID;var Y=D().SPServices.SPListNameFromUrl();var T="<span id='SPRequireUnique"+S.columnStaticName+"' class='{0}'>{1}<br/></span>";var W=T.replace(/\{0\}/g,S.initMsgCSSClass).replace(/\{1\}/g,S.initMsg);var X=T.replace(/\{0\}/g,S.errMsgCSSClass).replace(/\{1\}/g,S.errMsg);var V=D().SPServices.SPGetDisplayFromStatic({listName:Y,columnStaticName:S.columnStaticName});var aa=D("input[Title='"+V+"']");D(aa).parent().append(W);D(aa).blur(function(){var ad=0;var ae=D(this).attr("value");D().SPServices({operation:"GetListItems",async:false,listName:Y,CAMLQuery:"<Query><Where><IsNotNull><FieldRef Name='"+S.columnStaticName+"'/></IsNotNull></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='ID' /><FieldRef Name='"+S.columnStaticName+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(ah,af){var ag=S.ignoreCase?ae.toUpperCase():ae;D(ah.responseXML).find("[nodeName=z:row]").each(function(){var ai=S.ignoreCase?D(this).attr("ows_"+S.columnStaticName).toUpperCase():D(this).attr("ows_"+S.columnStaticName);if((ag==ai)&&(D(this).attr("ows_ID")!=Z)){ad++}})}});var ac=W;D("input[value='OK']").attr("disabled","");if(ad>0){ac=X;if(S.duplicateAction==1){D("input[Title='"+S.columnDisplayName+"']").focus();D("input[value='OK']").attr("disabled","disabled")}}D("span#SPRequireUnique"+S.columnStaticName).html(ac)});if(S.completefunc!=null){S.completefunc()}};D.fn.SPServices.SPGetDisplayFromStatic=function(T){var V=D.extend({},{webURL:"",listName:"",columnStaticName:""},T);var U="";var S="";D().SPServices({operation:"GetList",async:false,webURL:V.webURL,listName:V.listName,completefunc:function(X,W){D(X.responseXML).find("Field").each(function(){if(D(this).attr("StaticName")==V.columnStaticName){S=D(this).attr("DisplayName");return false}})}});return S};D.fn.SPServices.SPGetStaticFromDisplay=function(T){var V=D.extend({},{webURL:"",listName:"",columnDisplayName:""},T);var S="";var U="";D().SPServices({operation:"GetList",async:false,listName:V.listName,completefunc:function(X,W){D(X.responseXML).find("Field").each(function(){if(D(this).attr("DisplayName")==V.columnDisplayName){U=D(this).attr("StaticName");return false}})}});return U};D.fn.SPServices.SPRedirectWithID=function(aa){var S=D.extend({},{redirectUrl:"",qsParamName:"ID"},aa);var Y=D().SPServices.SPListNameFromUrl();var T=D().SPServices.SPGetQueryString();var V=T.ID;var W=T.List;var Z=T.RootFolder;var X=T.ContentTypeId;if(T.ID==undefined){V=D().SPServices.SPGetLastItemId({listName:Y});D("form[name='aspnetForm']").each(function(){var ac=(location.href.indexOf("?")>0)?location.href.substring(0,location.href.indexOf("?")):location.href;var ad=(typeof T.Source=="string")?"Source="+T.Source.replace(/\//g,"%2f").replace(/:/g,"%3a"):"";var ab=new Array();if(W!=undefined){ab.push("List="+W)}if(Z!=undefined){ab.push("RootFolder="+Z)}if(X!=undefined){ab.push("ContentTypeId="+X)}var ae=ac+((ab.length>0)?("?"+ab.join("&")+"&"):"?")+"Source="+ac+"?ID="+V+((ad.length>0)?("%26RealSource="+T.Source):"")+((typeof T.RedirectURL=="string")?("%26RedirectURL="+T.RedirectURL):"");D(this).attr("action",ae)})}else{while(T.ID==V){V=D().SPServices.SPGetLastItemId({listName:Y})}var U=(typeof T.RedirectURL=="string")?T.RedirectURL:S.redirectUrl;location.href=U+"?"+S.qsParamName+"="+V+((typeof T.RealSource=="string")?("&Source="+T.RealSource):"")}};D.fn.SPServices.SPSetMultiSelectSizes=function(aa){var S=D.extend({},{multiSelectColumn:"",minWidth:0,maxWidth:0},aa);var W=D("select[ID$='SelectCandidate'][Title^='"+S.multiSelectColumn+" ']");var Y=W.closest("span").find("select[ID$='SelectResult'][Title^='"+S.multiSelectColumn+" ']");var X=h("SPSetMultiSelectSizes",S.multiSelectColumn);W.clone().appendTo(W.closest("span")).css({width:"auto",height:0,visibility:"hidden"}).attr({id:X,length:0});var V=D("#"+X);W.find("option").each(function(){V.append("<option value='"+D(this).html()+"'>"+D(this).html()+"</option>")});Y.find("option").each(function(){V.append("<option value='"+D(this).html()+"'>"+D(this).html()+"</option>")});var T=D("#"+X).width()+5;var Z=T;if(S.minWidth>0||S.maxWidth>0){if(T<S.minWidth){T=S.minWidth}if(Z<S.minWidth){Z=S.minWidth}if(Z>S.maxWidth){Z=S.maxWidth}}var U=T-17;W.css("width",U+"px").parent().css("width",Z+"px");Y.css("width",U+"px").parent().css("width",Z+"px");D("#"+X).remove()};D.fn.SPServices.SPScriptAudit=function(T){var U=D.extend({},{webURL:"",listName:"",outputId:"",auditForms:true,auditViews:true,auditPages:true,auditPagesListName:"Pages",showHiddenLists:false,showNoScript:false,showSrc:true},T);var S=["Display","Edit","New"];var V;D("#"+U.outputId).append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1><tr><th></th><th>List</th><th>Page Class</th><th>Page Type</th><th>Page</th>"+(U.showSrc?"<th>Script in the Page</th><th>Script in a Web Part</th>":"")+"<th>jQuery</th></tr></table>");D("#SPScriptAudit th").attr("class","ms-vh2-nofilter");if(U.auditForms||U.auditViews){D().SPServices({operation:"GetListCollection",webURL:U.webURL,async:false,completefunc:function(X,W){D(X.responseXML).find(n).each(function(){D(this).find("List").each(function(){V=D(this);if((U.showHiddenLists&&V.attr("Hidden")=="False")||!U.showHiddenLists){if(U.auditForms){D().SPServices({operation:"GetListContentTypes",webURL:U.webURL,listName:V.attr("ID"),async:false,completefunc:function(Z,Y){D(Z.responseXML).find("ContentType").each(function(){if(D(this).attr("ID").substring(0,6)!="0x0120"){D(this).find("FormUrls").each(function(){for(var aa=0;aa<S.length;aa++){D(this).find(S[aa]).each(function(){k(U,V,"Form",S[aa],((U.webURL.length>0)?U.webURL:D().SPServices.SPGetCurrentSite())+g+D(this).text())})}})}})}})}if(U.auditViews){D().SPServices({operation:"GetViewCollection",webURL:U.webURL,listName:V.attr("ID"),async:false,completefunc:function(Z,Y){D(Z.responseXML).find("View").each(function(){k(U,V,"View",D(this).attr("DisplayName"),D(this).attr("Url"))})}})}}})})}})}if(U.auditPages){D().SPServices({operation:"GetList",async:false,webURL:U.webURL,listName:U.auditPagesListName,completefunc:function(X,W){D(X.responseXML).find("List").each(function(){V=D(this)})}});D().SPServices({operation:"GetListItems",async:false,webURL:U.webURL,listName:U.auditPagesListName,CAMLQuery:"<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>",CAMLRowLimit:0,completefunc:function(X,W){D(X.responseXML).find("[nodeName=z:row]").each(function(){var Z=D(this).attr("ows_FileRef").split(";#")[1];var Y=(D(this).attr("ows_Title")!=undefined)?D(this).attr("ows_Title"):"";if(Z.indexOf(".aspx")>0){k(U,V,"Page",Y,g+Z)}})}})}D("#SPScriptAudit tr[class='ms-alternating']:even").attr("class","")};function k(S,U,ae,Y,W){var ac=0;var ad=0;var V=new Object();V.type=[];V.src=[];V.script=[];var X=new Object();X.type=[];X.src=[];X.script=[];var T="$(";var Z=RegExp("<head[\\s\\S]*?/head>","gi");var ab=RegExp("<script[\\s\\S]*?/script>","gi");var aa;D.ajax({type:"GET",url:W,dataType:"text",success:function(ag){headHtml=Z.exec(ag);while(scriptMatch=ab.exec(headHtml)){var aj=z(scriptMatch,"language");var al=z(scriptMatch,"type");var af=z(scriptMatch,"src");if(af!=null&&af.length>0&&!E(af)){X.type.push((aj!=null&&aj.length>0)?aj:al);X.src.push(af)}var an=scriptMatch.innerHTML;if(an!=undefined&&an.indexOf(T)>-1){X.script.push(scriptMatch.innerHTML);ac++}}D(ag).find("script").each(function(){if(D(this).closest("td[id^='MSOZoneCell_WebPartWP']").html()==null){if((D(this).attr("src")!=undefined)&&(D(this).attr("src").length>0)&&!E(D(this).attr("src"))){X.type.push(D(this).attr("language").length>0?D(this).attr("language"):D(this).attr("type"));X.src.push(D(this).attr("src"))}if(D(this).html().indexOf(T)>-1){X.script.push(D(this).html());ac++}}else{if(D(this).attr("src")!=undefined&&D(this).attr("src").length>0){V.type.push(D(this).attr("language").length>0?D(this).attr("language"):D(this).attr("type"));V.src.push(D(this).attr("src"))}if(D(this).html().indexOf(T)>-1){V.script.push(D(this).html());ad++}}});if((!S.showNoScript&&(V.type.length>0||X.type.length>0))||S.showNoScript){var ak=W.substring(0,W.lastIndexOf(g)+1);var ah="<tr class=ms-alternating><td class=ms-vb-icon><a href='"+U.attr("DefaultViewUrl")+"'><IMG border=0 src='"+U.attr("ImageUrl")+"'width=16 height=16></A></TD><td class=ms-vb2><a href='"+U.attr("DefaultViewUrl")+"'>"+U.attr("Title")+((U.attr("Hidden")=="True")?"(Hidden)":"")+"</td><td class=ms-vb2>"+ae+"</td><td class=ms-vb2>"+Y+"</td><td class=ms-vb2><a href='"+W+"'>"+w(W)+"</td>";if(S.showSrc){ah+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>";for(var ai=0;ai<X.type.length;ai++){var am=(X.src[ai].substr(0,1)!=g)?ak+X.src[ai]:X.src[ai];ah+="<tr><td class=ms-vb2 width='30%'>"+X.type[ai]+"</td>";ah+="<td class=ms-vb2 width='70%'><a href='"+am+"'>"+w(X.src[ai])+"</td></tr>"}if(ac>0){for(var ai=0;ai<X.script.length;ai++){ah+="<tr><td class=ms-vb2 colspan=99><textarea class=ms-vb2 readonly='readonly' rows='5' cols='50'>"+X.script[ai]+"</textarea></td></tr>"}}ah+="</table></td>";ah+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>";for(var ai=0;ai<V.type.length;ai++){var am=(V.src[ai].substr(0,1)!=g)?ak+V.src[ai]:V.src[ai];ah+="<tr><td class=ms-vb2 width='30%'>"+V.type[ai]+"</td>";ah+="<td class=ms-vb2 width='70%'><a href='"+am+"'>"+w(V.src[ai])+"</td></tr>"}if(ad>0){for(var ai=0;ai<V.script.length;ai++){ah+="<tr><td class=ms-vb2 colspan=99><textarea class=ms-vb2 readonly='readonly' rows='5' cols='50'>"+V.script[ai]+"</textarea></td></tr>"}}ah+="</table></td>"}ah+="<td class=ms-vb2>"+(((ac+ad)>0)?"Yes":"No")+"</td></tr>";D("#SPScriptAudit").append(ah)}}})}function z(U,T){var S=RegExp(T+"=(\"([^\"]*)\")|('([^']*)')","gi");if(matches=S.exec(U)){return matches[2]}return null}function E(U){var T=["WebResource.axd","_layouts"];for(var S=0;S<T.length;S++){if(U.indexOf(T[S])>-1){return true}}return false}D.fn.SPServices.SPArrangeChoices=function(T){var U=D.extend({},{listName:"",columnName:"",perRow:99,randomize:false},T);var W=false;var T=new Array();var S;D().SPServices({operation:"GetList",async:false,listName:(U.listName.length>0)?U.listName:D().SPServices.SPListNameFromUrl(),completefunc:function(Y,X){D(Y.responseXML).find("Fields").each(function(){D(this).find("Field").each(function(){if(D(this).attr("DisplayName")==U.columnName){W=(D(this).attr("FillInChoice")=="TRUE")?true:false;return false}})})}});var V=RegExp('FieldName="'+U.columnName+'"',"gi");D("td.ms-formbody, td.ms-formbodysurvey").each(function(){if(V.test(D(this).html())){var Z=D(this).find("tr").length;var Y=0;var aa;var X;D(this).find("tr").each(function(){Y++;if(W&&Y==Z-1){aa=D(this).find("td").html()}else{if(W&&Y==Z){X=D(this).find("td").html()}else{T.push(D(this).html())}}});S="<TR>";if(U.randomize){T.sort(O)}for(i=0;i<T.length;i++){S+=T[i];if((i+1)%U.perRow==0){S+="</TR><TR>"}}S+="</TR>";if(W){S+="<TR><TD colspan='99'>"+aa+X+"</TD></TR>"}D(this).find("tr").remove();D(this).find("table").append(S);return false}})};D.fn.SPServices.SPAutocomplete=function(U){var V=D.extend({},{WebURL:"",sourceList:"",sourceColumn:"",columnName:"",CAMLQuery:"",numChars:0,ignoreCase:false,slideDownSpeed:"fast",processingIndicator:"<img src='_layouts/images/REFRESH.GIF'/>",debug:false},U);var T=D("input[Title='"+V.columnName+"']");D("input[Title='"+V.columnName+"']").css("position","");var X=D(T).attr("ID");var W=D(T).css("color");if(T.html()==null&&V.debug){B("SPServices.SPAutocomplete","columnName: "+V.columnName,"Column is not an input control or is not found on page");return}var S=h("SPAutocomplete",V.columnName);T.after("<ul id='"+S+"' style='display:none;padding:2px;border:1px solid #2A1FAA;background-color:#FFF;position:absolute;z-index:40;margin:0'>");D("#"+S).css("width",T.width());T.wrap("<table id='"+S+"container' cellpadding='0' cellspacing='0' width='100%'><tr><td width='"+T.width()+"'></td></tr></table>");T.closest("tr").append("<td id='"+S+"processingIndicator' style='display:none;'>"+V.processingIndicator+"</td>");D(T).keyup(function(){var ab=D(this).val();if(ab.length<V.numChars){D("#"+S).hide();return false}D("#"+S).hide();D("#"+S+"processingIndicator").show();var aa=new Array();var Y="<Query><OrderBy><FieldRef Name='"+V.sourceColumn+"'/></OrderBy><Where>";if(V.CAMLQuery.length>0){Y+="<And>"}Y+="<IsNotNull><FieldRef Name='"+V.sourceColumn+"'/></IsNotNull>";if(V.CAMLQuery.length>0){Y+=V.CAMLQuery+"</And>"}Y+="</Where></Query>";D().SPServices({operation:"GetListItems",async:false,webURL:V.WebURL,listName:V.sourceList,CAMLQuery:Y,CAMLViewFields:"<ViewFields><FieldRef Name='"+V.sourceColumn+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(ae,ac){var ad=V.ignoreCase?ab.toUpperCase():ab;D(ae.responseXML).find("[nodeName=z:row]").each(function(){var af=V.ignoreCase?D(this).attr("ows_"+V.sourceColumn).toUpperCase():D(this).attr("ows_"+V.sourceColumn);if(ad==af.substr(0,ad.length)){aa.push(D(this).attr("ows_"+V.sourceColumn))}})}});var Z="";for(i=0;i<aa.length;i++){Z+="<li style='display: block;position: relative;cursor: pointer;'>"+aa[i]+"</li>"}D("#"+S).html(Z);D("#"+S+" li").click(function(){D("#"+S).fadeOut(V.slideUpSpeed);D("#"+X).val(D(this).html())}).mouseover(function(){var ac={cursor:"hand",color:"#ffffff",background:"#3399ff"};D(this).css(ac)}).mouseout(function(){var ac={cursor:"inherit",color:W,background:"transparent"};D(this).css(ac)});D("#"+S+"processingIndicator").fadeOut("slow");if(aa.length>0){D("#"+S).slideDown(V.slideDownSpeed)}})};D.fn.SPServices.SPGetQueryString=function(){var X=new Object();var S=location.search.substring(1,location.search.length);var T=S.split("&");for(var V=0;V<T.length;V++){var U=/^([^=]+)=(.*)/i,W=U.exec(T[V]);if(U.test(location.href)){if(W.length>2){X[W[1]]=unescape(W[2]).replace("+"," ")}}}return X};D.fn.SPServices.SPListNameFromUrl=function(){var U=location.href;var T=U.substring(0,U.indexOf(".aspx"));var V=P(T.substring(0,T.lastIndexOf(g)+1)).toUpperCase();var S="";D().SPServices({operation:"GetListCollection",async:false,completefunc:function(X,W){D(X.responseXML).find("List").each(function(){var Y=D(this).attr("DefaultViewUrl");var Z=Y.substring(0,Y.lastIndexOf(g)+1).toUpperCase();if(V.indexOf(Z)>0){S=D(this).attr("ID");return false}})}});return S};D.fn.SPServices.SPUpdateMultipleListItems=function(U){var W=D.extend({},{webURL:"",listName:"",CAMLQuery:"",batchCmd:"Update",valuepairs:[],debug:false},U);var X=[];D().SPServices({operation:"GetListItems",async:false,webURL:W.webURL,listName:W.listName,CAMLQuery:W.CAMLQuery,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(Z,Y){D(Z.responseXML).find("[nodeName=z:row]").each(function(){X.push(D(this).attr("ows_ID"))})}});var T="<Batch OnError='Continue'>";for(var V=0;V<X.length;V++){T+="<Method ID='"+V+1+"' Cmd='"+W.batchCmd+"'>";for(var S=0;S<W.valuepairs.length;S++){T+="<Field Name='"+W.valuepairs[S][0]+"'>"+W.valuepairs[S][1]+"</Field>"}T+="<Field Name='ID'>"+X[V]+"</Field></Method>"}T+="</Batch>";D().SPServices({operation:"UpdateListItems",async:false,webURL:W.webURL,listName:W.listName,updates:T,completefunc:function(Z,Y){}})};function u(X,W,V){if(W==undefined){return""}var S;switch(X.attr("Type")){case"Text":S=W;break;case"URL":switch(X.attr("Format")){case"Hyperlink":S="<a href='"+W.substring(0,W.search(","))+"'>"+W.substring(W.search(",")+1)+"</a>";break;case"Image":S="<img alt='"+W.substring(W.search(",")+1)+"' src='"+W.substring(0,W.search(","))+"'/>";break;default:S=W;break}break;case"User":S="<a href='/_layouts/userdisp.aspx?ID="+W.substring(0,W.search(";#"))+"&Source="+Q(location.href)+"'>"+W.substring(W.search(";#")+2)+"</a>";break;case"Calculated":var T=W.split(";#");S=T[1];break;case"Number":S=parseFloat(W).toFixed(X.attr("Decimals")).toString();break;case"Currency":S=parseFloat(W).toFixed(X.attr("Decimals")).toString();break;case"Lookup":var U;D().SPServices({operation:"GetFormCollection",async:false,listName:X.attr("List"),completefunc:function(Z,Y){D(Z.responseXML).find("Form").each(function(){if(D(this).attr("Type")=="DisplayForm"){U=D(this).attr("Url");return false}})}});S="<a href='"+V.relatedWebURL+g+U+"?ID="+W.substring(0,W.search(";#"))+"&RootFolder=*'>"+W.substring(W.search(";#")+2)+"</a>";break;case"Counter":S=W;break;default:S=W;break}return S}function M(V,U){var S="<table class='ms-vb' width='100%'>";for(var T=0;T<V.attributes.length;T++){S+="<tr><td width='10px' style='font-weight:bold;'>"+T+"</td><td width='100px'>"+V.attributes.item(T).nodeName+"</td><td>"+r(V.attributes.item(T).nodeValue)+"</td></tr>"}S+="</table>";return S}function L(S){if((this.Obj=D("select[Title='"+S+"']")).html()!=null){this.Type="S"}else{if((this.Obj=D("input[Title='"+S+"']")).html()!=null){this.Type="C"}else{if((this.Obj=D("select[ID$='SelectCandidate'][Title^='"+S+" ']")).html()!=null){this.Type="M"}else{if((this.Obj=D("select[ID$='SelectCandidate'][Title$=': "+S+"']")).html()!=null){this.Type="M"}else{this.Type=null}}}}}function B(T,V,U){var S="<b>Error in function</b><br/>"+T+"<br/><b>Parameter</b><br/>"+V+"<br/><b>Message</b><br/>"+U+"<br/><br/><span onmouseover='this.style.cursor=\"hand\";' onmouseout='this.style.cursor=\"inherit\";' style='width=100%;text-align:right;'>Click to continue</span></div>";f(S)}function f(X){var U="position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";D("#aspnetForm").parent().append("<div id='SPServices_msgBox' style="+U+">"+X);var S=D("#SPServices_msgBox").height();var W=D("#SPServices_msgBox").width();var V=(D(window).width()/2)-(W/2)+"px";var T=(D(window).height()/2)-(S/2)-100+"px";D("#SPServices_msgBox").css({border:"5px #C02000 solid",left:V,top:T}).show().fadeTo("slow",0.75).click(function(){D(this).fadeOut("3000",function(){D(this).remove()})})}function h(S,T){return S+"_"+D().SPServices.SPGetStaticFromDisplay({listName:D().SPServices.SPListNameFromUrl(),columnDisplayName:T})}function O(){return(Math.round(Math.random())-0.5)}function r(S){return((S.indexOf("http")==0)||(S.indexOf(g)==0))?"<a href='"+S+"'>"+S+"</a>":S}function w(S){return S.substring(S.lastIndexOf(g)+1,S.length)}function a(S){return S.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function s(S){return S.replace(/&/g,"&amp;")}function P(S){return S.replace(/%20/g," ")}function Q(S){return S.replace(/&/g,"%26")}function v(T,S){return"<"+T+">"+S+"</"+T+">"}})(jQuery);