/*
 * SPServices - Work with SharePoint's Web Services using jQuery
 * Version 0.7.0
 * @requires jQuery v1.4.2 or greater
 *
 * Copyright (c) 2009-2010 Sympraxis Consulting LLC
 * Examples and docs at:
 * http://spservices.codeplex.com
 * Licensed under the MIT license:
 * http://www.opensource.org/licenses/mit-license.php
 */
/**
 * @description Work with SharePoint's Web Services using jQuery
 * @type jQuery
 * @name SPServices
 * @category Plugins/SPServices
 * @author Sympraxis Consulting LLC/marc.anderson@sympraxisconsulting.com
 */
(function(H){var h="/";var n="Alerts";var m="Authentication";var r="Copy";var O="Forms";var o="Lists";var L="Meetings";var d="People";var b="Permissions";var u="PublishedLinksService";var B="Search";var x="SiteData";var Q="SocialDataService";var X="TaxonomyClientService";var M="usergroup";var J="UserProfileService";var Z="Versions";var k="Views";var G="WebPartPages";var q="Webs";var c="Workflow";var e="";var s="";var W=0;var P="";var K=[];K.GetAlerts=[n,false];K.DeleteAlerts=[n,true];K.Mode=[m,false];K.Login=[m,false];K.CopyIntoItems=[r,true];K.CopyIntoItemsLocal=[r,true];K.GetItem=[r,false];K.GetForm=[O,false];K.GetFormCollection=[O,false];K.AddAttachment=[o,true];K.AddList=[o,true];K.CheckInFile=[o,true];K.CheckOutFile=[o,true];K.DeleteAttachment=[o,true];K.DeleteList=[o,true];K.GetAttachmentCollection=[o,false];K.GetList=[o,false];K.GetListAndView=[o,false];K.GetListCollection=[o,false];K.GetListContentType=[o,false];K.GetListContentTypes=[o,false];K.GetListItems=[o,false];K.UpdateList=[o,true];K.UpdateListItems=[o,true];K.AddMeeting=[L,true];K.CreateWorkspace=[L,true];K.RemoveMeeting=[L,true];K.SetWorkSpaceTitle=[L,true];K.SearchPrincipals=[d,false];K.AddPermission=[b,true];K.AddPermissionCollection=[b,true];K.GetPermissionCollection=[b,true];K.RemovePermission=[b,true];K.RemovePermissionCollection=[b,true];K.UpdatePermission=[b,true];K.GetLinks=[u,true];K.GetPortalSearchInfo=[B,false];K.GetQuerySuggestions=[B,false];K.GetSearchMetadata=[B,false];K.Query=[B,false];K.QueryEx=[B,false];K.Registration=[B,false];K.Status=[B,false];K.EnumerateFolder=[x,false];K.SiteDataGetList=[x,false];K.SiteDataGetListCollection=[x,false];K.AddComment=[Q,true];K.AddTag=[Q,true];K.AddTagByKeyword=[Q,true];K.CountCommentsOfUser=[Q,false];K.CountCommentsOfUserOnUrl=[Q,false];K.CountCommentsOnUrl=[Q,false];K.CountRatingsOnUrl=[Q,false];K.CountTagsOfUser=[Q,false];K.DeleteComment=[Q,true];K.DeleteRating=[Q,true];K.DeleteTag=[Q,true];K.DeleteTagByKeyword=[Q,true];K.DeleteTags=[Q,true];K.GetAllTagTerms=[Q,false];K.GetAllTagTermsForUrlFolder=[Q,false];K.GetAllTagUrls=[Q,false];K.GetAllTagUrlsByKeyword=[Q,false];K.GetCommentsOfUser=[Q,false];K.GetCommentsOfUserOnUrl=[Q,false];K.GetCommentsOnUrl=[Q,false];K.GetRatingAverageOnUrl=[Q,false];K.GetRatingOfUserOnUrl=[Q,false];K.GetRatingOnUrl=[Q,false];K.GetRatingsOfUser=[Q,false];K.GetRatingsOnUrl=[Q,false];K.GetSocialDataForFullReplication=[Q,false];K.GetTags=[Q,true];K.GetTagsOfUser=[Q,true];K.GetTagTerms=[Q,true];K.GetTagTermsOfUser=[Q,true];K.GetTagTermsOnUrl=[Q,true];K.GetTagUrlsOfUser=[Q,true];K.GetTagUrlsOfUserByKeyword=[Q,true];K.GetTagUrls=[Q,true];K.GetTagUrlsByKeyword=[Q,true];K.SetRating=[Q,true];K.UpdateComment=[Q,true];K.AddTerms=[X,true];K.GetChildTermsInTerm=[X,false];K.GetChildTermsInTermSet=[X,false];K.GetKeywordTermsByGuids=[X,false];K.GetTermsByLabel=[X,false];K.GetTermSets=[X,false];K.AddGroup=[M,true];K.AddGroupToRole=[M,true];K.AddRole=[M,true];K.AddRoleDef=[M,true];K.AddUserCollectionToGroup=[M,true];K.AddUserCollectionToRole=[M,true];K.AddUserToGroup=[M,true];K.AddUserToRole=[M,true];K.GetAllUserCollectionFromWeb=[M,false];K.GetGroupCollection=[M,false];K.GetGroupCollectionFromRole=[M,false];K.GetGroupCollectionFromSite=[M,false];K.GetGroupCollectionFromUser=[M,false];K.GetGroupCollectionFromWeb=[M,false];K.GetGroupInfo=[M,false];K.GetRoleCollection=[M,false];K.GetRoleCollectionFromGroup=[M,false];K.GetRoleCollectionFromUser=[M,false];K.GetRoleCollectionFromWeb=[M,false];K.GetRoleInfo=[M,false];K.GetRolesAndPermissionsForCurrentUser=[M,false];K.GetRolesAndPermissionsForSite=[M,false];K.GetUserCollection=[M,false];K.GetUserCollectionFromGroup=[M,false];K.GetUserCollectionFromRole=[M,false];K.GetUserCollectionFromSite=[M,false];K.GetUserCollectionFromWeb=[M,false];K.GetUserInfo=[M,false];K.GetUserLoginFromEmail=[M,false];K.RemoveGroup=[M,true];K.RemoveGroupFromRole=[M,true];K.RemoveRole=[M,true];K.RemoveUserCollectionFromGroup=[M,true];K.RemoveUserCollectionFromRole=[M,true];K.RemoveUserCollectionFromSite=[M,true];K.RemoveUserFromGroup=[M,true];K.RemoveUserFromRole=[M,true];K.RemoveUserFromSite=[M,true];K.RemoveUserFromWeb=[M,true];K.UpdateGroupInfo=[M,true];K.UpdateRoleDefInfo=[M,true];K.UpdateRoleInfo=[M,true];K.UpdateUserInfo=[M,true];K.AddColleague=[J,true];K.AddLink=[J,true];K.AddMembership=[J,true];K.AddPinnedLink=[J,true];K.CreateMemberGroup=[J,true];K.CreateUserProfileByAccountName=[J,true];K.GetCommonColleagues=[J,false];K.GetCommonManager=[J,false];K.GetCommonMemberships=[J,false];K.GetInCommon=[J,false];K.GetPropertyChoiceList=[J,false];K.GetUserColleagues=[J,false];K.GetUserLinks=[J,false];K.GetUserMemberships=[J,false];K.GetUserPinnedLinks=[J,false];K.GetUserProfileByGuid=[J,false];K.GetUserProfileByIndex=[J,false];K.GetUserProfileByName=[J,false];K.GetUserProfileCount=[J,false];K.GetUserProfileSchema=[J,false];K.ModifyUserPropertyByAccountName=[J,true];K.RemoveAllColleagues=[J,true];K.RemoveAllLinks=[J,true];K.RemoveAllMemberships=[J,true];K.RemoveAllPinnedLinks=[J,true];K.RemoveColleague=[J,true];K.RemoveLink=[J,true];K.RemoveMembership=[J,true];K.RemovePinnedLink=[J,true];K.UpdateColleaguePrivacy=[J,true];K.UpdateLink=[J,true];K.UpdateMembershipPrivacy=[J,true];K.UpdatePinnedLink=[J,true];K.DeleteAllVersions=[Z,true];K.DeleteVersion=[Z,true];K.GetVersions=[Z,false];K.RestoreVersion=[Z,true];K.AddView=[k,true];K.DeleteView=[k,true];K.GetView=[k,false];K.GetViewHtml=[k,false];K.GetViewCollection=[k,false];K.UpdateView=[k,true];K.UpdateViewHtml=[k,true];K.AddWebPart=[G,true];K.GetWebPart2=[G,false];K.GetWebPartPage=[G,false];K.GetWebPartProperties=[G,false];K.GetWebPartProperties2=[G,false];K.CreateContentType=[q,true];K.GetColumns=[q,false];K.GetContentType=[q,false];K.GetContentTypes=[q,false];K.GetCustomizedPageStatus=[q,false];K.GetListTemplates=[q,false];K.GetObjectIdFromUrl=[q,false];K.GetWeb=[q,false];K.GetWebCollection=[q,false];K.GetAllSubWebCollection=[q,false];K.UpdateColumns=[q,true];K.UpdateContentType=[q,true];K.WebUrlFromPageUrl=[q,false];K.AlterToDo=[c,true];K.GetTemplatesForItem=[c,false];K.GetToDosForItem=[c,false];K.GetWorkflowDataForItem=[c,false];K.GetWorkflowTaskData=[c,false];K.StartWorkflow=[c,true];var F={};F.header="<soap:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soap='http://schemas.xmlsoap.org/soap/envelope/'><soap:Body>";F.footer="</soap:Body></soap:Envelope>";F.payload="";var N;H.fn.SPServices=function(i){var t=H.extend({},H.fn.SPServices.defaults,i);F.opheader="<"+t.operation+" ";switch(K[t.operation][0]){case n:F.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/' >";N="http://schemas.microsoft.com/sharepoint/soap/2002/1/alerts/";break;case L:F.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/meetings/' >";N="http://schemas.microsoft.com/sharepoint/soap/meetings/";break;case b:F.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";N="http://schemas.microsoft.com/sharepoint/soap/directory/";break;case u:F.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/' >";N="http://microsoft.com/webservices/SharePointPortalServer/PublishedLinksService/";break;case B:F.opheader+="xmlns='urn:Microsoft.Search' >";N="urn:Microsoft.Search/";break;case Q:F.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/SocialDataService' >";N="http://microsoft.com/webservices/SharePointPortalServer/SocialDataService/";break;case X:F.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/taxonomy/soap/' >";N="http://schemas.microsoft.com/sharepoint/taxonomy/soap/";break;case M:F.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/directory/' >";N="http://schemas.microsoft.com/sharepoint/soap/directory/";break;case J:F.opheader+="xmlns='http://microsoft.com/webservices/SharePointPortalServer/UserProfileService' >";N="http://microsoft.com/webservices/SharePointPortalServer/UserProfileService/";break;case G:F.opheader+="xmlns='http://microsoft.com/sharepoint/webpartpages' >";N="http://microsoft.com/sharepoint/webpartpages/";break;case c:F.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/workflow/' >";N="http://schemas.microsoft.com/sharepoint/soap/workflow/";break;default:F.opheader+="xmlns='http://schemas.microsoft.com/sharepoint/soap/'>";N="http://schemas.microsoft.com/sharepoint/soap/";break}N+=t.operation;F.opfooter="</"+t.operation+">";var aa="_vti_bin/"+K[t.operation][0]+".asmx";if(t.webURL.charAt(t.webURL.length-1)===h){aa=t.webURL+aa}else{if(t.webURL.length>0){aa=t.webURL+h+aa}else{aa=H().SPServices.SPGetCurrentSite()+h+aa}}F.payload="";switch(t.operation){case"GetAlerts":break;case"DeleteAlerts":F.payload+="<IDs>";for(W=0;W<t.IDs.length;W++){F.payload+=A("string",t.IDs[W])}F.payload+="</IDs>";break;case"Mode":break;case"Login":g(t,["userName","password"]);break;case"CopyIntoItems":g(t,["SourceUrl"]);F.payload+="<DestinationUrls>";for(W=0;W<t.DestinationUrls.length;W++){F.payload+=A("string",t.DestinationUrls[W])}F.payload+="</DestinationUrls>";g(t,["Fields","Stream","Results"]);break;case"CopyIntoItemsLocal":g(t,["SourceUrl"]);F.payload+="<DestinationUrls>";for(W=0;W<t.DestinationUrls.length;W++){F.payload+=A("string",t.DestinationUrls[W])}F.payload+="</DestinationUrls>";break;case"GetItem":g(t,["Url","Fields","Stream"]);break;case"GetForm":g(t,["listName","formUrl"]);break;case"GetFormCollection":g(t,["listName"]);break;case"AddAttachment":g(t,["listName","listItemID","fileName","attachment"]);break;case"AddList":g(t,["listName","description","templateID"]);break;case"CheckInFile":g(t,["pageUrl","comment","CheckinType"]);break;case"CheckOutFile":g(t,["pageUrl","checkoutToLocal","lastmodified"]);break;case"DeleteAttachment":g(t,["listName","listItemID","url"]);break;case"DeleteList":g(t,["listName"]);break;case"GetAttachmentCollection":g(t,["listName",["listItemID","ID"]]);break;case"GetList":g(t,["listName"]);break;case"GetListAndView":g(t,["listName","viewName"]);break;case"GetListCollection":break;case"GetListContentType":g(t,["listName","contentTypeId"]);break;case"GetListContentTypes":g(t,["listName"]);break;case"GetListItems":g(t,["listName","viewName",["query","CAMLQuery"],["viewFields","CAMLViewFields"],["rowLimit","CAMLRowLimit"],["queryOptions","CAMLQueryOptions"]]);break;case"UpdateList":g(t,["listName","listProperties","newFields","updateFields","deleteFields","listVersion"]);break;case"UpdateListItems":g(t,["listName"]);if(t.updates.length>0){g(t,["updates"])}else{F.payload+="<updates><Batch OnError='Continue'><Method ID='1' Cmd='"+t.batchCmd+"'>";for(W=0;W<t.valuepairs.length;W++){F.payload+="<Field Name='"+t.valuepairs[W][0]+"'>"+w(t.valuepairs[W][1])+"</Field>"}if(t.batchCmd!=="New"){F.payload+="<Field Name='ID'>"+t.ID+"</Field>"}F.payload+="</Method></Batch></updates>"}break;case"AddMeeting":g(t,["organizerEmail","uid","sequence","utcDateStamp","title","location","utcDateStart","utcDateEnd","nonGregorian"]);break;case"CreateWorkspace":g(t,["title","templateName","lcid","timeZoneInformation"]);break;case"RemoveMeeting":g(t,["recurrenceId","uid","sequence","utcDateStamp","cancelMeeting"]);break;case"SetWorkspaceTitle":g(t,["title"]);break;case"SearchPrincipals":g(t,["searchText","maxResults","principalType"]);break;case"AddPermission":g(t,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"AddPermissionCollection":g(t,["objectName","objectType","permissionsInfoXml"]);break;case"GetPermissionCollection":g(t,["objectName","objectType"]);break;case"RemovePermission":g(t,["objectName","objectType","permissionIdentifier","permissionType"]);break;case"RemovePermissionCollection":g(t,["objectName","objectType","memberIdsXml"]);break;case"UpdatePermission":g(t,["objectName","objectType","permissionIdentifier","permissionType","permissionMask"]);break;case"GetLinks":break;case"GetPortalSearchInfo":F.opheader="<"+t.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";N="http://microsoft.com/webservices/OfficeServer/QueryService/"+t.operation;break;case"GetQuerySuggestions":F.opheader="<"+t.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";N="http://microsoft.com/webservices/OfficeServer/QueryService/"+t.operation;F.payload+=A("queryXml",a(t.queryXml));break;case"GetSearchMetadata":F.opheader="<"+t.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";N="http://microsoft.com/webservices/OfficeServer/QueryService/"+t.operation;break;case"Query":F.payload+=A("queryXml",a(t.queryXml));break;case"QueryEx":F.opheader="<"+t.operation+" xmlns='http://microsoft.com/webservices/OfficeServer/QueryService'>";N="http://microsoft.com/webservices/OfficeServer/QueryService/"+t.operation;F.payload+=A("queryXml",a(t.queryXml));break;case"Registration":F.payload+=A("registrationXml",a(t.registrationXml));break;case"Status":break;case"EnumerateFolder":g(t,["strFolderUrl"]);break;case"SiteDataGetList":g(t,["strListName"]);P=F.opheader;F.opheader=P.replace("SiteDataGetList","GetList");P=F.opfooter;F.opfooter=P.replace("SiteDataGetList","GetList");break;case"SiteDataGetListCollection":P=F.opheader;F.opheader=P.replace("SiteDataGetListCollection","GetListCollection");P=F.opfooter;F.opfooter=P.replace("SiteDataGetListCollection","GetListCollection");break;case"AddComment":g(t,["url","comment","isHighPriority","title"]);break;case"AddTag":g(t,["url","termID","title","isPrivate"]);break;case"AddTagByKeyword":g(t,["url","keyword","title","isPrivate"]);break;case"CountCommentsOfUser":g(t,["userAccountName"]);break;case"CountCommentsOfUserOnUrl":g(t,["userAccountName","url"]);break;case"CountCommentsOnUrl":g(t,["url"]);break;case"CountRatingsOnUrl":g(t,["url"]);break;case"CountTagsOfUser":g(t,["userAccountName"]);break;case"DeleteComment":g(t,["url","lastModifiedTime"]);break;case"DeleteRating":g(t,["url"]);break;case"DeleteTag":g(t,["url","termID"]);break;case"DeleteTagByKeyword":g(t,["url","keyword"]);break;case"DeleteTags":g(t,["url"]);break;case"GetAllTagTerms":g(t,["maximumItemsToReturn"]);break;case"GetAllTagTermsForUrlFolder":g(t,["urlFolder","maximumItemsToReturn"]);break;case"GetAllTagUrls":g(t,["termID"]);break;case"GetAllTagUrlsByKeyword":g(t,["keyword"]);break;case"GetCommentsOfUser":g(t,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetCommentsOfUserOnUrl":g(t,["userAccountName","url"]);break;case"GetCommentsOnUrl":g(t,["url","maximumItemsToReturn","startIndex"]);if(t.excludeItemsTime.length>0){F.payload+=A("excludeItemsTime",t.excludeItemsTime)}break;case"GetRatingAverageOnUrl":g(t,["url"]);break;case"GetRatingOfUserOnUrl":g(t,["userAccountName","url"]);break;case"GetRatingOnUrl":g(t,["url"]);break;case"GetRatingsOfUser":g(t,["userAccountName"]);break;case"GetRatingsOnUrl":g(t,["url"]);break;case"GetSocialDataForFullReplication":g(t,["userAccountName"]);break;case"GetTags":g(t,["url"]);break;case"GetTagsOfUser":g(t,["userAccountName","maximumItemsToReturn","startIndex"]);break;case"GetTagTerms":g(t,["maximumItemsToReturn"]);break;case"GetTagTermsOfUser":g(t,["userAccountName","maximumItemsToReturn"]);break;case"GetTagTermsOnUrl":g(t,["url","maximumItemsToReturn"]);break;case"GetTagUrls":g(t,["termID"]);break;case"GetTagUrlsByKeyword":g(t,["keyword"]);break;case"GetTagUrlsOfUser":g(t,["termID","userAccountName"]);break;case"GetTagUrlsOfUserByKeyword":g(t,["keyword","userAccountName"]);break;case"SetRating":g(t,["url","rating","title","analysisDataEntry"]);break;case"UpdateComment":g(t,["url","lastModifiedTime","comment","isHighPriority"]);break;case"AddTerms":g(t,["sharedServiceId","termSetId","lcid","newTerms"]);break;case"GetChildTermsInTerm":g(t,["sspId","lcid","termId","termSetId"]);break;case"GetChildTermsInTermSet":g(t,["sspId","lcid","termSetId"]);break;case"GetKeywordTermsByGuids":g(t,["termIds","lcid"]);break;case"GetTermsByLabel":g(t,["label","lcid","matchOption","resultCollectionSize","termIds","addIfNotFound"]);break;case"GetTermSets":g(t,["sharedServiceId","termSetId","lcid","clientTimeStamps","clientVersions"]);break;case"AddGroup":g(t,["groupName","ownerIdentifier","ownerType","defaultUserLoginName","groupName","description"]);break;case"AddGroupToRole":g(t,["groupName","roleName"]);break;case"AddRole":g(t,["roleName","description","permissionMask"]);break;case"AddRoleDef":g(t,["roleName","description","permissionMask"]);break;case"AddUserCollectionToGroup":g(t,["groupName","usersInfoXml"]);break;case"AddUserCollectionToRole":g(t,["roleName","usersInfoXml"]);break;case"AddUserToGroup":g(t,["groupName","userName","userLoginName","userEmail","userNotes"]);break;case"AddUserToRole":g(t,["roleName","userName","userLoginName","userEmail","userNotes"]);break;case"GetAllUserCollectionFromWeb":break;case"GetGroupCollection":g(t,["groupNamesXml"]);break;case"GetGroupCollectionFromRole":g(t,["roleName"]);break;case"GetGroupCollectionFromSite":break;case"GetGroupCollectionFromUser":g(t,["userLoginName"]);break;case"GetGroupCollectionFromWeb":break;case"GetGroupInfo":g(t,["groupName"]);break;case"GetRoleCollection":g(t,["roleNamesXml"]);break;case"GetRoleCollectionFromGroup":g(t,["groupName"]);break;case"GetRoleCollectionFromUser":g(t,["userLoginName"]);break;case"GetRoleCollectionFromWeb":break;case"GetRoleInfo":g(t,["roleName"]);break;case"GetRolesAndPermissionsForCurrentUser":break;case"GetRolesAndPermissionsForSite":break;case"GetUserCollection":g(t,["userLoginNamesXml"]);break;case"GetUserCollectionFromGroup":g(t,["groupName"]);break;case"GetUserCollectionFromRole":g(t,["roleName"]);break;case"GetUserCollectionFromSite":break;case"GetUserCollectionFromWeb":break;case"GetUserInfo":g(t,["userLoginName"]);break;case"GetUserLoginFromEmail":g(t,["emailXml"]);break;case"RemoveGroup":g(t,["groupName"]);break;case"RemoveGroupFromRole":g(t,["roleName","groupName"]);break;case"RemoveRole":g(t,["roleName"]);break;case"RemoveUserCollectionFromGroup":g(t,["groupName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromRole":g(t,["roleName","userLoginNamesXml"]);break;case"RemoveUserCollectionFromSite":g(t,["userLoginNamesXml"]);break;case"RemoveUserFromGroup":g(t,["groupName","userLoginName"]);break;case"RemoveUserFromRole":g(t,["roleName","userLoginName"]);break;case"RemoveUserFromSite":g(t,["userLoginName"]);break;case"RemoveUserFromWeb":g(t,["userLoginName"]);break;case"UpdateGroupInfo":g(t,["oldGroupName","groupName","ownerIdentifier","ownerType","description"]);break;case"UpdateRoleDefInfo":g(t,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateRoleInfo":g(t,["oldRoleName","roleName","description","permissionMask"]);break;case"UpdateUserInfo":g(t,["userLoginName","userName","userEmail","userNotes"]);break;case"AddColleague":g(t,["accountName","colleagueAccountName","group","privacy","isInWorkGroup"]);break;case"AddLink":g(t,["accountName","name","url","group","privacy"]);break;case"AddMembership":g(t,["accountName","membershipInfo","group","privacy"]);break;case"AddPinnedLink":g(t,["accountName","name","url"]);break;case"CreateMemberGroup":g(t,["membershipInfo"]);break;case"CreateUserProfileByAccountName":g(t,["accountName"]);break;case"GetCommonColleagues":g(t,["accountName"]);break;case"GetCommonManager":g(t,["accountName"]);break;case"GetCommonMemberships":g(t,["accountName"]);break;case"GetInCommon":g(t,["accountName"]);break;case"GetPropertyChoiceList":g(t,["propertyName"]);break;case"GetUserColleagues":g(t,["accountName"]);break;case"GetUserLinks":g(t,["accountName"]);break;case"GetUserMemberships":g(t,["accountName"]);break;case"GetUserPinnedLinks":g(t,["accountName"]);break;case"GetUserProfileByGuid":g(t,["guid"]);break;case"GetUserProfileByIndex":g(t,["index"]);break;case"GetUserProfileByName":if(t.accountName.length>0){g(t,[["AccountName","accountName"]])}else{g(t,["AccountName"])}break;case"GetUserProfileCount":break;case"GetUserProfileSchema":break;case"ModifyUserPropertyByAccountName":g(t,["accountName","newData"]);break;case"RemoveAllColleagues":g(t,["accountName"]);break;case"RemoveAllLinks":g(t,["accountName"]);break;case"RemoveAllMemberships":g(t,["accountName"]);break;case"RemoveAllPinnedLinks":g(t,["accountName"]);break;case"RemoveColleague":g(t,["accountName","colleagueAccountName"]);break;case"RemoveLink":g(t,["accountName","id"]);break;case"RemoveMembership":g(t,["accountName","sourceInternal","sourceReference"]);break;case"RemovePinnedLink":g(t,["accountName","id"]);break;case"UpdateColleaguePrivacy":g(t,["accountName","colleagueAccountName","newPrivacy"]);break;case"UpdateLink":g(t,["accountName","data"]);break;case"UpdateMembershipPrivacy":g(t,["accountName","sourceInternal","sourceReference","newPrivacy"]);break;case"UpdatePinnedLink ":g(t,["accountName","data"]);break;case"DeleteAllVersions":g(t,["fileName"]);break;case"DeleteVersion":g(t,["fileName","fileVersion"]);break;case"GetVersions":g(t,["fileName"]);break;case"RestoreVersion":g(t,["fileName","fileVersion"]);break;case"AddView":g(t,["listName","viewName","viewFields","query","rowLimit","rowLimit","type","makeViewDefault"]);break;case"DeleteView":g(t,["listName","viewName"]);break;case"GetView":g(t,["listName","viewName"]);break;case"GetViewCollection":g(t,["listName"]);break;case"GetViewHtml":g(t,["listName","viewName"]);break;case"UpdateView":g(t,["listName","viewName","viewProperties","query","viewFields","aggregations","formats","rowLimit"]);break;case"UpdateViewHtml":g(t,["listName","viewName","viewProperties","toolbar","viewHeader","viewBody","viewFooter","viewEmpty","rowLimitExceeded","query","viewFields","aggregations","formats","rowLimit"]);break;case"AddWebPart":g(t,["pageUrl","webPartXml","storage"]);break;case"GetWebPart2":g(t,["pageUrl","storageKey","storage","behavior"]);break;case"GetWebPartPage":g(t,["documentName","behavior"]);break;case"GetWebPartProperties":g(t,["pageUrl","storage"]);break;case"GetWebPartProperties2":g(t,["pageUrl","storage","behavior"]);break;case"CreateContentType":g(t,["displayName","parentType","newFields","contentTypeProperties"]);break;case"GetColumns":g(t,["webUrl"]);break;case"GetContentType":g(t,["contentTypeId"]);break;case"GetContentTypes":break;case"GetCustomizedPageStatus":g(t,["fileUrl"]);break;case"GetListTemplates":break;case"GetObjectIdFromUrl":g(t,["objectUrl"]);break;case"GetWeb":g(t,[["webUrl","webURL"]]);break;case"GetWebCollection":break;case"GetAllSubWebCollection":break;case"UpdateColumns":g(t,["newFields","updateFields","deleteFields"]);break;case"UpdateContentType":g(t,["contentTypeId","contentTypeProperties","newFields","updateFields","deleteFields"]);break;case"WebUrlFromPageUrl":g(t,[["pageUrl","pageURL"]]);break;case"AlterToDo":g(t,["item","todoId","todoListId","taskData"]);break;case"GetTemplatesForItem":g(t,["item"]);break;case"GetToDosForItem":g(t,["item"]);break;case"GetWorkflowDataForItem":g(t,["item"]);break;case"GetWorkflowTaskData":g(t,["item","listId","taskId"]);break;case"StartWorkflow":g(t,["item","templateId","workflowParameters"]);break;default:break}var ab=F.header+F.opheader+F.payload+F.opfooter+F.footer;H.ajax({url:aa,async:t.async,beforeSend:function(ac){if(K[t.operation][1]){ac.setRequestHeader("SOAPAction",N)}},type:"POST",data:ab,dataType:"xml",contentType:"text/xml;charset='utf-8'",complete:t.completefunc})};H.fn.SPServices.defaults={operation:"",webURL:"",pageURL:"",objectUrl:"",listName:"",description:"",templateID:"",formUrl:"",fileName:"",fileVersion:"",ID:1,updates:"",comment:"",CheckinType:"",checkoutToLocal:"",lastmodified:"",viewName:"",viewProperties:"",viewFields:"",query:"",aggregations:"",formats:"",rowLimit:"",type:"",makeViewDefault:false,toolbar:"",viewHeader:"",viewBody:"",viewFooter:"",viewEmpty:"",rowLimitExceeded:"",CAMLViewName:"",CAMLQuery:"",CAMLViewFields:"",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions></QueryOptions>",batchCmd:"Update",valuepairs:[],listProperties:"",newFields:"",updateFields:"",deleteFields:"",contentTypeId:"",contentTypeProperties:"",listVersion:"",username:"",password:"",accountName:"",propertyName:"",newData:"",AccountName:"",userName:"",userLoginName:"",userEmail:"",userNotes:"",groupNamesXml:"",groupName:"",oldGroupName:"",ownerIdentifier:"",ownerType:"",defaultUserLoginName:"",roleNamesXml:"",roleName:"",oldRoleName:"",permissionIdentifier:"",permissionType:"",permissionMask:"",permissionsInfoXml:"",memberIdsXml:"",usersInfoXml:"",userLoginNamesXml:"",emailXml:"",objectName:"",objectType:"List",IDs:null,listItemID:"",attachment:"",SourceUrl:"",Url:"",DestinationUrls:[],Fields:"",Stream:"",Results:"",documentName:"",behavior:"Version3",storageKey:"",storage:"Shared",webPartXml:"",item:"",todoId:"",todoListId:"",taskData:"",listId:"",taskId:"",templateId:"",workflowParameters:"",fClaim:false,queryXml:"",cancelMeeting:true,lcid:"",location:"",nonGregorian:false,organizerEmail:"",recurrenceId:0,sequence:0,templateName:"",timeZoneInformation:"",title:"",uid:"",utcDateStamp:"",utcDateStart:"",utcDateEnd:"",searchText:"",maxResults:10,principalType:"User",strFolderUrl:"",strListName:"",fileUrl:"",displayName:"",parentType:"",url:"",termID:"",userAccountName:"",maximumItemsToReturn:0,urlFolder:"",keyword:"",startIndex:0,excludeItemsTime:"",isHighPriority:false,isPrivate:false,lastModifiedTime:"",rating:1,analysisDataEntry:"",sharedServiceId:"",termSetId:"",newTerms:"",sspId:"",termId:"",termIds:"",label:"",matchOption:"",resultCollectionSize:"",addIfNotFound:"",clientTimeStamps:"",clientVersions:"",async:true,completefunc:null};H.fn.SPServices.SPGetCurrentSite=function(){if(e.length>0){return e}var i=F.header+"<WebUrlFromPageUrl xmlns='http://schemas.microsoft.com/sharepoint/soap/' ><pageUrl>"+((location.href.indexOf("?")>0)?location.href.substr(0,location.href.indexOf("?")):location.href)+"</pageUrl></WebUrlFromPageUrl>"+F.footer;H.ajax({async:false,url:"/_vti_bin/Webs.asmx",type:"POST",data:i,dataType:"xml",contentType:'text/xml;charset="utf-8"',complete:function(aa,t){e=H(aa.responseXML).find("WebUrlFromPageUrlResult").text()}});return e};H.fn.SPServices.SPCascadeDropdowns=function(t){var ab=H.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListParentColumn:"",relationshipListChildColumn:"",relationshipListSortColumn:"",parentColumn:"",childColumn:"",listName:H().SPServices.SPListNameFromUrl(),CAMLQuery:"",promptText:"Choose {0}...",noneText:"(None)",simpleChild:false,selectSingleOption:false,completefunc:null,debug:false},t);var aa=new R(ab.parentColumn);if(aa.Obj.html()===null&&ab.debug){E("SPServices.SPCascadeDropdowns","parentColumn: "+ab.parentColumn,"Column not found on page");return}var i=new R(ab.childColumn);if(i.Obj.html()===null&&ab.debug){E("SPServices.SPCascadeDropdowns","childColumn: "+ab.childColumn,"Column not found on page");return}if(ab.simpleChild===true&&i.Type==="C"){H().SPServices.SPComplexToSimpleDropdown({columnName:ab.childColumn});i=new R(ab.childColumn)}switch(aa.Type){case"S":aa.Obj.bind("change",function(){U(ab,i)});aa.Obj.change();break;case"C":aa.Obj.bind("propertychange",function(){U(ab,i)});aa.Obj.trigger("propertychange");break;case"M":aa.Obj.bind("dblclick",function(){U(ab,i)});parentSelections=aa.Obj.closest("span").find("select[ID$='SelectResult'][Title^='"+ab.parentColumn+" ']");parentSelections.bind("dblclick",function(){U(ab,i)});aa.Obj.closest("span").find("button").each(function(){H(this).bind("click",function(){U(ab,i)})});U(ab,i);break;default:break}};function U(ab,t){var ao="";var ah=null;var af=[];var aa;var ai;var al;var am;var ag;var ak;var ad;var ae=new R(ab.parentColumn);switch(ae.Type){case"S":af.push(ae.Obj.find("option:selected").text());break;case"C":af.push(ae.Obj.attr("value"));break;case"M":parentSelections=ae.Obj.closest("span").find("select[ID$='SelectResult'][Title^='"+ab.parentColumn+" ']");H(parentSelections).find("option").each(function(){af.push(H(this).html())});break;default:break}var aj=H().SPServices.SPGetStaticFromDisplay({listName:ab.listName,columnDisplayName:ab.childColumn});if(ae.Obj.attr("SPCascadeDropdown_Selected_"+aj)===af.join(";#")){return}ae.Obj.attr("SPCascadeDropdown_Selected_"+aj,af.join(";#"));switch(t.Type){case"S":ah=t.Obj.find("option:selected").val();break;case"C":ah=t.Obj.attr("value");break;case"M":ai=t.Obj.closest("span").find("input[name$='MultiLookupPicker$data']");aa=window[t.Obj.closest("tr").find("button[id$='AddButton']").attr("id").replace(/AddButton/,"MultiLookupPicker_m")];currentSelection=t.Obj.closest("span").find("select[ID$='SelectResult'][Title^='"+ab.childColumn+" ']");aa.data="";break;default:break}var ac=(ab.relationshipListSortColumn.length>0)?ab.relationshipListSortColumn:ab.relationshipListChildColumn;var i="<Query><OrderBy><FieldRef Name='"+ac+"'/></OrderBy><Where>";if(ab.CAMLQuery.length>0){i+="<And>"}if(af.length===0){i+="<Eq><FieldRef Name='"+ab.relationshipListParentColumn+"'/><Value Type='Text'></Value></Eq>"}else{if(af.length===1){i+="<Eq><FieldRef Name='"+ab.relationshipListParentColumn+"'/><Value Type='Text'>"+w(af[0])+"</Value></Eq>"}else{var an=(af.length>2)?true:false;for(W=0;W<(af.length-1);W++){i+="<Or>"}for(W=0;W<af.length;W++){i+="<Eq><FieldRef Name='"+ab.relationshipListParentColumn+"'/><Value Type='Text'>"+w(af[W])+"</Value></Eq>";if(W>0&&(W<(af.length-1))&&an){i+="</Or>"}}i+="</Or>"}}if(ab.CAMLQuery.length>0){i+=ab.CAMLQuery+"</And>"}i+="</Where></Query>";H().SPServices({operation:"GetList",async:false,listName:ab.listName,completefunc:function(aq,ap){H(aq.responseXML).find("Fields").each(function(){H(this).find("Field[DisplayName='"+ab.childColumn+"']").each(function(){am=(H(this).attr("Required")==="TRUE")?true:false;return false})})}});H().SPServices({operation:"GetListItems",async:false,webURL:ab.relationshipWebURL,listName:ab.relationshipList,CAMLQuery:i,CAMLViewFields:"<ViewFields><FieldRef Name='"+ab.relationshipListParentColumn+"' /><FieldRef Name='"+ab.relationshipListChildColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns></QueryOptions>",completefunc:function(aq,ap){H(aq.responseXML).find("faultcode").each(function(){if(ab.debug){E("SPServices.SPCascadeDropdowns","relationshipListParentColumn: "+ab.relationshipListParentColumn+" or relationshipListChildColumn: "+ab.relationshipListChildColumn,"Not found in relationshipList "+ab.relationshipList)}return});switch(t.Type){case"S":H(t.Obj).find("option").remove();if(!am&&(ab.promptText.length>0)){t.Obj.append("<option value='0'>"+ab.promptText.replace(/\{0\}/g,ab.childColumn)+"</option>")}break;case"C":ao=am?"":ab.noneText+"|0";t.Obj.attr("value","");break;case"M":H(t.Obj).find("option").remove();al="";break;default:break}ag=parseFloat(H(aq.responseXML).SPFilterNode("rs:data").attr("ItemCount"));H(aq.responseXML).SPFilterNode("z:row").each(function(){var at=(H(this).attr("ows_"+ab.relationshipListChildColumn).indexOf(";#")>0)?H(this).attr("ows_"+ab.relationshipListChildColumn).split(";#")[0]:H(this).attr("ows_ID");if(isNaN(at)){at=H(this).attr("ows_ID")}var ar=(H(this).attr("ows_"+ab.relationshipListChildColumn).indexOf(";#")>0)?H(this).attr("ows_"+ab.relationshipListChildColumn).split(";#")[1]:H(this).attr("ows_"+ab.relationshipListChildColumn);ak=at;ad=ar;switch(t.Type){case"S":var au=(H(this).attr("ows_ID")===ah)?" selected='selected'":"";t.Obj.append("<option"+au+" value='"+at+"'>"+ar+"</option>");break;case"C":if(ar===ah){t.Obj.attr("value",ah)}ao=ao+((ao.length>0)?"|":"")+ar+"|"+at;break;case"M":t.Obj.append("<option value='"+at+"'>"+ar+"</option>");al+=at+"|t"+ar+"|t |t |t";break;default:break}});switch(t.Type){case"S":t.Obj.trigger("change");if(ag===1&&ab.selectSingleOption===true){H(t.Obj).find("option[value!='0']:first").attr("selected","selected")}break;case"C":t.Obj.attr("choices",ao);if(ag===1&&ab.selectSingleOption===true){H(t.Obj).attr("value",ad);H("input[id='"+t.Obj.attr("optHid")+"']").val(ak)}t.Obj.trigger("propertychange");if(t.Obj.val()===""){H("input[id='"+t.Obj.attr("optHid")+"']").val("")}break;case"M":ai.attr("value",al);H(currentSelection).find("option").each(function(){var at=H(this);var ar=H(this).html();H(this).attr("selected","selected");H(t.Obj).find("option:contains('"+ar+"')").each(function(){if(H(this).html()===ar){at.removeAttr("selected")}})});GipRemoveSelectedItems(aa);H(t.Obj).find("option").each(function(){var ar=H(this);H(currentSelection).find("option").each(function(){if(H(this).html()===ar.html()){ar.remove()}})});GipAddSelectedItems(aa);aa.data=GipGetGroupData(al);t.Obj.trigger("dblclick");break;default:break}}});if(ab.completefunc!==null){ab.completefunc()}}H.fn.SPServices.SPComplexToSimpleDropdown=function(ac){var ad=H.extend({},{columnName:"",completefunc:null,debug:false},ac);var ae=new R(ad.columnName);if(ae.Obj.html()===null&&ad.debug){E("SPServices.SPComplexToSimpleDropdown","columnName: "+ad.columnName,"Column not found on page");return}if(ae.Type!=="C"){return}var af=H(ae.Obj).attr("choices").split("|");var t=ae.Obj.attr("value");var i=H(ae.Obj).attr("optHid");var ab=j("SPComplexToSimpleDropdown",ad.columnName);var aa="<select id='"+ab+"' title='"+ad.columnName+"'>";for(W=0;W<af.length;W=W+2){aa+="<option value='"+af[W+1]+"'>"+af[W]+"</option>"}aa+="</select>";H(ae.Obj).closest("td").prepend(aa);H("#"+ab).find("option").filter(function(){return H(this).text()==t}).find(":first").attr("selected","selected");H(ae.Obj).closest("span").find("img").remove();H(ae.Obj).closest("span").find("input").hide();H("#"+ab).change(function(){var ag=H(this).val();H("input[id='"+i+"']").val(ag);H(ae.Obj).val(H(this).find("option[value='"+ag+"']").html())});H("#"+ab).trigger("change")};H.fn.SPServices.SPDisplayRelatedInfo=function(i){var aa=H.extend({},{columnName:"",relatedWebURL:"",relatedList:"",relatedListColumn:"",relatedColumns:[],displayFormat:"table",headerCSSClass:"ms-vh2",rowCSSClass:"ms-vb",CAMLQuery:"",numChars:0,matchType:"Eq",completefunc:null,debug:false},i);var t=[];var ac;var ab=new R(aa.columnName);if(ab.Obj.html()===null&&aa.debug){E("SPServices.SPDisplayRelatedInfo","columnName: "+aa.columnName,"Column not found on page");return}H().SPServices({operation:"GetList",async:false,webURL:aa.relatedWebURL,listName:aa.relatedList,completefunc:function(ae,ad){H(ae.responseXML).find("faultcode").each(function(){if(aa.debug){E("SPServices.SPDisplayRelatedInfo","relatedList: "+aa.relatedList,"List not found");return}});ac=H(ae.responseXML).find("List");for(W=0;W<aa.relatedColumns.length;W++){t[W]=H(ae.responseXML).find("Fields > Field[Name='"+aa.relatedColumns[W]+"']")}}});switch(ab.Type){case"S":ab.Obj.bind("change",function(){C(aa,ac,t)});ab.Obj.change();break;case"C":ab.Obj.bind("propertychange",function(){C(aa,ac,t)});ab.Obj.trigger("propertychange");break;case"M":if(aa.debug){E("SPServices.SPDisplayRelatedInfo","columnName: "+aa.columnName,"Multi-select columns not supported by this function")}break;default:break}};function C(ad,af,ac){var t=null;var ae=new R(ad.columnName);switch(ae.Type){case"S":t=ae.Obj.find("option:selected").text();break;case"C":t=ae.Obj.attr("value");if(ad.numChars>0&&t.length<ad.numChars){return}break;case"M":break;default:break}if(ae.Obj.attr("showRelatedSelected")===t){return}ae.Obj.attr("showRelatedSelected",t);var ab=j("SPDisplayRelatedInfo",ad.columnName);H("#"+ab).remove();ae.Obj.parent().append("<div id="+ab+"></div>");var i="<Query><Where>";if(ad.CAMLQuery.length>0){i+="<And>"}i+="<"+ad.matchType+"><FieldRef Name='"+ad.relatedListColumn+"'/><Value Type='Text'>"+w(t)+"</Value></"+ad.matchType+">";if(ad.CAMLQuery.length>0){i+=ad.CAMLQuery+"</And>"}i+="</Where></Query>";var aa=" ";for(W=0;W<ad.relatedColumns.length;W++){aa+="<FieldRef Name='"+ad.relatedColumns[W]+"' />"}H().SPServices({operation:"GetListItems",async:false,webURL:ad.relatedWebURL,listName:ad.relatedList,CAMLQuery:i,CAMLViewFields:"<ViewFields>"+aa+"</ViewFields>",CAMLRowLimit:0,completefunc:function(ai,ah){H(ai.responseXML).find("faultcode").each(function(){if(ad.debug){E("SPServices.SPDisplayRelatedInfo","relatedListColumn: "+ad.relatedListColumn,"Column not found in relatedList "+ad.relatedList);return}});var ag;switch(ad.displayFormat){case"table":ag="<table>";ag+="<tr>";for(W=0;W<ad.relatedColumns.length;W++){if(typeof ac[W]==="undefined"&&ad.debug){E("SPServices.SPDisplayRelatedInfo","columnName: "+ad.relatedColumns[W],"Column not found in relatedList");return}ag+="<th class='"+ad.headerCSSClass+"'>"+ac[W].attr("DisplayName")+"</th>"}ag+="</tr>";H(ai.responseXML).SPFilterNode("z:row").each(function(){ag+="<tr>";for(W=0;W<ad.relatedColumns.length;W++){ag+="<td class='"+ad.rowCSSClass+"'>"+y(af,ac[W],H(this).attr("ows_"+ad.relatedColumns[W]),ad)+"</td>"}ag+="</tr>"});ag+="</table>";break;case"list":ag="<table>";H(ai.responseXML).SPFilterNode("z:row").each(function(){for(W=0;W<ad.relatedColumns.length;W++){ag+="<tr>";ag+="<th class='"+ad.headerCSSClass+"'>"+ac[W].attr("DisplayName")+"</th>";ag+="<td class='"+ad.rowCSSClass+"'>"+y(af,ac[W],H(this).attr("ows_"+ad.relatedColumns[W]),ad)+"</td>";ag+="</tr>"}});ag+="</table>";break;default:break}H("#"+ab).html(ag)}});if(ad.completefunc!==null){ad.completefunc()}}H.fn.SPServices.SPFilterDropdown=function(ai){var aa=H.extend({},{relationshipWebURL:"",relationshipList:"",relationshipListColumn:"",relationshipListSortColumn:"",columnName:"",listName:H().SPServices.SPListNameFromUrl(),promptText:"Choose {0}...",noneText:"(None)",CAMLQuery:"",completefunc:null,debug:false},ai);var ah="";var ag=null;var t;var ac;var af;var ae;var ad=new R(aa.columnName);if(ad.Obj.html()===null&&aa.debug){E("SPServices.SPFilterDropdown","columnName: "+aa.columnName,"Column not found on page");return}switch(ad.Type){case"S":ag=ad.Obj.find("option:selected").val();break;case"C":ag=ad.Obj.attr("value");break;case"M":ac=ad.Obj.closest("span").find("input[name$='MultiLookupPicker$data']");t=window[ad.Obj.closest("tr").find("button[id$='AddButton']").attr("id").replace(/AddButton/,"MultiLookupPicker_m")];currentSelection=ad.Obj.closest("span").find("select[ID$='SelectResult'][Title^='"+aa.columnName+" ']");t.data="";break;default:break}var ab=(aa.relationshipListSortColumn.length>0)?aa.relationshipListSortColumn:aa.relationshipListColumn;var i="<Query><OrderBy><FieldRef Name='"+ab+"'/></OrderBy><Where>";if(aa.CAMLQuery.length>0){i+=aa.CAMLQuery}i+="</Where></Query>";H().SPServices({operation:"GetList",async:false,listName:aa.listName,completefunc:function(ak,aj){H(ak.responseXML).find("Fields").each(function(){H(this).find("Field[DisplayName='"+aa.columnName+"']").each(function(){ae=(H(this).attr("Required")==="TRUE")?true:false;return false})})}});H().SPServices({operation:"GetListItems",async:false,webURL:aa.relationshipWebURL,listName:aa.relationshipList,CAMLQuery:i,CAMLViewFields:"<ViewFields><FieldRef Name='"+aa.relationshipListColumn+"' /></ViewFields>",CAMLRowLimit:0,CAMLQueryOptions:"<QueryOptions><IncludeMandatoryColumns>FALSE</IncludeMandatoryColumns></QueryOptions>",completefunc:function(ak,aj){H(ak.responseXML).find("faultcode").each(function(){if(aa.debug){E("SPServices.SPFilterDropdown","relationshipListColumn: "+aa.relationshipListColumn,"Not found in relationshipList "+aa.relationshipList+" - or CAML is incorrect")}return});switch(ad.Type){case"S":H(ad.Obj).find("option").remove();if(!ae&&(aa.promptText.length>0)){ad.Obj.append("<option value='0'>"+aa.promptText.replace(/\{0\}/g,aa.columnName)+"</option>")}break;case"C":ah=ae?"":aa.noneText+"|0";ad.Obj.attr("value","");break;case"M":H(ad.Obj).find("option").remove();af="";break;default:break}H(ak.responseXML).SPFilterNode("z:row").each(function(){var am=(H(this).attr("ows_"+aa.relationshipListColumn).indexOf(";#")>0)?H(this).attr("ows_"+aa.relationshipListColumn).split(";#")[0]:H(this).attr("ows_ID");if(isNaN(am)){am=H(this).attr("ows_ID")}var al=(H(this).attr("ows_"+aa.relationshipListColumn).indexOf(";#")>0)?H(this).attr("ows_"+aa.relationshipListColumn).split(";#")[1]:H(this).attr("ows_"+aa.relationshipListColumn);switch(ad.Type){case"S":var an=(H(this).attr("ows_ID")===ag)?" selected='selected'":"";ad.Obj.append("<option"+an+" value='"+am+"'>"+al+"</option>");break;case"C":if(al===ag){ad.Obj.attr("value",ag)}ah=ah+((ah.length>0)?"|":"")+al+"|"+am;break;case"M":ad.Obj.append("<option value='"+am+"'>"+al+"</option>");af+=am+"|t"+al+"|t |t |t";break;default:break}});switch(ad.Type){case"S":ad.Obj.trigger("change");break;case"C":ad.Obj.attr("choices",ah);ad.Obj.trigger("propertychange");break;case"M":ac.attr("value",af);H(currentSelection).find("option").each(function(){var al=H(this);H(this).attr("selected","selected");H(ad.Obj).find("option").each(function(){if(H(this).html()===al.html()){al.removeAttr("selected")}})});GipRemoveSelectedItems(t);H(ad.Obj).find("option").each(function(){var al=H(this);H(currentSelection).find("option").each(function(){if(H(this).html()===al.html()){al.remove()}})});GipAddSelectedItems(t);t.data=GipGetGroupData(af);ad.Obj.trigger("dblclick");break;default:break}}});if(aa.completefunc!==null){aa.completefunc()}};H.fn.SPServices.SPDebugXMLHttpResult=function(aa){var ac=H.extend({},{node:null,indent:0},aa);var ae=3;var ad=4;var t="";t+="<table class='ms-vb' style='margin-left:"+ac.indent*3+"px;' width='100%'>";if(ac.node.nodeName==="DisplayPattern"){t+="<tr><td width='100px' style='font-weight:bold;'>"+ac.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+ac.node.xml+"</textarea></td></tr>"}else{if(!ac.node.hasChildNodes()){t+="<tr><td width='100px' style='font-weight:bold;'>"+ac.node.nodeName+"</td><td>"+((ac.node.nodeValue!==null)?v(ac.node.nodeValue):"&nbsp;")+"</td></tr>";if(ac.node.attributes){t+="<tr><td colspan='99'>";t+=S(ac.node,ac);t+="</td></tr>"}}else{if(ac.node.hasChildNodes()&&ac.node.firstChild.nodeType===ad){t+="<tr><td width='100px' style='font-weight:bold;'>"+ac.node.nodeName+"</td><td><textarea readonly='readonly' rows='5' cols='50'>"+ac.node.parentNode.text+"</textarea></td></tr>"}else{if(ac.node.hasChildNodes()&&ac.node.firstChild.nodeType===ae){t+="<tr><td width='100px' style='font-weight:bold;'>"+ac.node.nodeName+"</td><td>"+v(ac.node.firstChild.nodeValue)+"</td></tr>"}else{t+="<tr><td width='100px' style='font-weight:bold;' colspan='99'>"+ac.node.nodeName+"</td></tr>";if(ac.node.attributes){t+="<tr><td colspan='99'>";t+=S(ac.node,ac);t+="</td></tr>"}t+="<tr><td>";for(var ab=0;ab<ac.node.childNodes.length;ab++){t+=H().SPServices.SPDebugXMLHttpResult({node:ac.node.childNodes.item(ab),indent:ac.indent+1})}t+="</td></tr>"}}}}t+="</table>";return t};H.fn.SPServices.SPGetCurrentUser=function(aa){var ab=H.extend({},{fieldName:"Name",debug:false},aa);if(ab.fieldName==="ID"){return _spUserId}var t="";var i=RegExp('FieldInternalName="'+ab.fieldName+'"',"gi");H.ajax({async:false,url:H().SPServices.SPGetCurrentSite()+"/_layouts/userdisp.aspx?Force=True&"+new Date().getTime(),complete:function(ad,ac){H(ad.responseText).find("table.ms-formtable td[id^='SPField']").each(function(){if(i.test(H(this).html())){switch(H(this).attr("id")){case"SPFieldText":t=H(this).text();break;case"SPFieldNote":t=H(this).find("div").html();break;case"SPFieldURL":t=H(this).find("img").attr("src");break;default:t=H(this).text();break}return false}})}});return(t!==undefined)?t.replace(/(^[\s\xA0]+|[\s\xA0]+$)/g,""):null};H.fn.SPServices.SPLookupAddNew=function(ab){var ac=H.extend({},{lookupColumn:"",promptText:"Add new {0}",newWindow:false,ContentTypeID:"",completefunc:null,debug:false},ab);var aa=new R(ac.lookupColumn);if(aa.Obj.html()===null&&ac.debug){E("SPServices.SPLookupAddNew","lookupColumn: "+ac.lookupColumn,"Column not found on page");return}var ae="";var t="";var ad="";H().SPServices({operation:"GetList",async:false,listName:H().SPServices.SPListNameFromUrl(),completefunc:function(ag,af){H(ag.responseXML).find("Field[DisplayName='"+ac.lookupColumn+"']").each(function(){ad=H(this).attr("StaticName");H().SPServices({operation:"GetList",async:false,listName:H(this).attr("List"),completefunc:function(ai,ah){H(ai.responseXML).find("List").each(function(){t=H(this).attr("WebFullUrl");t=t!==h?t+h:t})}});ae=p(H(this).attr("List"),"NewForm");return false})}});if(t.length===0&&ac.debug){E("SPServices.SPLookupAddNew","lookupColumn: "+ac.lookupColumn,"This column does not appear to be a lookup column");return}if(ae.length>0){var i=t+ae;i+=ac.newWindow?((ac.ContentTypeID.length>0)?"?ContentTypeID="+ac.ContentTypeID:"")+"' target='_blank'":"?"+((ac.ContentTypeID.length>0)?"ContentTypeID="+ac.ContentTypeID+"&":"")+"Source="+Y(location.href)+"'";newLink="<div id='SPLookupAddNew_"+ad+"'><a href='"+i+">"+ac.promptText.replace(/\{0\}/g,ac.lookupColumn)+"</a></div>";H(aa.Obj).parents("td.ms-formbody").append(newLink)}else{if(ac.debug){E("SPServices.SPLookupAddNew","lookupColumn: "+ac.lookupColumn,"NewForm cannot be found");return}}if(ac.completefunc!==null){ac.completefunc()}};H.fn.SPServices.SPGetLastItemId=function(t){var ab=H.extend({},{webURL:"",listName:"",userAccount:"",CAMLQuery:""},t);var aa;var ac=0;H().SPServices({operation:"GetUserInfo",async:false,userLoginName:(ab.userAccount!=="")?ab.userAccount:H().SPServices.SPGetCurrentUser(),completefunc:function(ae,ad){H(ae.responseXML).find("User").each(function(){aa=H(this).attr("ID")})}});var i="<Query><Where>";if(ab.CAMLQuery.length>0){i+="<And>"}i+="<Eq><FieldRef Name='Author' LookupId='TRUE'/><Value Type='Integer'>"+aa+"</Value></Eq>";if(ab.CAMLQuery.length>0){i+=ab.CAMLQuery+"</And>"}i+="</Where><OrderBy><FieldRef Name='Created_x0020_Date' Ascending='FALSE'/></OrderBy></Query>";H().SPServices({operation:"GetListItems",async:false,webURL:ab.webURL,listName:ab.listName,CAMLQuery:i,CAMLViewFields:"<ViewFields><FieldRef Name='ID'/></ViewFields>",CAMLRowLimit:1,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(ae,ad){H(ae.responseXML).SPFilterNode("z:row").each(function(){ac=H(this).attr("ows_ID")})}});return ac};H.fn.SPServices.SPRequireUnique=function(ag){var i=H.extend({},{columnStaticName:"Title",duplicateAction:0,ignoreCase:false,initMsg:"This value must be unique.",initMsgCSSClass:"ms-vb",errMsg:"This value is not unique.",errMsgCSSClass:"ms-formvalidation",showDupes:false,completefunc:null},ag);var aa=H().SPServices.SPGetQueryString();var ae=aa.ID;var ad=H().SPServices.SPListNameFromUrl();var t="<span id='SPRequireUnique"+i.columnStaticName+"' class='{0}'>{1}</span><br/>";var ac=t.replace(/\{0\}/g,i.initMsgCSSClass).replace(/\{1\}/g,i.initMsg);var ab=H().SPServices.SPGetDisplayFromStatic({listName:ad,columnStaticName:i.columnStaticName});var af=H("input[Title='"+ab+"']");H(af).parent().append(ac);H(af).blur(function(){var aj=[];var ak=H(this).attr("value");if(ak.length===0){return false}H().SPServices({operation:"GetListItems",async:false,listName:ad,CAMLQuery:"<Query><Where><IsNotNull><FieldRef Name='"+i.columnStaticName+"'/></IsNotNull></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='ID' /><FieldRef Name='"+i.columnStaticName+"' /></ViewFields>",CAMLRowLimit:0,completefunc:function(an,al){var am=i.ignoreCase?ak.toUpperCase():ak;H(an.responseXML).SPFilterNode("z:row").each(function(){var ao=i.ignoreCase?H(this).attr("ows_"+i.columnStaticName).toUpperCase():H(this).attr("ows_"+i.columnStaticName);if((am===ao)&&(H(this).attr("ows_ID")!==ae)){aj.push([H(this).attr("ows_ID"),H(this).attr("ows_"+i.columnStaticName)])}})}});var ai=i.initMsg;H("span#SPRequireUnique"+i.columnStaticName).html(ai).attr("class",i.initMsgCSSClass);H("input[value='OK']:disabled, input[value='Save']:disabled").removeAttr("disabled");if(aj.length>0){ai=i.errMsg;H("span#SPRequireUnique"+i.columnStaticName).html(ai).attr("class",i.errMsgCSSClass);if(i.duplicateAction===1){H("input[Title='"+i.columnDisplayName+"']").focus();H("input[value='OK'], input[value='Save']").attr("disabled","disabled")}if(i.showDupes){var ah=" "+aj.length+" duplicate item"+(aj.length>1?"s":"")+": ";for(W=0;W<aj.length;W++){ah+="<a href='DispForm.aspx?ID="+aj[W][0]+"&Source="+location.href+"'>"+aj[W][1]+"</a> "}H("span#SPRequireUnique"+i.columnStaticName).append(ah)}}});if(i.completefunc!==null){i.completefunc()}};H.fn.SPServices.SPGetDisplayFromStatic=function(t){var aa=H.extend({},{webURL:"",listName:"",columnStaticName:""},t);var i="";H().SPServices({operation:"GetList",async:false,webURL:aa.webURL,listName:aa.listName,completefunc:function(ac,ab){H(ac.responseXML).find("Field[StaticName='"+aa.columnStaticName+"']").each(function(){i=H(this).attr("DisplayName");return false})}});return i};H.fn.SPServices.SPGetStaticFromDisplay=function(i){var aa=H.extend({},{webURL:"",listName:"",columnDisplayName:""},i);var t="";H().SPServices({operation:"GetList",async:false,webURL:aa.webURL,listName:aa.listName,completefunc:function(ac,ab){H(ac.responseXML).find("Field[DisplayName='"+aa.columnDisplayName+"']").each(function(){t=H(this).attr("StaticName");return false})}});return t};H.fn.SPServices.SPRedirectWithID=function(ag){var i=H.extend({},{redirectUrl:"",qsParamName:"ID"},ag);var ae=H().SPServices.SPListNameFromUrl();var t=H().SPServices.SPGetQueryString();var ab=t.ID;var ac=t.List;var af=t.RootFolder;var ad=t.ContentTypeId;if(typeof t.ID==="undefined"){ab=H().SPServices.SPGetLastItemId({listName:ae});H("form[name='aspnetForm']").each(function(){var ai=(location.href.indexOf("?")>0)?location.href.substring(0,location.href.indexOf("?")):location.href;var aj=(typeof t.Source==="string")?"Source="+t.Source.replace(/\//g,"%2f").replace(/:/g,"%3a"):"";var ah=[];if(typeof ac!=="undefined"){ah.push("List="+ac)}if(typeof af!=="undefined"){ah.push("RootFolder="+af)}if(typeof ad!=="undefined"){ah.push("ContentTypeId="+ad)}var ak=ai+((ah.length>0)?("?"+ah.join("&")+"&"):"?")+"Source="+ai+"?ID="+ab+((aj.length>0)?("%26RealSource="+t.Source):"")+((typeof t.RedirectURL==="string")?("%26RedirectURL="+t.RedirectURL):"");H(this).attr("action",ak)})}else{while(t.ID===ab){ab=H().SPServices.SPGetLastItemId({listName:ae})}var aa=(typeof t.RedirectURL==="string")?t.RedirectURL:i.redirectUrl;location.href=aa+"?"+i.qsParamName+"="+ab+((typeof t.RealSource==="string")?("&Source="+t.RealSource):"")}};H.fn.SPServices.SPSetMultiSelectSizes=function(ag){var i=H.extend({},{multiSelectColumn:"",minWidth:0,maxWidth:0},ag);var ac=H("select[ID$='SelectCandidate'][Title^='"+i.multiSelectColumn+" ']");var ae=ac.closest("span").find("select[ID$='SelectResult'][Title^='"+i.multiSelectColumn+" ']");var ad=j("SPSetMultiSelectSizes",i.multiSelectColumn);ac.clone().appendTo(ac.closest("span")).css({width:"auto",height:0,visibility:"hidden"}).attr({id:ad,length:0});var ab=H("#"+ad);ac.find("option").each(function(){ab.append("<option value='"+H(this).html()+"'>"+H(this).html()+"</option>")});ae.find("option").each(function(){ab.append("<option value='"+H(this).html()+"'>"+H(this).html()+"</option>")});var t=H("#"+ad).width()+5;var af=t;if(i.minWidth>0||i.maxWidth>0){if(t<i.minWidth){t=i.minWidth}if(af<i.minWidth){af=i.minWidth}if(af>i.maxWidth){af=i.maxWidth}}var aa=t;ac.css("width",aa+"px").parent().css("width",af+"px");ae.css("width",aa+"px").parent().css("width",af+"px");H("#"+ad).remove()};H.fn.SPServices.SPScriptAudit=function(aa){var ab=H.extend({},{webURL:"",listName:"",outputId:"",auditForms:true,auditViews:true,auditPages:true,auditPagesListName:"Pages",showHiddenLists:false,showNoScript:false,showSrc:true},aa);var t=[["New","NewForm.aspx",false],["Display","DispForm.aspx",false],["Edit","EditForm.aspx",false]];var ac;H("#"+ab.outputId).append("<table id='SPScriptAudit' width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1><tr><th></th><th>List</th><th>Page Class</th><th>Page Type</th><th>Page</th>"+(ab.showSrc?"<th>Script References</th>":"")+"</tr></table>");H("#SPScriptAudit th").attr("class","ms-vh2-nofilter");if(ab.auditForms||ab.auditViews){H().SPServices({operation:"GetListCollection",webURL:ab.webURL,async:false,completefunc:function(af,ae){H(af.responseXML).find("List").each(function(){ac=H(this);if((ab.listName.length===0)||(ac.attr("Title")===ab.listName)){if((ab.showHiddenLists&&ac.attr("Hidden")==="False")||!ab.showHiddenLists){if(ab.auditForms){H().SPServices({operation:"GetListContentTypes",webURL:ab.webURL,listName:ac.attr("ID"),async:false,completefunc:function(ah,ag){H(ah.responseXML).find("ContentType").each(function(){if(H(this).attr("ID").substring(0,6)!=="0x0120"){var aj=H(this).find("FormUrls");for(W=0;W<t.length;W++){H(aj).find(t[W][0]).each(function(){l(ab,ac,"Form",this.nodeName,((ab.webURL.length>0)?ab.webURL:H().SPServices.SPGetCurrentSite())+h+H(this).text());t[W][2]=true});if(!t[W][2]){var ai=ac.attr("DefaultViewUrl");l(ab,ac,"Form",t[W][0],ai.substring(0,ai.lastIndexOf(h)+1)+t[W][1])}}for(W=0;W<t.length;W++){t[W][2]=false}}})}})}if(ab.auditViews){H().SPServices({operation:"GetViewCollection",webURL:ab.webURL,listName:ac.attr("ID"),async:false,completefunc:function(ah,ag){H(ah.responseXML).find("View").each(function(){l(ab,ac,"View",H(this).attr("DisplayName"),H(this).attr("Url"))})}})}}}})}})}var i=0;var ad=[];if(typeof ab.auditPagesListName==="string"){i=1;ad.push(ab.auditPagesListName)}else{i=ab.auditPagesListName.length;ad=ab.auditPagesListName}if(ab.auditPages){for(W=0;W<i;W++){H().SPServices({operation:"GetList",async:false,webURL:ab.webURL,listName:ad[W],completefunc:function(af,ae){H(af.responseXML).find("List").each(function(){ac=H(this)})}});H().SPServices({operation:"GetListItems",async:false,webURL:ab.webURL,listName:ad[W],CAMLQuery:"<Query><Where><Neq><FieldRef Name='ContentType'/><Value Type='Text'>Folder</Value></Neq></Where></Query>",CAMLViewFields:"<ViewFields><FieldRef Name='Title'/><FieldRef Name='FileRef'/></ViewFields>",CAMLRowLimit:0,completefunc:function(af,ae){H(af.responseXML).SPFilterNode("z:row").each(function(){var ah=H(this).attr("ows_FileRef").split(";#")[1];var ag=(typeof H(this).attr("ows_Title")!=="undefined")?H(this).attr("ows_Title"):"";if(ah.indexOf(".aspx")>0){l(ab,ac,"Page",ag,h+ah)}})}})}}H("#SPScriptAudit tr[class='ms-alternating']:even").removeAttr("class")};function l(t,aa,ah,ad,ab){var ae=0;var ag=0;var ac={};ac.type=[];ac.src=[];ac.script=[];var af=RegExp("<script[\\s\\S]*?/script>","gi");H.ajax({type:"GET",url:ab,dataType:"text",async:false,success:function(am){while(scriptMatch=af.exec(am)){var ai=D(scriptMatch,"language");var an=D(scriptMatch,"type");var ak=D(scriptMatch,"src");if(ak!==null&&ak.length>0&&!I(ak)){ac.type.push((ai!==null&&ai.length>0)?ai:an);ac.src.push(ak);ag++}}if((!t.showNoScript&&(ac.type.length>0))||t.showNoScript){var al=ab.substring(0,ab.lastIndexOf(h)+1);var aj="<tr class=ms-alternating><td class=ms-vb-icon><a href='"+aa.attr("DefaultViewUrl")+"'><IMG border=0 src='"+aa.attr("ImageUrl")+"'width=16 height=16></A></TD><td class=ms-vb2><a href='"+aa.attr("DefaultViewUrl")+"'>"+aa.attr("Title")+((aa.attr("Hidden")==="True")?"(Hidden)":"")+"</td><td class=ms-vb2>"+ah+"</td><td class=ms-vb2>"+ad+"</td><td class=ms-vb2><a href='"+ab+"'>"+z(ab)+"</td>";if(t.showSrc){var i;aj+="<td valign='top'><table width='100%' style='border-collapse: collapse;' border=0 cellSpacing=0 cellPadding=1>";for(ae=0;ae<ac.type.length;ae++){i=(ac.src[ae].substr(0,1)!==h)?al+ac.src[ae]:ac.src[ae];aj+="<tr><td class=ms-vb2 width='30%'>"+ac.type[ae]+"</td>";aj+="<td class=ms-vb2 width='70%'><a href='"+i+"'>"+z(ac.src[ae])+"</td></tr>"}aj+="</table></td>"}H("#SPScriptAudit").append(aj)}}})}function D(aa,t){var i=RegExp(t+"=(\"([^\"]*)\")|('([^']*)')","gi");if(matches=i.exec(aa)){return matches[2]}return null}function I(ab){var aa;var t=["WebResource.axd","_layouts"];for(aa=0;aa<t.length;aa++){if(ab.indexOf(t[aa])>-1){return true}}return false}H.fn.SPServices.SPArrangeChoices=function(ah){var t=H.extend({},{listName:"",columnName:"",perRow:99,randomize:false},ah);var ad=false;var ae=[];var ab;H().SPServices({operation:"GetList",async:false,listName:(t.listName.length>0)?t.listName:H().SPServices.SPListNameFromUrl(),completefunc:function(aj,ai){H(aj.responseXML).find("Fields").each(function(){H(this).find("Field[DisplayName='"+t.columnName+"']").each(function(){ad=(H(this).attr("FillInChoice")==="TRUE")?true:false;return false})})}});var aa=T(t.columnName);var ac=H(aa).find("tr").length;var af=0;var i;var ag;H(aa).find("tr").each(function(){af++;if(ad&&af===(ac-1)){i=H(this).find("td").html()}else{if(ad&&af===ac){ag=H(this).find("td").html()}else{ae.push(H(this).html())}}});ab="<TR>";if(t.randomize){ae.sort(V)}for(W=0;W<ae.length;W++){ab+=ae[W];if((W+1)%t.perRow===0){ab+="</TR><TR>"}}ab+="</TR>";if(ad){ab+="<TR><TD colspan='99'>"+i+ag+"</TD></TR>"}H(aa).find("tr").remove();H(aa).find("table").append(ab)};H.fn.SPServices.SPAutocomplete=function(aa){var ab=H.extend({},{WebURL:"",sourceList:"",sourceColumn:"",columnName:"",CAMLQuery:"",CAMLQueryOptions:"<QueryOptions></QueryOptions>",CAMLRowLimit:0,filterType:"BeginsWith",numChars:0,ignoreCase:false,highlightClass:"",uniqueVals:false,maxHeight:99999,slideDownSpeed:"fast",processingIndicator:"_layouts/images/REFRESH.GIF",debug:false},aa);var ad;var t=H("input[Title='"+ab.columnName+"']");H("input[Title='"+ab.columnName+"']").css("position","");var ae=t.attr("ID");var ac=t.css("color");var af=t.css("width");if(t.html()===null&&ab.debug){E("SPServices.SPAutocomplete","columnName: "+ab.columnName,"Column is not an input control or is not found on page");return}t.closest("span").find("br").remove();t.wrap("<div>");var i=j("SPAutocomplete",ab.columnName);t.after("<div><ul id='"+i+"' style='width:"+af+";display:none;padding:2px;border:1px solid #2A1FAA;background-color:#FFF;position:absolute;z-index:40;margin:0'></div>");H("#"+i).css("width",af);H(t).keyup(function(){var ao=H(this).val();H("#"+i).hide();if(ao.length<ab.numChars){return false}t.css({"background-image":"url("+ab.processingIndicator+")","background-position":"right","background-repeat":"no-repeat"});var an=[];var ag="<Query><OrderBy><FieldRef Name='"+ab.sourceColumn+"'/></OrderBy><Where>";if(ab.CAMLQuery.length>0){ag+="<And>"}ag+="<"+ab.filterType+"><FieldRef Name='"+ab.sourceColumn+"'/><Value Type='Text'>"+ao+"</Value></"+ab.filterType+">";if(ab.CAMLQuery.length>0){ag+=ab.CAMLQuery+"</And>"}ag+="</Where></Query>";H().SPServices({operation:"GetListItems",async:false,webURL:ab.WebURL,listName:ab.sourceList,CAMLQuery:ag,CAMLQueryOptions:ab.CAMLQueryOptions,CAMLViewFields:"<ViewFields><FieldRef Name='"+ab.sourceColumn+"' /></ViewFields>",CAMLRowLimit:ab.CAMLRowLimit,completefunc:function(at,aq){var ar=ab.ignoreCase?ao.toUpperCase():ao;H(at.responseXML).SPFilterNode("z:row").each(function(){var av=H(this).attr("ows_"+ab.sourceColumn);var aw=ab.ignoreCase?H(this).attr("ows_"+ab.sourceColumn).toUpperCase():H(this).attr("ows_"+ab.sourceColumn);switch(ab.filterType){case"Contains":var au=aw.indexOf(ar);if((au>=0)&&(!ab.uniqueVals||(H.inArray(av,an)===-1))){an.push(H(this).attr("ows_"+ab.sourceColumn))}break;default:if(ar===aw.substr(0,ar.length)&&(!ab.uniqueVals||(H.inArray(av,an)===-1))){an.push(H(this).attr("ows_"+ab.sourceColumn))}break}})}});var aj="";for(W=0;W<an.length;W++){if(ab.highlightClass.length>0){var ai=RegExp(ao,ab.ignoreCase?"gi":"g");var al=an[W].match(ai);var ak=0;for(ad=0;ad<al.length;ad++){var am=an[W].indexOf(al[ad],ak);var ah=am+al[ad].length;var ap="<span class='"+ab.highlightClass+"'>"+al[ad]+"</span>";an[W]=an[W].substr(0,am)+ap+an[W].substr(ah);ak=am+ap.length}}aj+="<li style='display: block;position: relative;cursor: pointer;'>"+an[W]+"</li>"}H("#"+i).html(aj);H("#"+i+" li").click(function(){H("#"+i).fadeOut(ab.slideUpSpeed);H("#"+ae).val(H(this).text())}).mouseover(function(){var aq={cursor:"hand",color:"#ffffff",background:"#3399ff"};H(this).css(aq)}).mouseout(function(){var aq={cursor:"inherit",color:ac,background:"transparent"};H(this).css(aq)});if(an.length>0){H("#"+i).slideDown(ab.slideDownSpeed)}t.css("background-image","")})};H.fn.SPServices.SPGetQueryString=function(){var ac;var ae={};var t=location.search.substring(1,location.search.length);var aa=t.split("&");for(ac=0;ac<aa.length;ac++){var ab=/^([^=]+)=(.*)/i,ad=ab.exec(aa[ac]);if(ab.test(location.href)){if(ad!==null&&ad.length>2){ae[ad[1]]=unescape(ad[2]).replace("+"," ")}}}return ae};H.fn.SPServices.SPListNameFromUrl=function(){if(s.length>0){return s}var t=location.href;var i=t.substring(0,t.indexOf(".aspx"));var aa=unescape(i.substring(0,i.lastIndexOf(h)+1)).toUpperCase();H().SPServices({operation:"GetListCollection",async:false,completefunc:function(ac,ab){H(ac.responseXML).find("List").each(function(){var ad=H(this).attr("DefaultViewUrl");var ae=ad.substring(0,ad.lastIndexOf(h)+1).toUpperCase();if(aa.indexOf(ae)>0){s=H(this).attr("ID");return false}})}});return s};H.fn.SPServices.SPUpdateMultipleListItems=function(ab){var ad=H.extend({},{webURL:"",listName:"",CAMLQuery:"",batchCmd:"Update",valuepairs:[],completefunc:null,debug:false},ab);var ac;var af=[];var ae=[];H().SPServices({operation:"GetListItems",async:false,webURL:ad.webURL,listName:ad.listName,CAMLQuery:ad.CAMLQuery,CAMLQueryOptions:"<QueryOptions><ViewAttributes Scope='Recursive' /></QueryOptions>",completefunc:function(ag,i){H(ag.responseXML).SPFilterNode("z:row").each(function(){af.push(H(this).attr("ows_ID"));var ah=H(this).attr("ows_FileRef");ah="/"+ah.substring(ah.indexOf(";#")+2);ae.push(ah)})}});var t;var aa="<Batch OnError='Continue'>";for(ac=0;ac<af.length;ac++){aa+="<Method ID='"+ac+"' Cmd='"+ad.batchCmd+"'>";for(t=0;t<ad.valuepairs.length;t++){aa+="<Field Name='"+ad.valuepairs[t][0]+"'>"+w(ad.valuepairs[t][1])+"</Field>"}aa+="<Field Name='ID'>"+af[ac]+"</Field>";if(ae[ac].length>0){aa+="<Field Name='FileRef'>"+ae[ac]+"</Field>"}aa+="</Method>"}aa+="</Batch>";H().SPServices({operation:"UpdateListItems",async:false,webURL:ad.webURL,listName:ad.listName,updates:aa,completefunc:function(ag,i){if(ad.completefunc!==null){ad.completefunc()}}})};H.fn.SPFilterNode=function(i){return this.find("*").filter(function(){return this.nodeName===i})};function y(ai,af,aj,aa){if(typeof aj==="undefined"){return""}var ag;var ah;var ae;var ac;var ab=aa.relatedWebURL.length>0?aa.relatedWebURL:H().SPServices.SPGetCurrentSite();switch(af.attr("Type")){case"Text":ah=aj;break;case"URL":switch(af.attr("Format")){case"Hyperlink":ah="<a href='"+aj.substring(0,aj.search(","))+"'>"+aj.substring(aj.search(",")+1)+"</a>";break;case"Image":ah="<img alt='"+aj.substring(aj.search(",")+1)+"' src='"+aj.substring(0,aj.search(","))+"'/>";break;default:ah=aj;break}break;case"User":ah="<a href='/_layouts/userdisp.aspx?ID="+aj.substring(0,aj.search(";#"))+"&Source="+Y(location.href)+"'>"+aj.substring(aj.search(";#")+2)+"</a>";break;case"Calculated":var ad=aj.split(";#");ah=ad[1];break;case"Number":ac=af.attr("Decimals");ah=ac===undefined?parseFloat(aj).toString():parseFloat(aj).toFixed(ac).toString();break;case"Currency":ac=af.attr("Decimals");ah=ac===undefined?parseFloat(aj).toFixed(2).toString():parseFloat(aj).toFixed(ac).toString();break;case"Lookup":switch(af.attr("Name")){case"FileRef":ae=ai.attr("BaseType")==="1"?ai.attr("RootFolder")+h+"Forms/DispForm.aspx":ai.attr("RootFolder")+h+"DispForm.aspx";ah="<a href='"+ae+"?ID="+aj.substring(0,aj.search(";#"))+"&RootFolder=*&Source="+Y(location.href)+"'>"+aj.substring(aj.search(";#")+2)+"</a>";break;case"FileDirRef":ae=h+aj.substring(aj.search(";#")+2);ah="<a href='"+ae+"'>"+aj.substring(aj.search(";#")+2)+"</a>";break;default:ae=p(af.attr("List"),"DisplayForm");ah="<a href='"+aa.relatedWebURL+h+ae+"?ID="+aj.substring(0,aj.search(";#"))+"&RootFolder=*&Source="+Y(location.href)+"'>"+aj.substring(aj.search(";#")+2)+"</a>";break}break;case"LookupMulti":ae=p(af.attr("List"),"DisplayForm");ah="";if(aj.length>0){var t=aj.split(";#");for(ag=0;ag<t.length/2;ag++){ah+="<a href='"+ab+h+ae+"?ID="+t[ag*2]+"&RootFolder=*&Source="+Y(location.href)+"'>"+t[(ag*2)+1]+"</a>";if(ag<(t.length/2)-1){ah+=", "}}}break;case"File":z=aj.substring(aj.search(";#")+2);ah="<a href='"+ai.attr("RootFolder")+h+z+"'>"+z+"</a>";break;case"Counter":ah=aj;break;case"DateTime":ah=aj;break;default:ah=aj;break}return ah}function S(ac,ab){var aa;var t="<table class='ms-vb' width='100%'>";for(aa=0;aa<ac.attributes.length;aa++){t+="<tr><td width='10px' style='font-weight:bold;'>"+aa+"</td><td width='100px'>"+ac.attributes.item(aa).nodeName+"</td><td>"+v(ac.attributes.item(aa).nodeValue)+"</td></tr>"}t+="</table>";return t}function R(i){if((this.Obj=H("select[Title='"+i+"']")).html()!==null){this.Type="S"}else{if((this.Obj=H("input[Title='"+i+"']")).html()!==null){this.Type="C"}else{if((this.Obj=H("select[ID$='SelectCandidate'][Title^='"+i+" ']")).html()!==null){this.Type="M"}else{if((this.Obj=H("select[ID$='SelectCandidate'][Title$=': "+i+"']")).html()!==null){this.Type="M"}else{if((this.Obj=H("select[ID$='SelectCandidate'][Title$='\""+i+"\".']")).html()!==null){this.Type="M"}else{this.Type=null}}}}}}function E(t,ab,aa){var i="<b>Error in function</b><br/>"+t+"<br/><b>Parameter</b><br/>"+ab+"<br/><b>Message</b><br/>"+aa+"<br/><br/><span onmouseover='this.style.cursor=\"hand\";' onmouseout='this.style.cursor=\"inherit\";' style='width=100%;text-align:right;'>Click to continue</span></div>";f(i)}function f(ad){var aa="position:absolute;width:300px;height:150px;padding:10px;background-color:#000000;color:#ffffff;z-index:30;font-family:'Arial';font-size:12px;display:none;";H("#aspnetForm").parent().append("<div id='SPServices_msgBox' style="+aa+">"+ad);var i=H("#SPServices_msgBox").height();var ac=H("#SPServices_msgBox").width();var ab=(H(window).width()/2)-(ac/2)+"px";var t=(H(window).height()/2)-(i/2)-100+"px";H("#SPServices_msgBox").css({border:"5px #C02000 solid",left:ab,top:t}).show().fadeTo("slow",0.75).click(function(){H(this).fadeOut("3000",function(){H(this).remove()})})}function j(i,t){return i+"_"+H().SPServices.SPGetStaticFromDisplay({listName:H().SPServices.SPListNameFromUrl(),columnDisplayName:t})}function p(i,aa){var t;H().SPServices({operation:"GetFormCollection",async:false,listName:i,completefunc:function(ac,ab){H(ac.responseXML).find("Form").each(function(){if(H(this).attr("Type")===aa){t=H(this).attr("Url");return false}})}});return t}function g(ab,t){var aa;for(aa=0;aa<t.length;aa++){if(typeof t[aa]==="string"){F.payload+=A(t[aa],ab[t[aa]])}else{if(t[aa].length===2){F.payload+=A(t[aa][0],ab[t[aa][1]])}else{E(ab.operation,"paramArray["+aa+"]: "+t[aa],"Invalid paramArray element passed to addToPayload()")}}}}function T(i){var aa;var t=RegExp('FieldName="'+i.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")+'"',"gi");H("td.ms-formbody, td.ms-formbodysurvey").each(function(){if(t.test(H(this).html())){aa=H(this);return false}});return aa}function A(t,i){return"<"+t+">"+i+"</"+t+">"}function V(){return(Math.round(Math.random())-0.5)}function v(i){return((i.indexOf("http")===0)||(i.indexOf(h)===0))?"<a href='"+i+"'>"+i+"</a>":i}function z(i){return i.substring(i.lastIndexOf(h)+1,i.length)}function a(i){return i.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function w(i){if(typeof i=="string"){return i.replace(/&(?![a-zA-Z]{1,8};)/g,"&amp;")}else{return i}}function Y(i){return i.replace(/&/g,"%26")}})(jQuery);
